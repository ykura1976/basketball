<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ã°Å¸Ââ‚¬ Ã£Æ’ÂÃ£â€šÂ¹Ã£â€šÂ±Ã¨Â¨ËœÃ©Å’Â²</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            padding-bottom: 80px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 20px;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .sync-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.9);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
            z-index: 1000;
            display: none;
        }

        .sync-indicator.syncing {
            display: block;
            color: #667eea;
        }

        .sync-indicator.success {
            display: block;
            color: #2ecc71;
        }

        .sync-indicator.error {
            display: block;
            color: #ff4757;
        }

        .mode-switch {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }

        .mode-btn {
            flex: 1;
            padding: 15px;
            border: 2px solid white;
            border-radius: 12px;
            background: rgba(255,255,255,0.2);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .mode-btn.active {
            background: white;
            color: #667eea;
        }

        .mode-btn.active.team-mode {
            color: #f39c12;
        }

        .mode-btn.active.team-mode {
            color: #f39c12;
        }

        /* Ã¥â‚¬â€¹Ã¤ÂºÂºÃ£Æ’Â¢Ã£Æ’Â¼Ã£Æ’â€°Ã£ÂÂ®Ã¦â„¢â€šÃ£ÂÂ®Ã¥â€¦Â¨Ã¤Â½â€œÃ¨Æ’Å’Ã¦â„¢Â¯ */
        body.personal-mode {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        /* Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£Æ’Â¢Ã£Æ’Â¼Ã£Æ’â€°Ã£ÂÂ®Ã¦â„¢â€šÃ£ÂÂ®Ã¥â€¦Â¨Ã¤Â½â€œÃ¨Æ’Å’Ã¦â„¢Â¯ */
        body.team-mode {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
        }
        
        .tab-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
        }

        .tab {
            flex: 1;
            min-width: 80px;
            padding: 15px;
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.85em;
        }

        .tab.active {
            background: white;
            color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
            font-size: 0.95em;
        }

        .stepper {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .stepper button {
            width: 45px;
            height: 45px;
            border: none;
            border-radius: 10px;
            background: #667eea;
            color: white;
            font-size: 22px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .stepper button:active {
            transform: scale(0.95);
        }

        .stepper .value {
            flex: 1;
            text-align: center;
            font-size: 26px;
            font-weight: bold;
            color: #667eea;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin: 20px 0;
        }

        .stats-display {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            padding: 12px;
            color: white;
            text-align: center;
        }

        .stats-display h3 {
            font-size: 0.85em;
            margin-bottom: 5px;
        }

        .stats-display .percentage {
            font-size: 1.8em;
            font-weight: bold;
        }

        .stats-display .fraction {
            font-size: 0.9em;
            opacity: 0.85;
            margin-top: 5px;
            font-weight: normal;
        }

        .save-btn, .primary-btn {
            width: 100%;
            padding: 18px;
            border: none;
            border-radius: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .save-btn:active, .primary-btn:active {
            transform: scale(0.98);
        }

        .save-btn:disabled, .primary-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .game-item {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            position: relative;
        }

        .game-date {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 12px;
            font-size: 1.1em;
        }

        .game-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .stat-box {
            text-align: center;
            padding: 8px;
            background: #f7f7f7;
            border-radius: 8px;
        }

        .stat-box .label {
            font-size: 0.7em;
            color: #666;
            margin-bottom: 4px;
        }

        .stat-box .value {
            font-size: 1.1em;
            font-weight: bold;
            color: #667eea;
        }

        .stat-box .fraction {
            font-size: 0.75em;
            color: #999;
            margin-top: 2px;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #999;
        }

        .empty-state .icon {
            font-size: 4em;
            margin-bottom: 15px;
        }

        input[type="date"], input[type="number"], input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
        }

        .saved-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #2ecc71;
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            opacity: 0;
            transition: opacity 0.3s;
            font-weight: bold;
            z-index: 1000;
        }

        .saved-indicator.show {
            opacity: 1;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 1.1em;
            font-weight: bold;
            margin: 25px 0 15px 0;
            color: #333;
            border-left: 4px solid #667eea;
            padding-left: 10px;
        }

        .section-title:first-of-type {
            margin-top: 0;
        }

        .player-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .player-btn {
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .player-btn.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .player-btn .number {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .player-btn .name {
            font-size: 0.85em;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .action-btn {
            padding: 20px;
            border: none;
            border-radius: 12px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .action-btn.success {
            background: #2ecc71;
            color: white;
        }

        .action-btn.miss {
            background: #e0e0e0;
            color: #666;
        }

        .action-btn.other {
            background: #667eea;
            color: white;
        }

        .action-btn:active {
            transform: scale(0.95);
        }

        .play-history {
            margin-top: 15px;
            max-height: 200px;
            overflow-y: auto;
            background: #f7f7f7;
            border-radius: 10px;
            padding: 10px;
        }

        .play-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            background: white;
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .play-item:last-child {
            margin-bottom: 0;
        }

        .undo-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            background: #ff4757;
            color: white;
            font-size: 0.85em;
            cursor: pointer;
        }

        .period-selector {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .period-btn {
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-weight: bold;
            color: #666;
        }

        .period-btn.selected {
            background: #ffc107;
            color: white;
            border-color: #ffc107;
        }

        .team-code-display {
            background: #f0f0f0;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
        }

        .team-code-display .code {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            letter-spacing: 2px;
            margin: 10px 0;
        }

        .player-item {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .player-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .player-info .number {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
        }

        .my-data-badge {
            background: #2ecc71;
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
        }

        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            background: white;
        }

        .top-record {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            color: white;
            text-align: center;
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .top-record .trophy {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .top-record .value {
            font-size: 3em;
            font-weight: bold;
            margin: 10px 0;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 20px;
            color: #333;
        }

        .close-modal {
            background: #95a5a6;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 10px;
            width: 100%;
            margin-top: 15px;
            font-size: 16px;
            cursor: pointer;
        }
        .ranking-medal {
            font-size: 2em;
            display: inline-block;
            width: 50px;
            text-align: center;
        }

        .ranking-card {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .ranking-info {
            flex: 1;
        }

        .ranking-info .rank {
            font-size: 1.2em;
            font-weight: bold;
            color: #667eea;
            margin-right: 10px;
        }

        .ranking-info .player-name {
            font-size: 1.1em;
            font-weight: bold;
            color: #333;
        }

        .ranking-info .stat-value {
            font-size: 1.3em;
            font-weight: bold;
            color: #667eea;
            margin-left: 10px;
        }

        .game-history-item {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            color: white;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .game-history-item:hover {
            transform: translateY(-2px);
        }

        .game-history-item .game-date {
            font-size: 1em;
            color: #333;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .game-history-item .game-opponent {
            font-size: 1.3em;
            font-weight: bold;
        }

        .game-detail {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-top: 10px;
            margin-bottom: 15px;
        }

        .game-detail.active {
            display: block;
        }

        .ranking-section {
            margin-bottom: 30px;
        }

        .ranking-section h3 {
            font-size: 1.2em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 15px;
            padding-left: 10px;
            border-left: 4px solid #667eea;
        }

        .top3-container {
            margin-bottom: 15px;
        }

        .all-rankings {
            display: none;
            margin-top: 10px;
        }

        .all-rankings.active {
            display: block;
        }

        .toggle-rankings {
            width: 100%;
            padding: 12px;
            border: 2px solid #667eea;
            border-radius: 10px;
            background: white;
            color: #667eea;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s;
        }

        .toggle-rankings:hover {
            background: #667eea;
            color: white;
        }

        .toggle-rankings.active {
            background: #667eea;
            color: white;
        }

        /* Ã£â€šÂ¹Ã£â€šÂ³Ã£â€šÂ¢Ã¥â€¦Â¥Ã¥Å â€ºÃ¦Â¬â€ */
        .score-input-container {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 10px;
            align-items: center;
            margin-bottom: 15px;
        }

        .score-input-box {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .score-input-box label {
            font-size: 0.9em;
            font-weight: bold;
            color: #666;
            margin-bottom: 5px;
        }

        .score-input-box input {
            width: 80px;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1.3em;
            font-weight: bold;
            text-align: center;
            color: #667eea;
        }

        .score-vs {
            font-size: 1.5em;
            font-weight: bold;
            color: #999;
        }

        /* Ã¨Â©Â¦Ã¥ÂË†Ã§ÂµÂÃ¦Å¾Å“Ã¨Â¡Â¨Ã§Â¤Âº */
        .game-result {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            color: white;
            text-align: center;
        }

        .game-result.loss {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        .game-result .result-label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .game-result .result-score {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
        }

        .game-result .result-outcome {
            font-size: 1.3em;
            font-weight: bold;
        }

        .quarter-scores {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .quarter-score-item {
            background: white;
            border-radius: 10px;
            padding: 12px;
            text-align: center;
        }

        .quarter-score-item .quarter-label {
            font-size: 0.85em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .quarter-score-item .quarter-value {
            font-size: 1.1em;
            font-weight: bold;
            color: #333;
        }

        .quarter-score-item .quarter-diff {
            font-size: 0.9em;
            margin-top: 3px;
        }

        .quarter-diff.positive {
            color: #2ecc71;
        }

        .quarter-diff.negative {
            color: #e74c3c;
        }

        /* Ã¨Â©Â¦Ã¥ÂË†Ã§Â·Â¨Ã©â€ºâ€ Ã¦Â©Å¸Ã¨Æ’Â½ */
        .edit-game-btn {
            background: #f39c12;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            margin: 15px 0;
            width: 100%;
            font-size: 1em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .edit-game-btn:hover {
            background: #e67e22;
        }

        .edit-modal-content {
            max-height: 80vh;
            overflow-y: auto;
        }

        .edit-section {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
        }

        .edit-section:last-child {
            border-bottom: none;
        }

        .edit-section h3 {
            color: #667eea;
            font-size: 1.1em;
            margin-bottom: 15px;
        }

        .player-stat-edit {
            background: #f7f7f7;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .player-stat-edit .player-header {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .stat-edit-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .stat-edit-item {
            display: flex;
            flex-direction: column;
        }

        .stat-edit-item label {
            font-size: 0.85em;
            color: #666;
            margin-bottom: 3px;
        }

        .stat-edit-item input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.95em;
        }

        .save-edit-btn {
            background: #2ecc71;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            font-size: 1.1em;
            margin-top: 15px;
        }

        .save-edit-btn:hover {
            background: #27ae60;
        }

        .delete-game-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            font-size: 0.95em;
            margin-top: 10px;
        }

        .delete-game-btn:hover {
            background: #c0392b;
        }

        /* Ã£Æ’Å“Ã£â€šÂ¿Ã£Æ’Â³Ã£Æ’â€¢Ã£â€šÂ£Ã£Æ’Â¼Ã£Æ’â€°Ã£Æ’ÂÃ£Æ’Æ’Ã£â€šÂ¯Ã£â€šÂ¢Ã£Æ’â€¹Ã£Æ’Â¡Ã£Æ’Â¼Ã£â€šÂ·Ã£Æ’Â§Ã£Æ’Â³ */
        @keyframes button-press {
            0% { transform: scale(1); }
            50% { transform: scale(0.95); box-shadow: 0 2px 8px rgba(0,0,0,0.3); }
            100% { transform: scale(1); }
        }

        .action-btn.pressed {
            animation: button-press 0.3s ease;
        }

        /* Ã£Æ’â€¢Ã£â€šÂ£Ã£Æ’Â¼Ã£Æ’â€°Ã£Æ’ÂÃ£Æ’Æ’Ã£â€šÂ¯Ã©â‚¬Å¡Ã§Å¸Â¥ */
        .feedback-notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.85);
            color: white;
            padding: 20px 40px;
            border-radius: 15px;
            font-size: 1.2em;
            font-weight: bold;
            z-index: 10000;
            animation: fade-in-out 1s ease;
            pointer-events: none;
        }

        @keyframes fade-in-out {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
        }

        .feedback-notification.success {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
        }

        .feedback-notification.miss {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
        }

        .feedback-notification.other {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }
        /* Ã§ÂÂ¾Ã¥Å“Â¨Ã©ÂÂ¸Ã¦Å Å¾Ã¤Â¸Â­Ã£ÂÂ®Ã©ÂÂ¸Ã¦â€°â€¹Ã¨Â¡Â¨Ã§Â¤Âº */
        .current-player-banner {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.1em;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .current-player-banner .player-icon {
            font-size: 1.5em;
        }

        .current-player-banner .player-info {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .current-player-banner .player-label {
            font-size: 0.8em;
            opacity: 0.9;
        }

        .current-player-banner .player-name {
            font-size: 1.2em;
        }
         /* ========== Ã©ÂÂ¸Ã¦â€°â€¹Ã©ÂÂ¸Ã¦Å Å¾Ã£Æ’Â¢Ã£Æ’Â¼Ã£Æ’â‚¬Ã£Æ’Â«Ã£ÂÂ®Ã£â€šÂ¹Ã£â€šÂ¿Ã£â€šÂ¤Ã£Æ’Â« ========== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.3s ease-out;
        }
        
        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 25px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .modal-header h2 {
            font-size: 1.3em;
            color: #333;
            margin: 0;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 2em;
            color: #999;
            cursor: pointer;
            padding: 0;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s;
        }
        
        .modal-close:hover {
            background: #f0f0f0;
            color: #333;
        }
        
        .modal-body {
            padding: 25px;
        }
        
        .player-select-dropdown {
            width: 100%;
            padding: 15px;
            font-size: 1.1em;
            border: 2px solid #ddd;
            border-radius: 12px;
            background: white;
            color: #333;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .player-select-dropdown:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .player-select-dropdown option {
            padding: 10px;
            font-size: 1em;
        }
        
        .modal-footer {
            display: flex;
            gap: 10px;
            padding: 20px 25px;
            border-top: 2px solid #f0f0f0;
        }
        
        .modal-btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .cancel-btn {
            background: #f0f0f0;
            color: #666;
        }
        
        .cancel-btn:hover {
            background: #e0e0e0;
        }
        
        .confirm-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .confirm-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .confirm-btn:active {
            transform: translateY(0);
        }
        /* ========== Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¥ÂÂÃ¨Â¡Â¨Ã§Â¤ÂºÃ£ÂÂ®Ã£â€šÂ¹Ã£â€šÂ¿Ã£â€šÂ¤Ã£Æ’Â« ========== */
        .team-names {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 5px;
            margin-bottom: 5px;
            font-size: 0.9em;
        }
        
        .our-team-name {
            color: white;
            font-weight: 600;
            margin-right: 20px;
        }
        
        .vs-label {
            color: white;
            font-size: 0.75em;
            font-weight: normal;
            opacity: 0.8;
            min-width: 30px;
            text-align: center;
            padding: 0 15px;
        }
        
        .opp-team-name {
            color: white;
            font-weight: 600;
            margin-left: 20px;
        }
    </style>
</head>
<body>
    <div class="sync-indicator" id="syncIndicator">Ã¥ÂÅ’Ã¦Å“Å¸Ã¤Â¸Â­...</div>
    
    <div class="container">
        <div class="header">
            <h1>Ã°Å¸Ââ‚¬ Ã£Æ’ÂÃ£â€šÂ¹Ã£â€šÂ±Ã¨Â¨ËœÃ©Å’Â²</h1>
            <p>Ã¦Ë†ÂÃ©â€¢Â·Ã£â€šâ€™Ã¨Â¨ËœÃ©Å’Â²Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£â€šâ€¡Ã£Ââ€ </p>
        </div>

        <div class="mode-switch">
           <button class="mode-btn active" onclick="switchMode('personal')">Ã°Å¸â€˜Â¤ Ã¥â‚¬â€¹Ã¤ÂºÂº</button>
           <button class="mode-btn" onclick="switchMode('team')">Ã¢Å¡Â¡ Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â </button>
           <button class="mode-btn" onclick="switchMode('settings')">Ã¢Å¡â„¢Ã¯Â¸Â Ã¨Â¨Â­Ã¥Â®Å¡</button>
        </div>

        <div id="personalMode">
            <div class="tab-bar">
                <button class="tab active" onclick="switchTab('input')">Ã°Å¸â€œÂ Ã¨Â¨ËœÃ©Å’Â²</button>
                <button class="tab" onclick="switchTab('list')">Ã°Å¸â€œÅ  Ã¥Â±Â¥Ã¦Â­Â´</button>
                <button class="tab" onclick="switchTab('ranking')">Ã°Å¸Ââ€  Ã£Æ’Â©Ã£Æ’Â³Ã£â€šÂ­Ã£Æ’Â³Ã£â€šÂ°</button>
                <button class="tab" onclick="switchTab('graph')">Ã°Å¸â€œË† Ã£â€šÂ°Ã£Æ’Â©Ã£Æ’â€¢</button>
            </div>

            <div id="inputTab" class="tab-content active">
                <div id="inputPlayerBanner" class="current-player-banner" style="display: none;">
                    <span class="player-icon">Ã°Å¸â€˜Â¤</span>
                    <div class="player-info">
                        <span class="player-label">Ã§ÂÂ¾Ã¥Å“Â¨Ã¨Â¡Â¨Ã§Â¤ÂºÃ¤Â¸Â­</span>
                        <span class="player-name" id="inputPlayerName"></span>
                    </div>
                </div>
                <div class="card">
                    <h2 style="margin-bottom: 20px;">Ã¦â€“Â°Ã£Ââ€”Ã£Ââ€Ã¨Â©Â¦Ã¥ÂË†Ã£â€šâ€™Ã¨Â¨ËœÃ©Å’Â²</h2>
                    
                    <div class="input-group">
                        <label>Ã¨Â©Â¦Ã¥ÂË†Ã¦â€”Â¥</label>
                        <input type="date" id="gameDate">
                    </div>

                    <div class="input-group">
                        <label>Ã¥Â¯Â¾Ã¦Ë†Â¦Ã§â€ºÂ¸Ã¦â€°â€¹</label>
                        <input type="text" id="opponent" placeholder="Ã§â€ºÂ¸Ã¦â€°â€¹Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¥ÂÂÃ£â€šâ€™Ã¥â€¦Â¥Ã¥Å â€º">
                    </div>

                    <div class="input-group">
                        <label>Ã£Æ’â€”Ã£Æ’Â¬Ã£â€šÂ¤Ã¦â„¢â€šÃ©â€“â€œÃ¯Â¼Ë†Ã¥Ë†â€ Ã¯Â¼â€°</label>
                        <input type="number" id="playTime" value="0" min="0" max="200">
                    </div>

                    <div class="section-title">Ã°Å¸Ââ‚¬ Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†</div>
                    
                    <div class="input-group">
                        <label>2Ã£Æ’ÂÃ£â€šÂ¤Ã£Æ’Â³Ã£Æ’Ë†Ã¦Ë†ÂÃ¥Å Å¸</label>
                        <div class="stepper">
                            <button onclick="changeValue('twoPointsMade', -1)">Ã¢Ë†â€™</button>
                            <div class="value" id="twoPointsMade">0</div>
                            <button onclick="changeValue('twoPointsMade', 1)">Ã¯Â¼â€¹</button>
                        </div>
                    </div>

                    <div class="input-group">
                        <label>2Ã£Æ’ÂÃ£â€šÂ¤Ã£Æ’Â³Ã£Æ’Ë†Ã¨Â©Â¦Ã¦Å â€¢</label>
                        <div class="stepper">
                            <button onclick="changeValue('twoPointsAttempted', -1)">Ã¢Ë†â€™</button>
                            <div class="value" id="twoPointsAttempted">0</div>
                            <button onclick="changeValue('twoPointsAttempted', 1)">Ã¯Â¼â€¹</button>
                        </div>
                    </div>

                    <div class="input-group">
                        <label>3Ã£Æ’ÂÃ£â€šÂ¤Ã£Æ’Â³Ã£Æ’Ë†Ã¦Ë†ÂÃ¥Å Å¸</label>
                        <div class="stepper">
                            <button onclick="changeValue('threePointsMade', -1)">Ã¢Ë†â€™</button>
                            <div class="value" id="threePointsMade">0</div>
                            <button onclick="changeValue('threePointsMade', 1)">Ã¯Â¼â€¹</button>
                        </div>
                    </div>

                    <div class="input-group">
                        <label>3Ã£Æ’ÂÃ£â€šÂ¤Ã£Æ’Â³Ã£Æ’Ë†Ã¨Â©Â¦Ã¦Å â€¢</label>
                        <div class="stepper">
                            <button onclick="changeValue('threePointsAttempted', -1)">Ã¢Ë†â€™</button>
                            <div class="value" id="threePointsAttempted">0</div>
                            <button onclick="changeValue('threePointsAttempted', 1)">Ã¯Â¼â€¹</button>
                        </div>
                    </div>

                    <div class="input-group">
                        <label>Ã£Æ’â€¢Ã£Æ’ÂªÃ£Æ’Â¼Ã£â€šÂ¹Ã£Æ’Â­Ã£Æ’Â¼Ã¦Ë†ÂÃ¥Å Å¸</label>
                        <div class="stepper">
                            <button onclick="changeValue('freeThrowsMade', -1)">Ã¢Ë†â€™</button>
                            <div class="value" id="freeThrowsMade">0</div>
                            <button onclick="changeValue('freeThrowsMade', 1)">Ã¯Â¼â€¹</button>
                        </div>
                    </div>

                    <div class="input-group">
                        <label>Ã£Æ’â€¢Ã£Æ’ÂªÃ£Æ’Â¼Ã£â€šÂ¹Ã£Æ’Â­Ã£Æ’Â¼Ã¨Â©Â¦Ã¦Å â€¢</label>
                        <div class="stepper">
                            <button onclick="changeValue('freeThrowsAttempted', -1)">Ã¢Ë†â€™</button>
                            <div class="value" id="freeThrowsAttempted">0</div>
                            <button onclick="changeValue('freeThrowsAttempted', 1)">Ã¯Â¼â€¹</button>
                        </div>
                    </div>

                    <div class="stats-grid">
                        <div class="stats-display">
                            <h3>2PÃ¦Ë†ÂÃ¥Å Å¸Ã§Å½â€¡</h3>
                            <div class="percentage" id="twoPointPercentage">0%</div>
                            <div class="fraction" id="twoPointFraction">(0/0)</div>
                        </div>
                        <div class="stats-display">
                            <h3>3PÃ¦Ë†ÂÃ¥Å Å¸Ã§Å½â€¡</h3>
                            <div class="percentage" id="threePointPercentage">0%</div>
                            <div class="fraction" id="threePointFraction">(0/0)</div>
                        </div>
                        <div class="stats-display">
                            <h3>FTÃ¦Ë†ÂÃ¥Å Å¸Ã§Å½â€¡</h3>
                            <div class="percentage" id="freeThrowPercentage">0%</div>
                            <div class="fraction" id="freeThrowFraction">(0/0)</div>
                        </div>
                        <div class="stats-display">
                            <h3>Ã§Â·ÂÃ¥Â¾â€”Ã§â€šÂ¹</h3>
                            <div class="percentage" id="totalPoints">0</div>
                        </div>
                    </div>

                    <div class="section-title">Ã°Å¸Å½Â¯ Ã£Æ’ÂªÃ£Æ’ÂÃ£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°</div>

                    <div class="input-group">
                        <label>Ã£â€šÂªÃ£Æ’â€¢Ã£â€šÂ§Ã£Æ’Â³Ã£â€šÂ¹Ã£Æ’ÂªÃ£Æ’ÂÃ£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°</label>
                        <div class="stepper">
                            <button onclick="changeValue('offensiveRebounds', -1)">Ã¢Ë†â€™</button>
                            <div class="value" id="offensiveRebounds">0</div>
                            <button onclick="changeValue('offensiveRebounds', 1)">Ã¯Â¼â€¹</button>
                        </div>
                    </div>

                    <div class="input-group">
                        <label>Ã£Æ’â€¡Ã£â€šÂ£Ã£Æ’â€¢Ã£â€šÂ§Ã£Æ’Â³Ã£â€šÂ¹Ã£Æ’ÂªÃ£Æ’ÂÃ£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°</label>
                        <div class="stepper">
                            <button onclick="changeValue('defensiveRebounds', -1)">Ã¢Ë†â€™</button>
                            <div class="value" id="defensiveRebounds">0</div>
                            <button onclick="changeValue('defensiveRebounds', 1)">Ã¯Â¼â€¹</button>
                        </div>
                    </div>

                    <div class="section-title">Ã°Å¸â€œÅ  Ã£ÂÂÃ£ÂÂ®Ã¤Â»â€“Ã£ÂÂ®Ã§ÂµÂ±Ã¨Â¨Ë†</div>

                    <div class="input-group">
                        <label>Ã£â€šÂ¢Ã£â€šÂ·Ã£â€šÂ¹Ã£Æ’Ë†</label>
                        <div class="stepper">
                            <button onclick="changeValue('assists', -1)">Ã¢Ë†â€™</button>
                            <div class="value" id="assists">0</div>
                            <button onclick="changeValue('assists', 1)">Ã¯Â¼â€¹</button>
                        </div>
                    </div>

                    <div class="input-group">
                        <label>Ã£â€šÂ¹Ã£Æ’â€ Ã£â€šÂ£Ã£Æ’Â¼Ã£Æ’Â«</label>
                        <div class="stepper">
                            <button onclick="changeValue('steals', -1)">Ã¢Ë†â€™</button>
                            <div class="value" id="steals">0</div>
                            <button onclick="changeValue('steals', 1)">Ã¯Â¼â€¹</button>
                        </div>
                    </div>

                    <div class="input-group">
                        <label>Ã£Æ’â€“Ã£Æ’Â­Ã£Æ’Æ’Ã£â€šÂ¯</label>
                        <div class="stepper">
                            <button onclick="changeValue('blocks', -1)">Ã¢Ë†â€™</button>
                            <div class="value" id="blocks">0</div>
                            <button onclick="changeValue('blocks', 1)">Ã¯Â¼â€¹</button>
                        </div>
                    </div>

                    <div class="input-group">
                        <label>Ã£â€šÂ¿Ã£Æ’Â¼Ã£Æ’Â³Ã£â€šÂªÃ£Æ’Â¼Ã£Æ’ÂÃ£Æ’Â¼</label>
                        <div class="stepper">
                            <button onclick="changeValue('turnovers', -1)">Ã¢Ë†â€™</button>
                            <div class="value" id="turnovers">0</div>
                            <button onclick="changeValue('turnovers', 1)">Ã¯Â¼â€¹</button>
                        </div>
                    </div>

                    <div class="input-group">
                        <label>Ã£Æ’â€¢Ã£â€šÂ¡Ã£â€šÂ¦Ã£Æ’Â«</label>
                        <div class="stepper">
                            <button onclick="changeValue('fouls', -1)">Ã¢Ë†â€™</button>
                            <div class="value" id="fouls">0</div>
                            <button onclick="changeValue('fouls', 1)">Ã¯Â¼â€¹</button>
                        </div>
                    </div>

                    <button class="save-btn" id="saveGameBtn" onclick="savePersonalGame()">Ã¨Â¨ËœÃ©Å’Â²Ã£â€šâ€™Ã¤Â¿ÂÃ¥Â­Ëœ</button>
                </div>
            </div>

            <div id="listTab" class="tab-content">
                <div id="listPlayerBanner" class="current-player-banner" style="display: none;">
                    <span class="player-icon">Ã°Å¸â€˜Â¤</span>
                    <div class="player-info">
                        <span class="player-label">Ã§ÂÂ¾Ã¥Å“Â¨Ã¨Â¡Â¨Ã§Â¤ÂºÃ¤Â¸Â­</span>
                        <span class="player-name" id="listPlayerName"></span>
                    </div>
                </div>
                <div id="gameList"></div>
            </div>

            <div id="rankingTab" class="tab-content">
                <div id="rankingPlayerBanner" class="current-player-banner" style="display: none;">
                    <span class="player-icon">Ã°Å¸â€˜Â¤</span>
                    <div class="player-info">
                        <span class="player-label">Ã§ÂÂ¾Ã¥Å“Â¨Ã¨Â¡Â¨Ã§Â¤ÂºÃ¤Â¸Â­</span>
                        <span class="player-name" id="rankingPlayerName"></span>
                    </div>
                </div>
                <div class="card">
                    <h2 style="margin-bottom: 20px;">Ã°Å¸Ââ€  Ã£Æ’â„¢Ã£â€šÂ¹Ã£Æ’Ë†Ã£Æ’â€˜Ã£Æ’â€¢Ã£â€šÂ©Ã£Æ’Â¼Ã£Æ’Å¾Ã£Æ’Â³Ã£â€šÂ¹</h2>
                    <p style="color: #666; margin-bottom: 15px; font-size: 0.9em;">
                        Ã©ÂÂ¸Ã¦Å Å¾Ã£Ââ€”Ã£ÂÅ¸Ã©ÂÂ¸Ã¦â€°â€¹Ã£ÂÂ®Ã¨â€¡ÂªÃ¥Â·Â±Ã£Æ’â„¢Ã£â€šÂ¹Ã£Æ’Ë†Ã¨Â¨ËœÃ©Å’Â²Ã£ÂÂ§Ã£Ââ„¢
                    </p>
                    <div id="topPoints"></div>
                </div>
            </div>

            <div id="graphTab" class="tab-content">
                <div id="graphPlayerBanner" class="current-player-banner" style="display: none;">
                    <span class="player-icon">Ã°Å¸â€˜Â¤</span>
                    <div class="player-info">
                        <span class="player-label">Ã§ÂÂ¾Ã¥Å“Â¨Ã¨Â¡Â¨Ã§Â¤ÂºÃ¤Â¸Â­</span>
                        <span class="player-name" id="graphPlayerName"></span>
                    </div>
                </div>
                <div class="card">
                    <h2 style="margin-bottom: 20px;">Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã¦Ë†ÂÃ¥Å Å¸Ã§Å½â€¡Ã£ÂÂ®Ã¦Å½Â¨Ã§Â§Â»</h2>
                    <div class="chart-container">
                        <canvas id="shootingChart"></canvas>
                    </div>
                </div>
            </div>

            
        </div>
        <div id="settingsMode" style="display: none;">
                <div class="card">
                    <h2 style="margin-bottom: 20px;">Ã°Å¸â€â€” Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã©â‚¬Â£Ã¦ÂÂº</h2>
                    <div id="teamStatus"></div>
                    
                    <button class="primary-btn" style="margin-bottom: 10px;" onclick="showCreateTeamModal()">
                        Ã°Å¸â€ â€¢ Ã¦â€“Â°Ã£Ââ€”Ã£Ââ€Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£â€šâ€™Ã¤Â½Å“Ã¦Ë†Â
                    </button>
                    
                    <button class="primary-btn" style="background: #3498db;" onclick="showJoinTeamModal()">
                        Ã°Å¸â€˜â€¹ Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£ÂÂ«Ã¥Ââ€šÃ¥Å Â 
                    </button>
                    
                    <div style="margin-top: 15px; padding: 12px; background: #e3f2fd; border-radius: 8px; font-size: 0.9em; color: #1976d2;">
                        Ã°Å¸â€™Â¡ <strong>Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¦Â©Å¸Ã¨Æ’Â½:</strong> Ã¨Â¨ËœÃ©Å’Â²Ã¤Â¿â€š1Ã¤ÂºÂºÃ£ÂÅ’Ã¥â€¦Â¨Ã©ÂÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã¨Â¨ËœÃ©Å’Â²Ã¢â€ â€™Ã¥â€¦Â¨Ã¥â€œÂ¡Ã£ÂÂ®Ã£â€šÂ¹Ã£Æ’Å¾Ã£Æ’â€ºÃ£ÂÂ«Ã¨â€¡ÂªÃ¥â€¹â€¢Ã¥ÂÅ’Ã¦Å“Å¸
                    </div>
                </div>

                <div class="card">
                    <h2 style="margin-bottom: 20px;">Ã°Å¸â€˜Â¤ Ã¥â‚¬â€¹Ã¤ÂºÂºÃ£Æ’Â¢Ã£Æ’Â¼Ã£Æ’â€°Ã¨Â¡Â¨Ã§Â¤ÂºÃ¨Â¨Â­Ã¥Â®Å¡</h2>
                    <div class="input-group">
                        <label>Ã¥â‚¬â€¹Ã¤ÂºÂºÃ£Æ’Â¢Ã£Æ’Â¼Ã£Æ’â€°Ã£ÂÂ§Ã¨Â¡Â¨Ã§Â¤ÂºÃ£Ââ„¢Ã£â€šâ€¹Ã©ÂÂ¸Ã¦â€°â€¹</label>
                        <select id="myPlayerSelect" onchange="changeMyPlayer()">
                            <option value="">Ã©ÂÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã©ÂÂ¸Ã¦Å Å¾Ã£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€</option>
                        </select>
                    </div>
                    <p style="color: #666; font-size: 0.9em; margin-top: 10px;">
                        Ã©ÂÂ¸Ã¦Å Å¾Ã£Ââ€”Ã£ÂÅ¸Ã©ÂÂ¸Ã¦â€°â€¹Ã£ÂÂ®Ã¥â‚¬â€¹Ã¤ÂºÂºÃ¦Ë†ÂÃ§Â¸Â¾Ã£ÂÅ’Ã¥Â±Â¥Ã¦Â­Â´Ã£Æ’Â»Ã£Æ’Â©Ã£Æ’Â³Ã£â€šÂ­Ã£Æ’Â³Ã£â€šÂ°Ã£Æ’Â»Ã£â€šÂ°Ã£Æ’Â©Ã£Æ’â€¢Ã£ÂÂ«Ã¨Â¡Â¨Ã§Â¤ÂºÃ£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¾Ã£Ââ„¢
                    </p>
                </div>

                <div class="card">
                    <h2 style="margin-bottom: 20px;">Ã°Å¸â€˜Â¥ Ã©ÂÂ¸Ã¦â€°â€¹Ã§â„¢Â»Ã©Å’Â²</h2>
                    <div class="input-group">
                        <label>Ã¨Æ’Å’Ã§â€¢ÂªÃ¥ÂÂ·</label>
                        <input type="number" id="playerNumber" placeholder="Ã¤Â¾â€¹: 7" min="0" max="99">
                    </div>
                    <div class="input-group">
                        <label>Ã¥ÂÂÃ¥â€°Â</label>
                        <input type="text" id="playerName" placeholder="Ã¤Â¾â€¹: Ã¥Â±Â±Ã§â€Â° Ã¨Å Â±Ã¥Â­Â">
                    </div>
                    <button class="primary-btn" style="margin-top: 15px;" onclick="addPlayer()">Ã©ÂÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã¨Â¿Â½Ã¥Å Â </button>
                </div>

                <div class="card">
                    <h2 style="margin-bottom: 20px;">Ã§â„¢Â»Ã©Å’Â²Ã¦Â¸Ë†Ã£ÂÂ¿Ã©ÂÂ¸Ã¦â€°â€¹</h2>
                    <div id="playerList"></div>
                </div>

                <div class="card">
                    <h2 style="margin-bottom: 20px;">Ã°Å¸â€œÂ¥ Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã§Â®Â¡Ã§Ââ€ </h2>
                    <button class="primary-btn" style="background: #2ecc71; margin-bottom: 10px;" onclick="exportData()">
                        Ã°Å¸â€™Â¾ Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã£Æ’ÂÃ£Æ’Æ’Ã£â€šÂ¯Ã£â€šÂ¢Ã£Æ’Æ’Ã£Æ’â€”
                    </button>
                    
                    <button class="primary-btn" style="background: #3498db;" onclick="document.getElementById('importFile').click()">
                        Ã°Å¸â€œâ€š Ã£Æ’ÂÃ£Æ’Æ’Ã£â€šÂ¯Ã£â€šÂ¢Ã£Æ’Æ’Ã£Æ’â€”Ã£Ââ€¹Ã£â€šâ€°Ã¥Â¾Â©Ã¥â€¦Æ’
                    </button>
                    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importData(event)">
             <button class="primary-btn" style="background: #3498db; margin-top: 10px;" onclick="confirmClearLocalData()">
    Ã°Å¸â€”â€˜Ã¯Â¸Â Ã£Ââ€œÃ£ÂÂ®Ã£â€šÂ¹Ã£Æ’Å¾Ã£Æ’â€ºÃ£ÂÂ®Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã£â€šÂ¯Ã£Æ’ÂªÃ£â€šÂ¢
</button>

<button class="primary-btn" style="background: #e74c3c; margin-top: 10px;" onclick="confirmResetTeamData()">
    Ã¢Å¡Â Ã¯Â¸Â Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¥â€¦Â¨Ã¤Â½â€œÃ£ÂÂ®Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã£Æ’ÂªÃ£â€šÂ»Ã£Æ’Æ’Ã£Æ’Ë†
</button>
                    
                </div>
            </div>
        <div id="teamMode" style="display: none;">
            <div class="tab-bar">
                <button class="tab active" onclick="switchTeamTab('record')">Ã¢Å¡Â¡ Ã¨Â¨ËœÃ©Å’Â²</button>
                <button class="tab" onclick="switchTeamTab('history')">Ã°Å¸â€œÅ  Ã¥Â±Â¥Ã¦Â­Â´</button>
            </div>
                <button class="tab" onclick="switchTeamTab('ranking')">ğŸ“ˆ Ã£Â©Ã£Æ’Â³Ã£â€šÂ­Ã£Æ’Â³Ã£â€šÂ°</button>

            <div id="teamRecordTab">
            <div class="card">
                <h2 style="margin-bottom: 20px;">Ã¢Å¡Â¡ Ã¨Â©Â¦Ã¥ÂË†Ã¨Â¨ËœÃ©Å’Â²</h2>
                
                <div class="input-group">
                    <label>Ã¨Â©Â¦Ã¥ÂË†Ã¦â€”Â¥</label>
                    <input type="date" id="teamGameDate">
                </div>

                <div class="input-group">
                    <label>Ã¥Â¯Â¾Ã¦Ë†Â¦Ã§â€ºÂ¸Ã¦â€°â€¹</label>
                    <input type="text" id="teamOpponent" placeholder="Ã§â€ºÂ¸Ã¦â€°â€¹Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¥ÂÂÃ£â€šâ€™Ã¥â€¦Â¥Ã¥Å â€º">
                </div>

                <button class="primary-btn" onclick="startTeamGame()">Ã¨Â©Â¦Ã¥ÂË†Ã©â€“â€¹Ã¥Â§â€¹</button>
            </div>

            <div id="teamRecording" style="display: none;">
                <div class="card">
                    <h2 style="margin-bottom: 15px;">Ã£Æ’â€Ã£Æ’ÂªÃ£â€šÂªÃ£Æ’â€°Ã£â€šâ€™Ã©ÂÂ¸Ã¦Å Å¾</h2>
                    <div class="period-selector">
                        <div class="period-btn selected" onclick="selectPeriod(1)" id="period1">1Q</div>
                        <div class="period-btn" onclick="selectPeriod(2)" id="period2">2Q</div>
                        <div class="period-btn" onclick="selectPeriod(3)" id="period3">3Q</div>
                        <div class="period-btn" onclick="selectPeriod(4)" id="period4">4Q</div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h3 style="font-size: 1em; color: #666; margin-bottom: 10px;">Ã£Ââ€œÃ£ÂÂ®Ã£â€šÂ¯Ã£â€šÂ©Ã£Æ’Â¼Ã£â€šÂ¿Ã£Æ’Â¼Ã£ÂÂ®Ã¥Â¾â€”Ã§â€šÂ¹</h3>
                        <div class="score-input-container">
                            <div class="score-input-box">
                                <label>Ã¨â€¡ÂªÃ£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â </label>
                                <input type="number" id="ourScoreInput" min="0" max="99" value="0" onchange="updateQuarterScore(currentPeriod, 'our')">
                            </div>
                            <div class="score-vs">-</div>
                            <div class="score-input-box">
                                <label>Ã§â€ºÂ¸Ã¦â€°â€¹</label>
                                <input type="number" id="oppScoreInput" min="0" max="99" value="0" onchange="updateQuarterScore(currentPeriod, 'opp')">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2 style="margin-bottom: 15px;">Ã©ÂÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã©ÂÂ¸Ã¦Å Å¾</h2>
                    <div id="playerSelector" class="player-grid"></div>
                </div>

                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h2 style="margin: 0;">Ã£Æ’â€”Ã£Æ’Â¬Ã£â€šÂ¤Ã£â€šâ€™Ã¨Â¨ËœÃ©Å’Â²</h2>
                        <button class="primary-btn" style="background: #3498db; padding: 8px 16px; font-size: 0.9em;" onclick="openGlossary()">
                            Ã¢Ââ€œ Ã§â€Â¨Ã¨ÂªÅ¾Ã¨Â§Â£Ã¨ÂªÂ¬
                        </button>
                    </div>
                    <div class="action-buttons">
                        <button class="action-btn success" onclick="recordPlay('2p-made')">2PÃ¦Ë†ÂÃ¥Å Å¸</button>
                        <button class="action-btn miss" onclick="recordPlay('2p-miss')">2PÃ¥Â¤Â±Ã¦â€¢â€”</button>
                        <button class="action-btn success" onclick="recordPlay('3p-made')">3PÃ¦Ë†ÂÃ¥Å Å¸</button>
                        <button class="action-btn miss" onclick="recordPlay('3p-miss')">3PÃ¥Â¤Â±Ã¦â€¢â€”</button>
                        <button class="action-btn success" onclick="recordPlay('ft-made')">FTÃ¦Ë†ÂÃ¥Å Å¸</button>
                        <button class="action-btn miss" onclick="recordPlay('ft-miss')">FTÃ¥Â¤Â±Ã¦â€¢â€”</button>
                        <button class="action-btn other" onclick="recordPlay('oreb')">Ã£â€šÂªÃ£Æ’â€¢Ã£â€šÂ§Ã£Æ’Â³Ã£â€šÂ¹Ã£Æ’ÂªÃ£Æ’ÂÃ£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°</button>
                        <button class="action-btn other" onclick="recordPlay('dreb')">Ã£Æ’â€¡Ã£â€šÂ£Ã£Æ’â€¢Ã£â€šÂ§Ã£Æ’Â³Ã£â€šÂ¹Ã£Æ’ÂªÃ£Æ’ÂÃ£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°</button>
                        <button class="action-btn other" onclick="recordPlay('ast')">Ã£â€šÂ¢Ã£â€šÂ·Ã£â€šÂ¹Ã£Æ’Ë†</button>
                        <button class="action-btn other" onclick="recordPlay('stl')">Ã£â€šÂ¹Ã£Æ’â€ Ã£â€šÂ£Ã£Æ’Â¼Ã£Æ’Â«</button>
                        <button class="action-btn other" onclick="recordPlay('blk')">Ã£Æ’â€“Ã£Æ’Â­Ã£Æ’Æ’Ã£â€šÂ¯</button>
                        <button class="action-btn other" onclick="recordPlay('to')">Ã£â€šÂ¿Ã£Æ’Â¼Ã£Æ’Â³Ã£â€šÂªÃ£Æ’Â¼Ã£Æ’ÂÃ£Æ’Â¼</button>
                        <button class="action-btn other" onclick="recordPlay('foul')">Ã£Æ’â€¢Ã£â€šÂ¡Ã£â€šÂ¦Ã£Æ’Â«</button>
                    </div>

                    <div class="play-history" id="playHistory">
                        <div style="text-align: center; color: #999; font-size: 0.9em;">Ã£Æ’â€”Ã£Æ’Â¬Ã£â€šÂ¤Ã¥Â±Â¥Ã¦Â­Â´Ã£ÂÅ’Ã£Ââ€œÃ£Ââ€œÃ£ÂÂ«Ã¨Â¡Â¨Ã§Â¤ÂºÃ£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¾Ã£Ââ„¢</div>
                    </div>
                </div>

                <div class="card">
                    <h2 style="margin-bottom: 15px;">Ã¨Â©Â¦Ã¥ÂË†Ã§ÂµÂ±Ã¨Â¨Ë†</h2>
                    <div id="teamStats"></div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px;">
                        <button class="primary-btn" style="background: #3498db;" onclick="saveDraftTeamGame()">
                            Ã°Å¸â€™Â¾ Ã©â‚¬â€Ã¤Â¸Â­Ã¤Â¿ÂÃ¥Â­Ëœ
                        </button>
                        <button class="save-btn" onclick="saveTeamGame()">
                            Ã¢Å“â€¦ Ã¨Â©Â¦Ã¥ÂË†Ã§Âµâ€šÃ¤Âºâ€ Ã£Æ’Â»Ã¤Â¿ÂÃ¥Â­Ëœ
                        </button>
                    </div>
                </div>
            </div>
     </div>
     <div id="teamHistoryTab" style="display: none;">
         <div id="teamGamesList"></div>
     </div>           
     <div id="teamRankingTab" style="display: none;">
         <div id="teamRankingsDisplay"></div>
     </div>
        </div>
    </div>

    <div id="createTeamModal" class="modal">
        <div class="modal-content">
            <h2 class="modal-title">Ã°Å¸â€ â€¢ Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£â€šâ€™Ã¤Â½Å“Ã¦Ë†Â</h2>
            <div class="input-group">
                <label>Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¥ÂÂ</label>
                <input type="text" id="newTeamName" placeholder="Ã¤Â¾â€¹: Ã£Ââ€¢Ã£ÂÂÃ£â€šâ€°Ã£Æ’ÂÃ£â€šÂ¹Ã£â€šÂ±Ã©Æ’Â¨">
            </div>
            <button class="primary-btn" onclick="createTeam()">Ã¤Â½Å“Ã¦Ë†Â</button>
            <button class="close-modal" onclick="closeModal('createTeamModal')">Ã£â€šÂ­Ã£Æ’Â£Ã£Æ’Â³Ã£â€šÂ»Ã£Æ’Â«</button>
        </div>
    </div>

    <div id="joinTeamModal" class="modal">
        <div class="modal-content">
            <h2 class="modal-title">Ã°Å¸â€˜â€¹ Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£ÂÂ«Ã¥Ââ€šÃ¥Å Â </h2>
            <div class="input-group">
                <label>Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£â€šÂ³Ã£Æ’Â¼Ã£Æ’â€°</label>
                <input type="text" id="joinTeamCode" placeholder="6Ã¦Â¡ÂÃ£ÂÂ®Ã£â€šÂ³Ã£Æ’Â¼Ã£Æ’â€°" maxlength="6">
            </div>
            <button class="primary-btn" onclick="joinTeam()">Ã¥Ââ€šÃ¥Å Â </button>
            <button class="close-modal" onclick="closeModal('joinTeamModal')">Ã£â€šÂ­Ã£Æ’Â£Ã£Æ’Â³Ã£â€šÂ»Ã£Æ’Â«</button>
        </div>
    </div>
Ã£â‚¬â‚¬Ã£â‚¬â‚¬<div id="glossaryModal" class="modal">
        <div class="modal-content" style="max-width: 600px; max-height: 80vh; overflow-y: auto;">
            <h2 class="modal-title">Ã°Å¸â€œÅ¡ Ã£Æ’ÂÃ£â€šÂ¹Ã£â€šÂ±Ã§â€Â¨Ã¨ÂªÅ¾Ã¨Â§Â£Ã¨ÂªÂ¬</h2>
            
            <div style="text-align: left;">
                <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                    <h3 style="color: #2ecc71; margin-top: 0;">Ã¢Å“â€¦ Ã¦Ë†ÂÃ¥Å Å¸Ã£Æ’â€”Ã£Æ’Â¬Ã£â€šÂ¤</h3>
                    
                    <p style="margin: 10px 0;"><strong>2PÃ¦Ë†ÂÃ¥Å Å¸Ã¯Â¼Ë†Ã£Æ’â€Ã£Æ’Â¼Ã£Æ’ÂÃ£â€šÂ¤Ã£Æ’Â³Ã£Æ’Ë†Ã¦Ë†ÂÃ¥Å Å¸Ã¯Â¼â€°</strong><br>
                    2Ã§â€šÂ¹Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã£ÂÅ’Ã¥â€¦Â¥Ã£ÂÂ£Ã£ÂÅ¸Ã£ÂÂ¨Ã£ÂÂÃ£â‚¬â€šÃ£â€šÂ´Ã£Æ’Â¼Ã£Æ’Â«Ã£ÂÂ«Ã¨Â¿â€˜Ã£Ââ€Ã¥Â Â´Ã¦â€°â‚¬Ã£Ââ€¹Ã£â€šâ€°Ã£ÂÂ®Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã£â‚¬â€š</p>
                    
                    <p style="margin: 10px 0;"><strong>3PÃ¦Ë†ÂÃ¥Å Å¸Ã¯Â¼Ë†Ã£â€šÂ¹Ã£Æ’ÂªÃ£Æ’Â¼Ã£Æ’ÂÃ£â€šÂ¤Ã£Æ’Â³Ã£Æ’Ë†Ã¦Ë†ÂÃ¥Å Å¸Ã¯Â¼â€°</strong><br>
                    3Ã§â€šÂ¹Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã£ÂÅ’Ã¥â€¦Â¥Ã£ÂÂ£Ã£ÂÅ¸Ã£ÂÂ¨Ã£ÂÂÃ£â‚¬â€š3Ã§â€šÂ¹Ã£Æ’Â©Ã£â€šÂ¤Ã£Æ’Â³Ã£ÂÂ®Ã¥Â¤â€“Ã¥ÂÂ´Ã£Ââ€¹Ã£â€šâ€°Ã£ÂÂ®Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã£â‚¬â€š</p>
                    
                    <p style="margin: 10px 0;"><strong>FTÃ¦Ë†ÂÃ¥Å Å¸Ã¯Â¼Ë†Ã£Æ’â€¢Ã£Æ’ÂªÃ£Æ’Â¼Ã£â€šÂ¹Ã£Æ’Â­Ã£Æ’Â¼Ã¦Ë†ÂÃ¥Å Å¸Ã¯Â¼â€°</strong><br>
                    Ã£Æ’â€¢Ã£Æ’ÂªÃ£Æ’Â¼Ã£â€šÂ¹Ã£Æ’Â­Ã£Æ’Â¼Ã¯Â¼Ë†1Ã§â€šÂ¹Ã¯Â¼â€°Ã£ÂÅ’Ã¥â€¦Â¥Ã£ÂÂ£Ã£ÂÅ¸Ã£ÂÂ¨Ã£ÂÂÃ£â‚¬â€šÃ£Æ’â€¢Ã£â€šÂ¡Ã£â€šÂ¦Ã£Æ’Â«Ã£Ââ€¢Ã£â€šÅ’Ã£ÂÅ¸Ã¥Â¾Å’Ã£ÂÂ®Ã§â€Â¡Ã¥Â¦Â¨Ã¥Â®Â³Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã£â‚¬â€š</p>
                </div>

                <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                    <h3 style="color: #95a5a6; margin-top: 0;">Ã¢ÂÅ’ Ã¥Â¤Â±Ã¦â€¢â€”Ã£Æ’â€”Ã£Æ’Â¬Ã£â€šÂ¤</h3>
                    
                    <p style="margin: 10px 0;"><strong>2PÃ¥Â¤Â±Ã¦â€¢â€”</strong><br>
                    2Ã§â€šÂ¹Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã£ÂÅ’Ã¥Â¤â€“Ã£â€šÅ’Ã£ÂÅ¸Ã£ÂÂ¨Ã£ÂÂÃ£â‚¬â€š</p>
                    
                    <p style="margin: 10px 0;"><strong>3PÃ¥Â¤Â±Ã¦â€¢â€”</strong><br>
                    3Ã§â€šÂ¹Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã£ÂÅ’Ã¥Â¤â€“Ã£â€šÅ’Ã£ÂÅ¸Ã£ÂÂ¨Ã£ÂÂÃ£â‚¬â€š</p>
                    
                    <p style="margin: 10px 0;"><strong>FTÃ¥Â¤Â±Ã¦â€¢â€”</strong><br>
                    Ã£Æ’â€¢Ã£Æ’ÂªÃ£Æ’Â¼Ã£â€šÂ¹Ã£Æ’Â­Ã£Æ’Â¼Ã£ÂÅ’Ã¥Â¤â€“Ã£â€šÅ’Ã£ÂÅ¸Ã£ÂÂ¨Ã£ÂÂÃ£â‚¬â€š</p>
                </div>

                <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                    <h3 style="color: #3498db; margin-top: 0;">Ã°Å¸â€œÅ  Ã£ÂÂÃ£ÂÂ®Ã¤Â»â€“Ã£ÂÂ®Ã¨Â¨ËœÃ©Å’Â²</h3>
                    
                    <p style="margin: 10px 0;"><strong>Ã£â€šÂªÃ£Æ’â€¢Ã£â€šÂ§Ã£Æ’Â³Ã£â€šÂ¹Ã£Æ’ÂªÃ£Æ’ÂÃ£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°Ã¯Â¼Ë†Ã¦â€Â»Ã¦â€™Æ’Ã£Æ’ÂªÃ£Æ’ÂÃ£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°Ã¯Â¼â€°</strong><br>
                    Ã¥â€˜Â³Ã¦â€“Â¹Ã£ÂÂ®Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã£ÂÅ’Ã¥Â¤â€“Ã£â€šÅ’Ã£ÂÅ¸Ã¥Â¾Å’Ã£â‚¬ÂÃ¨â€¡ÂªÃ¥Ë†â€ Ã£ÂÂ®Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£ÂÅ’Ã¥â€ ÂÃ£ÂÂ³Ã£Æ’Å“Ã£Æ’Â¼Ã£Æ’Â«Ã£â€šâ€™Ã¥Ââ€“Ã£ÂÂ£Ã£ÂÅ¸Ã£ÂÂ¨Ã£ÂÂÃ£â‚¬â€š</p>
                    
                    <p style="margin: 10px 0;"><strong>Ã£Æ’â€¡Ã£â€šÂ£Ã£Æ’â€¢Ã£â€šÂ§Ã£Æ’Â³Ã£â€šÂ¹Ã£Æ’ÂªÃ£Æ’ÂÃ£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°Ã¯Â¼Ë†Ã¥Â®Ë†Ã¥â€šâ„¢Ã£Æ’ÂªÃ£Æ’ÂÃ£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°Ã¯Â¼â€°</strong><br>
                    Ã§â€ºÂ¸Ã¦â€°â€¹Ã£ÂÂ®Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã£ÂÅ’Ã¥Â¤â€“Ã£â€šÅ’Ã£ÂÅ¸Ã¥Â¾Å’Ã£â‚¬ÂÃ£Æ’Å“Ã£Æ’Â¼Ã£Æ’Â«Ã£â€šâ€™Ã¥Ââ€“Ã£ÂÂ£Ã£ÂÅ¸Ã£ÂÂ¨Ã£ÂÂÃ£â‚¬â€š</p>
                    
                    <p style="margin: 10px 0;"><strong>Ã£â€šÂ¢Ã£â€šÂ·Ã£â€šÂ¹Ã£Æ’Ë†</strong><br>
                    Ã£Æ’â€˜Ã£â€šÂ¹Ã£â€šâ€™Ã¥â€¡ÂºÃ£Ââ€”Ã£ÂÂ¦Ã£â‚¬ÂÃ£ÂÂÃ£ÂÂ®Ã£Æ’â€˜Ã£â€šÂ¹Ã£â€šâ€™Ã¥Ââ€”Ã£Ââ€˜Ã£ÂÅ¸Ã¥â€˜Â³Ã¦â€“Â¹Ã£ÂÅ’Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã£â€šâ€™Ã¦Â±ÂºÃ£â€šÂÃ£ÂÅ¸Ã£ÂÂ¨Ã£ÂÂÃ£â‚¬â€š</p>
                    
                    <p style="margin: 10px 0;"><strong>Ã£â€šÂ¹Ã£Æ’â€ Ã£â€šÂ£Ã£Æ’Â¼Ã£Æ’Â«</strong><br>
                    Ã§â€ºÂ¸Ã¦â€°â€¹Ã£Ââ€¹Ã£â€šâ€°Ã£Æ’Å“Ã£Æ’Â¼Ã£Æ’Â«Ã£â€šâ€™Ã¥Â¥ÂªÃ£ÂÂ£Ã£ÂÅ¸Ã£ÂÂ¨Ã£ÂÂÃ£â‚¬â€š</p>
                    
                    <p style="margin: 10px 0;"><strong>Ã£Æ’â€“Ã£Æ’Â­Ã£Æ’Æ’Ã£â€šÂ¯</strong><br>
                    Ã§â€ºÂ¸Ã¦â€°â€¹Ã£ÂÂ®Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã£â€šâ€™Ã¦â€°â€¹Ã£ÂÂ§Ã©ËœÂ²Ã£Ââ€Ã£ÂÂ Ã£ÂÂ¨Ã£ÂÂÃ£â‚¬â€š</p>
                    
                    <p style="margin: 10px 0;"><strong>Ã£â€šÂ¿Ã£Æ’Â¼Ã£Æ’Â³Ã£â€šÂªÃ£Æ’Â¼Ã£Æ’ÂÃ£Æ’Â¼</strong><br>
                    Ã£Æ’Å“Ã£Æ’Â¼Ã£Æ’Â«Ã£â€šâ€™Ã¥Â¤Â±Ã£ÂÂ£Ã£ÂÅ¸Ã£ÂÂ¨Ã£ÂÂÃ£â‚¬â€šÃ£Æ’â€˜Ã£â€šÂ¹Ã£Æ’Å¸Ã£â€šÂ¹Ã£â‚¬ÂÃ£Æ’â€°Ã£Æ’ÂªÃ£Æ’â€“Ã£Æ’Â«Ã£Æ’Å¸Ã£â€šÂ¹Ã£â‚¬ÂÃ§â€ºÂ¸Ã¦â€°â€¹Ã£ÂÂ«Ã¥Â¥ÂªÃ£â€šÂÃ£â€šÅ’Ã£ÂÅ¸Ã£ÂÂ¨Ã£ÂÂÃ£ÂÂªÃ£ÂÂ©Ã£â‚¬â€š</p>
                    
                    <p style="margin: 10px 0;"><strong>Ã£Æ’â€¢Ã£â€šÂ¡Ã£â€šÂ¦Ã£Æ’Â«</strong><br>
                    Ã¥ÂÂÃ¥â€°â€¡Ã£â€šâ€™Ã£Ââ€”Ã£ÂÅ¸Ã£ÂÂ¨Ã£ÂÂÃ£â‚¬â€šÃ§â€ºÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã¦Å Â¼Ã£Ââ„¢Ã£â‚¬ÂÃ¥ÂÂ©Ã£ÂÂÃ£â‚¬ÂÃ¤Â¸ÂÃ¦Â­Â£Ã£ÂÂªÃ£Æ’â€“Ã£Æ’Â­Ã£Æ’Æ’Ã£â€šÂ¯Ã£ÂÂªÃ£ÂÂ©Ã£â‚¬â€š</p>
                </div>

                <div style="background: #fff3cd; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                    <h3 style="color: #f39c12; margin-top: 0;">Ã°Å¸â€™Â¡ Ã¨Â¨ËœÃ©Å’Â²Ã£ÂÂ®Ã£â€šÂ³Ã£Æ’â€</h3>
                    <ul style="margin: 10px 0; padding-left: 20px;">
                        <li>Ã¨Â¿Â·Ã£ÂÂ£Ã£ÂÅ¸Ã£â€šâ€°Ã¨Â¨ËœÃ©Å’Â²Ã£Ââ€”Ã£ÂÂªÃ£Ââ€Ã£â€šË†Ã£â€šÅ Ã£â‚¬ÂÃ¨Â¨ËœÃ©Å’Â²Ã£Ââ€”Ã£ÂÅ¸Ã¦â€“Â¹Ã£ÂÅ’Ã£Ââ€Ã£Ââ€</li>
                        <li>Ã©â€“â€œÃ©Ââ€¢Ã£ÂË†Ã£ÂÅ¸Ã£â€šâ€°Ã£â‚¬Å’Ã£Æ’â€”Ã£Æ’Â¬Ã£â€šÂ¤Ã¥Â±Â¥Ã¦Â­Â´Ã£â‚¬ÂÃ£Ââ€¹Ã£â€šâ€°Ã¥â€°Å Ã©â„¢Â¤Ã£ÂÂ§Ã£ÂÂÃ£â€šâ€¹</li>
                        <li>Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã£ÂÂ¯Ã£â‚¬Å’Ã¦Ë†ÂÃ¥Å Å¸Ã£â‚¬ÂÃ£ÂÂ¾Ã£ÂÅ¸Ã£ÂÂ¯Ã£â‚¬Å’Ã¥Â¤Â±Ã¦â€¢â€”Ã£â‚¬ÂÃ£ÂÂ®Ã¤Â¸Â¡Ã¦â€“Â¹Ã£â€šâ€™Ã¥Â¿â€¦Ã£ÂÅ¡Ã¨Â¨ËœÃ©Å’Â²</li>
                        <li>Ã£Æ’ÂªÃ£Æ’ÂÃ£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°Ã£ÂÂ¯Ã¨ÂªÂ°Ã£ÂÅ’Ã¥Ââ€“Ã£ÂÂ£Ã£ÂÅ¸Ã£Ââ€¹Ã£ÂÅ’Ã©â€¡ÂÃ¨Â¦Â</li>
                    </ul>
                </div>
            </div>
            
            <button class="primary-btn" onclick="closeModal('glossaryModal')">Ã©â€“â€°Ã£ÂËœÃ£â€šâ€¹</button>
        </div>
    </div>

    <!-- Ã¨Â©Â¦Ã¥ÂË†Ã§Â·Â¨Ã©â€ºâ€ Ã£Æ’Â¢Ã£Æ’Â¼Ã£Æ’â‚¬Ã£Æ’Â« -->
    <div id="editGameModal" class="modal">
        <div class="modal-content edit-modal-content">
            <h2 class="modal-title">Ã°Å¸â€â€™ Ã¨Â©Â¦Ã¥ÂË†Ã¨Â¨ËœÃ©Å’Â²Ã£â€šâ€™Ã§Â·Â¨Ã©â€ºâ€ </h2>
            
            <div class="edit-section">
                <h3>Ã°Å¸â€œâ€¦ Ã¨Â©Â¦Ã¥ÂË†Ã¦Æ’â€¦Ã¥Â Â±</h3>
                <div class="input-group">
                    <label>Ã¨Â©Â¦Ã¥ÂË†Ã¦â€”Â¥</label>
                    <input type="date" id="editGameDate">
                </div>
                <div class="input-group">
                    <label>Ã¥Â¯Â¾Ã¦Ë†Â¦Ã§â€ºÂ¸Ã¦â€°â€¹</label>
                    <input type="text" id="editOpponent" placeholder="Ã§â€ºÂ¸Ã¦â€°â€¹Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¥ÂÂ">
                </div>
            </div>

            <div class="edit-section">
                <h3>Ã°Å¸Ââ‚¬ Ã¨Â©Â¦Ã¥ÂË†Ã£â€šÂ¹Ã£â€šÂ³Ã£â€šÂ¢</h3>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                    <div class="input-group">
                        <label>Q1 Ã¨â€¡ÂªÃ£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â </label>
                        <input type="number" id="editOurQ1" min="0" max="99" value="0">
                    </div>
                    <div class="input-group">
                        <label>Q1 Ã§â€ºÂ¸Ã¦â€°â€¹</label>
                        <input type="number" id="editOppQ1" min="0" max="99" value="0">
                    </div>
                    <div class="input-group">
                        <label>Q2 Ã¨â€¡ÂªÃ£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â </label>
                        <input type="number" id="editOurQ2" min="0" max="99" value="0">
                    </div>
                    <div class="input-group">
                        <label>Q2 Ã§â€ºÂ¸Ã¦â€°â€¹</label>
                        <input type="number" id="editOppQ2" min="0" max="99" value="0">
                    </div>
                    <div class="input-group">
                        <label>Q3 Ã¨â€¡ÂªÃ£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â </label>
                        <input type="number" id="editOurQ3" min="0" max="99" value="0">
                    </div>
                    <div class="input-group">
                        <label>Q3 Ã§â€ºÂ¸Ã¦â€°â€¹</label>
                        <input type="number" id="editOppQ3" min="0" max="99" value="0">
                    </div>
                    <div class="input-group">
                        <label>Q4 Ã¨â€¡ÂªÃ£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â </label>
                        <input type="number" id="editOurQ4" min="0" max="99" value="0">
                    </div>
                    <div class="input-group">
                        <label>Q4 Ã§â€ºÂ¸Ã¦â€°â€¹</label>
                        <input type="number" id="editOppQ4" min="0" max="99" value="0">
                    </div>
                </div>
            </div>

            <div class="edit-section" id="editPlayersSection">
                <h3>Ã°Å¸â€˜Â¥ Ã©ÂÂ¸Ã¦â€°â€¹Ã§ÂµÂ±Ã¨Â¨Ë†</h3>
                <div id="editPlayersList"></div>
            </div>

            <button class="save-edit-btn" onclick="saveGameEdit()">Ã¢Å“â€¦ Ã¥Â¤â€°Ã¦â€ºÂ´Ã£â€šâ€™Ã¤Â¿ÂÃ¥Â­Ëœ</button>
            <button class="delete-game-btn" onclick="deleteGame()">Ã°Å¸â€”â€˜Ã¯Â¸Â Ã£Ââ€œÃ£ÂÂ®Ã¨Â©Â¦Ã¥ÂË†Ã£â€šâ€™Ã¥â€°Å Ã©â„¢Â¤</button>
            <button class="close-modal" onclick="closeModal('editGameModal')">Ã£â€šÂ­Ã£Æ’Â£Ã£Æ’Â³Ã£â€šÂ»Ã£Æ’Â«</button>
        </div>
    </div>
    
    <div class="saved-indicator" id="savedIndicator">Ã¢Å“â€œ Ã¤Â¿ÂÃ¥Â­ËœÃ£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸</div>

    <script>
        const API_URL = 'https://script.google.com/macros/s/AKfycbwbPUgd-QAVhwBmhyBwiCtS1GDvZks0imrC78ZsJu5dV-d-Zt6reEW0oi1Lkc_MbW_agQ/exec';
        
        let currentMode = 'personal';
        let personalGames = [];
        let teamGames = [];
        let players = [];
        let myPlayerId = null;
        let teamData = null;
        let charts = {};
        
        let stats = {
            twoPointsMade: 0, twoPointsAttempted: 0,
            threePointsMade: 0, threePointsAttempted: 0,
            freeThrowsMade: 0, freeThrowsAttempted: 0,
            offensiveRebounds: 0, defensiveRebounds: 0,
            assists: 0, steals: 0, blocks: 0, turnovers: 0, fouls: 0
        };

        let currentTeamGame = null;
        let draftTeamGame = null;
        let selectedPlayer = null;
        let currentPeriod = 1;

        function showSyncIndicator(status, message) {
            const indicator = document.getElementById('syncIndicator');
            indicator.className = 'sync-indicator ' + status;
            indicator.textContent = message;
            
            if (status === 'success' || status === 'error') {
                setTimeout(function() {
                    indicator.className = 'sync-indicator';
                }, 3000);
            }
        }

        function loadData() {
            try {
                const saved = localStorage.getItem('basketballData');
                if (saved) {
                    const data = JSON.parse(saved);
                    personalGames = data.personalGames || [];
                    teamGames = data.teamGames || [];
                    players = data.players || [];
                    myPlayerId = data.myPlayerId || null;
                    teamData = data.teamData || null;
                    draftTeamGame = data.draftTeamGame || null;
                    // Ã¢â€“Â¼Ã¢â€“Â¼Ã¢â€“Â¼ Ã£Ââ€œÃ£Ââ€œÃ£Ââ€¹Ã£â€šâ€°Ã¨Â¿Â½Ã¥Å Â  Ã¢â€“Â¼Ã¢â€“Â¼Ã¢â€“Â¼
                    // myPlayerIdÃ£ÂÅ’Ã¥Â­ËœÃ¥Å“Â¨Ã£Ââ€”Ã£ÂÂªÃ£Ââ€Ã©ÂÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã¦Å’â€¡Ã£Ââ€”Ã£ÂÂ¦Ã£Ââ€Ã£â€šâ€¹Ã¥Â Â´Ã¥ÂË†Ã£â‚¬ÂÃ¤Â¿Â®Ã¦Â­Â£Ã£Ââ„¢Ã£â€šâ€¹
                    if (myPlayerId && players.length > 0) {
                        const playerExists = players.find(function(p) {
                            return p.id === myPlayerId;
                        });
                
                        if (!playerExists) {
                            console.warn('Ã©ÂÂ¸Ã¦Å Å¾Ã¤Â¸Â­Ã£ÂÂ®Ã©ÂÂ¸Ã¦â€°â€¹Ã£ÂÅ’Ã¨Â¦â€¹Ã£ÂÂ¤Ã£Ââ€¹Ã£â€šÅ Ã£ÂÂ¾Ã£Ââ€ºÃ£â€šâ€œÃ£â‚¬â€šÃ¦Å“â‚¬Ã¥Ë†ÂÃ£ÂÂ®Ã©ÂÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã¨â€¡ÂªÃ¥â€¹â€¢Ã©ÂÂ¸Ã¦Å Å¾Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ„¢Ã£â‚¬â€š');
                            myPlayerId = players[0].id;
                            saveData();
                        }
                    }
                    // Ã¢â€“Â²Ã¢â€“Â²Ã¢â€“Â² Ã£Ââ€œÃ£Ââ€œÃ£ÂÂ¾Ã£ÂÂ§Ã¨Â¿Â½Ã¥Å Â  Ã¢â€“Â²Ã¢â€“Â²Ã¢â€“Â²
                }
            } catch (e) {
                console.error('Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã¨ÂªÂ­Ã£ÂÂ¿Ã¨Â¾Â¼Ã£ÂÂ¿Ã£â€šÂ¨Ã£Æ’Â©Ã£Æ’Â¼:', e);
            }
        }

        function saveData() {
            const data = {
                personalGames: personalGames,
                teamGames: teamGames,
                players: players,
                myPlayerId: myPlayerId,
                teamData: teamData,
                draftTeamGame: draftTeamGame
            };
            localStorage.setItem('basketballData', JSON.stringify(data));
            showSavedIndicator();
        }

        function showSavedIndicator() {
            const indicator = document.getElementById('savedIndicator');
            indicator.classList.add('show');
            setTimeout(function() {
                indicator.classList.remove('show');
            }, 2000);
        }

        
        function startTeamGame() {
            // Ã©â‚¬â€Ã¤Â¸Â­Ã¤Â¿ÂÃ¥Â­ËœÃ£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£ÂÅ’Ã£Ââ€šÃ£â€šâ€¹Ã¥Â Â´Ã¥ÂË†Ã£ÂÂ¯Ã¨Â­Â¦Ã¥â€˜Å 
            if (draftTeamGame) {
                if (!confirm('Ã¢Å¡Â Ã¯Â¸Â Ã¦Å“ÂªÃ¥Â®Å’Ã¤Âºâ€ Ã£ÂÂ®Ã¨Â©Â¦Ã¥ÂË†Ã¨Â¨ËœÃ©Å’Â²Ã£ÂÅ’Ã£Ââ€šÃ£â€šÅ Ã£ÂÂ¾Ã£Ââ„¢\n\nÃ¦â€“Â°Ã£Ââ€”Ã£Ââ€Ã¨Â©Â¦Ã¥ÂË†Ã£â€šâ€™Ã©â€“â€¹Ã¥Â§â€¹Ã£Ââ„¢Ã£â€šâ€¹Ã£ÂÂ¨Ã£â‚¬ÂÃ©â‚¬â€Ã¤Â¸Â­Ã¤Â¿ÂÃ¥Â­ËœÃ£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£ÂÂ¯Ã¤Â¸Å Ã¦â€ºÂ¸Ã£ÂÂÃ£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¾Ã£Ââ„¢Ã£â‚¬â€š\nÃ§Â¶Å¡Ã£Ââ€˜Ã£ÂÂ¾Ã£Ââ„¢Ã£Ââ€¹Ã¯Â¼Å¸')) {
                    return;
                }
            }
            
            if (players.length === 0) { 
                alert('Ã¥â€¦Ë†Ã£ÂÂ«Ã©ÂÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã§â„¢Â»Ã©Å’Â²Ã£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€Ã¯Â¼Ë†Ã¨Â¨Â­Ã¥Â®Å¡Ã£â€šÂ¿Ã£Æ’â€“Ã¯Â¼â€°'); 
                return; 
            }

            const date = document.getElementById('teamGameDate').value;
            if (!date) { 
                alert('Ã¨Â©Â¦Ã¥ÂË†Ã¦â€”Â¥Ã£â€šâ€™Ã©ÂÂ¸Ã¦Å Å¾Ã£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€'); 
                return; 
            }

            currentTeamGame = {
                id: Date.now(),
                date: date,
                opponent: document.getElementById('teamOpponent').value.trim(),
                plays: [],
                playerStats: {},
                scores: {
                    our: { q1: 0, q2: 0, q3: 0, q4: 0 },
                    opp: { q1: 0, q2: 0, q3: 0, q4: 0 }
                }
            };

            players.forEach(function(p) {
                currentTeamGame.playerStats[p.id] = {
                    twoPointsMade: 0, twoPointsAttempted: 0,
                    threePointsMade: 0, threePointsAttempted: 0,
                    freeThrowsMade: 0, freeThrowsAttempted: 0,
                    offensiveRebounds: 0, defensiveRebounds: 0,
                    assists: 0, steals: 0, blocks: 0, turnovers: 0, fouls: 0
                };
            });

            currentPeriod = 1;
            selectPeriod(1);
            document.getElementById('teamRecording').style.display = 'block';
            displayPlayerSelector();
            updateTeamStats();
            displayPlayHistory();
        }

        function displayPlayerSelector() {
            const sel = document.getElementById('playerSelector');
            sel.innerHTML = players.map(function(p) {
                const isSelected = selectedPlayer === p.id;
                return '<div class="player-btn' + (isSelected ? ' selected' : '') + '" onclick="selectPlayer(\'' + p.id + '\')">' +
                    '<div class="number">#' + p.number + '</div>' +
                    '<div class="name">' + p.name + '</div>' +
                    '</div>';
            }).join('');
        }

        function selectPlayer(id) {
            selectedPlayer = id;
            displayPlayerSelector();
        }

        function selectPeriod(period) {
            currentPeriod = period;
            
            // Ã£Æ’â€Ã£Æ’ÂªÃ£â€šÂªÃ£Æ’â€°Ã£Æ’Å“Ã£â€šÂ¿Ã£Æ’Â³Ã£ÂÂ®Ã¨Â¦â€¹Ã£ÂÅ¸Ã§â€ºÂ®Ã£â€šâ€™Ã¦â€ºÂ´Ã¦â€“Â°
            for (let i = 1; i <= 4; i++) {
                const btn = document.getElementById('period' + i);
                if (i === period) {
                    btn.classList.add('selected');
                } else {
                    btn.classList.remove('selected');
                }
            }
            
            // Ã£â€šÂ¹Ã£â€šÂ³Ã£â€šÂ¢Ã¥â€¦Â¥Ã¥Å â€ºÃ¦Â¬â€Ã£ÂÂ®Ã¥â‚¬Â¤Ã£â€šâ€™Ã¦â€ºÂ´Ã¦â€“Â°Ã¯Â¼Ë†IDÃ£ÂÂ¯Ã¥â€ºÂºÃ¥Â®Å¡Ã¯Â¼â€°
            const ourScoreInput = document.querySelector('.score-input-container input[id^="ourScore"]');
            const oppScoreInput = document.querySelector('.score-input-container input[id^="oppScore"]');
            
            if (ourScoreInput && oppScoreInput) {
                // onchangeÃ£â€šÂ¤Ã£Æ’â„¢Ã£Æ’Â³Ã£Æ’Ë†Ã£â€šâ€™Ã¨Â¨Â­Ã¥Â®Å¡Ã£Ââ€”Ã§â€ºÂ´Ã£Ââ€”
                ourScoreInput.onchange = function() { updateQuarterScore(period, 'our'); };
                oppScoreInput.onchange = function() { updateQuarterScore(period, 'opp'); };
                
                // Ã§ÂÂ¾Ã¥Å“Â¨Ã£ÂÂ®Ã£â€šÂ¯Ã£â€šÂ©Ã£Æ’Â¼Ã£â€šÂ¿Ã£Æ’Â¼Ã£ÂÂ®Ã£â€šÂ¹Ã£â€šÂ³Ã£â€šÂ¢Ã£â€šâ€™Ã¨Â¡Â¨Ã§Â¤Âº
                if (currentTeamGame && currentTeamGame.scores) {
                    ourScoreInput.value = currentTeamGame.scores.our['q' + period] || 0;
                    oppScoreInput.value = currentTeamGame.scores.opp['q' + period] || 0;
                }
            }
        }

        function updateQuarterScore(quarter, team) {
            if (!currentTeamGame) return;
            
            const inputId = team === 'our' ? 'ourScoreInput' : 'oppScoreInput';
            const value = parseInt(document.getElementById(inputId).value) || 0;
            
            currentTeamGame.scores[team]['q' + quarter] = value;
        }

        function getPlayLabel(type) {
            const labels = {
                '2p-made': '2PÃ¦Ë†ÂÃ¥Å Å¸', '2p-miss': '2PÃ¥Â¤Â±Ã¦â€¢â€”',
                '3p-made': '3PÃ¦Ë†ÂÃ¥Å Å¸', '3p-miss': '3PÃ¥Â¤Â±Ã¦â€¢â€”',
                'ft-made': 'FTÃ¦Ë†ÂÃ¥Å Å¸', 'ft-miss': 'FTÃ¥Â¤Â±Ã¦â€¢â€”',
                'oreb': 'Ã£â€šÂªÃ£Æ’â€¢Ã£â€šÂ§Ã£Æ’Â³Ã£â€šÂ¹Ã£Æ’ÂªÃ£Æ’ÂÃ£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°', 'dreb': 'Ã£Æ’â€¡Ã£â€šÂ£Ã£Æ’â€¢Ã£â€šÂ§Ã£Æ’Â³Ã£â€šÂ¹Ã£Æ’ÂªÃ£Æ’ÂÃ£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°',
                'ast': 'Ã£â€šÂ¢Ã£â€šÂ·Ã£â€šÂ¹Ã£Æ’Ë†', 'stl': 'Ã£â€šÂ¹Ã£Æ’â€ Ã£â€šÂ£Ã£Æ’Â¼Ã£Æ’Â«', 'blk': 'Ã£Æ’â€“Ã£Æ’Â­Ã£Æ’Æ’Ã£â€šÂ¯',
                'to': 'Ã£â€šÂ¿Ã£Æ’Â¼Ã£Æ’Â³Ã£â€šÂªÃ£Æ’Â¼Ã£Æ’ÂÃ£Æ’Â¼', 'foul': 'Ã£Æ’â€¢Ã£â€šÂ¡Ã£â€šÂ¦Ã£Æ’Â«'
            };
            return labels[type] || type;
        }

        function recordPlay(type) {
            if (!selectedPlayer) { 
                alert('Ã¥â€¦Ë†Ã£ÂÂ«Ã©ÂÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã©ÂÂ¸Ã¦Å Å¾Ã£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€'); 
                return; 
            }

            const st = currentTeamGame.playerStats[selectedPlayer];
            
            // Ã£Æ’â€”Ã£Æ’Â¬Ã£â€šÂ¤Ã£â€šÂ¿Ã£â€šÂ¤Ã£Æ’â€”Ã£Ââ€Ã£ÂÂ¨Ã£ÂÂ®Ã£Æ’Â©Ã£Æ’â„¢Ã£Æ’Â«
            const playLabels = {
                '2p-made': 'Ã¢Å“â€œ 2PÃ¦Ë†ÂÃ¥Å Å¸',
                '2p-miss': 'Ã¢Å“â€” 2PÃ¥Â¤Â±Ã¦â€¢â€”',
                '3p-made': 'Ã¢Å“â€œ 3PÃ¦Ë†ÂÃ¥Å Å¸',
                '3p-miss': 'Ã¢Å“â€” 3PÃ¥Â¤Â±Ã¦â€¢â€”',
                'ft-made': 'Ã¢Å“â€œ FTÃ¦Ë†ÂÃ¥Å Å¸',
                'ft-miss': 'Ã¢Å“â€” FTÃ¥Â¤Â±Ã¦â€¢â€”',
                'oreb': 'Ã°Å¸â€œÂ¦ Ã£â€šÂªÃ£Æ’â€¢Ã£â€šÂ§Ã£Æ’Â³Ã£â€šÂ¹Ã£Æ’ÂªÃ£Æ’ÂÃ£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°',
                'dreb': 'Ã°Å¸â€œÂ¦ Ã£Æ’â€¡Ã£â€šÂ£Ã£Æ’â€¢Ã£â€šÂ§Ã£Æ’Â³Ã£â€šÂ¹Ã£Æ’ÂªÃ£Æ’ÂÃ£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°',
                'ast': 'Ã°Å¸Â¤Â Ã£â€šÂ¢Ã£â€šÂ·Ã£â€šÂ¹Ã£Æ’Ë†',
                'stl': 'Ã°Å¸â€ºÂ¡Ã¯Â¸Â Ã£â€šÂ¹Ã£Æ’â€ Ã£â€šÂ£Ã£Æ’Â¼Ã£Æ’Â«',
                'blk': 'Ã°Å¸Å¡Â« Ã£Æ’â€“Ã£Æ’Â­Ã£Æ’Æ’Ã£â€šÂ¯',
                'to': 'Ã¢Å¡Â Ã¯Â¸Â Ã£â€šÂ¿Ã£Æ’Â¼Ã£Æ’Â³Ã£â€šÂªÃ£Æ’Â¼Ã£Æ’ÂÃ£Æ’Â¼',
                'foul': 'Ã¢Å¡Â Ã¯Â¸Â Ã£Æ’â€¢Ã£â€šÂ¡Ã£â€šÂ¦Ã£Æ’Â«'
            };
            
            if (type === '2p-made') { st.twoPointsMade++; st.twoPointsAttempted++; }
            else if (type === '2p-miss') { st.twoPointsAttempted++; }
            else if (type === '3p-made') { st.threePointsMade++; st.threePointsAttempted++; }
            else if (type === '3p-miss') { st.threePointsAttempted++; }
            else if (type === 'ft-made') { st.freeThrowsMade++; st.freeThrowsAttempted++; }
            else if (type === 'ft-miss') { st.freeThrowsAttempted++; }
            else if (type === 'oreb') { st.offensiveRebounds++; }
            else if (type === 'dreb') { st.defensiveRebounds++; }
            else if (type === 'ast') { st.assists++; }
            else if (type === 'stl') { st.steals++; }
            else if (type === 'blk') { st.blocks++; }
            else if (type === 'to') { st.turnovers++; }
            else if (type === 'foul') { st.fouls++; }

            currentTeamGame.plays.push({
                playerId: selectedPlayer,
                playType: type,
                period: currentPeriod,
                timestamp: Date.now()
            });

            // Ã£Æ’â€¢Ã£â€šÂ£Ã£Æ’Â¼Ã£Æ’â€°Ã£Æ’ÂÃ£Æ’Æ’Ã£â€šÂ¯Ã¨Â¡Â¨Ã§Â¤Âº
            showPlayFeedback(playLabels[type] || 'Ã£Æ’â€”Ã£Æ’Â¬Ã£â€šÂ¤Ã£â€šâ€™Ã¨Â¨ËœÃ©Å’Â²', type);

            updateTeamStats();
            displayPlayHistory();
        }

        function showPlayFeedback(message, type) {
            // Ã¦â€”Â¢Ã¥Â­ËœÃ£ÂÂ®Ã£Æ’â€¢Ã£â€šÂ£Ã£Æ’Â¼Ã£Æ’â€°Ã£Æ’ÂÃ£Æ’Æ’Ã£â€šÂ¯Ã£ÂÅ’Ã£Ââ€šÃ£â€šÅ’Ã£ÂÂ°Ã¥â€°Å Ã©â„¢Â¤
            const existing = document.querySelector('.feedback-notification');
            if (existing) {
                existing.remove();
            }

            // Ã£Æ’â€¢Ã£â€šÂ£Ã£Æ’Â¼Ã£Æ’â€°Ã£Æ’ÂÃ£Æ’Æ’Ã£â€šÂ¯Ã©â‚¬Å¡Ã§Å¸Â¥Ã£â€šâ€™Ã¤Â½Å“Ã¦Ë†Â
            const feedback = document.createElement('div');
            feedback.className = 'feedback-notification';
            
            // Ã£â€šÂ¿Ã£â€šÂ¤Ã£Æ’â€”Ã£ÂÂ«Ã¥Â¿Å“Ã£ÂËœÃ£ÂÂ¦Ã£â€šÂ¯Ã£Æ’Â©Ã£â€šÂ¹Ã£â€šâ€™Ã¨Â¿Â½Ã¥Å Â 
            if (type.includes('made')) {
                feedback.classList.add('success');
            } else if (type.includes('miss')) {
                feedback.classList.add('miss');
            } else {
                feedback.classList.add('other');
            }
            
            feedback.textContent = message;
            document.body.appendChild(feedback);

            // 1Ã§Â§â€™Ã¥Â¾Å’Ã£ÂÂ«Ã¥â€°Å Ã©â„¢Â¤
            setTimeout(function() {
                if (feedback && feedback.parentNode) {
                    feedback.remove();
                }
            }, 1000);

            // Ã£Æ’Å“Ã£â€šÂ¿Ã£Æ’Â³Ã£ÂÂ«Ã£â€šÂ¢Ã£Æ’â€¹Ã£Æ’Â¡Ã£Æ’Â¼Ã£â€šÂ·Ã£Æ’Â§Ã£Æ’Â³Ã£â€šâ€™Ã¨Â¿Â½Ã¥Å Â 
            const buttons = document.querySelectorAll('.action-btn');
            buttons.forEach(function(btn) {
                if (btn.textContent.toLowerCase().includes(type.split('-')[0])) {
                    btn.classList.add('pressed');
                    setTimeout(function() {
                        btn.classList.remove('pressed');
                    }, 300);
                }
            });
        }

        function deletePlay(timestamp) {
            const playIndex = currentTeamGame.plays.findIndex(function(p) {
                return p.timestamp === timestamp;
            });
            if (playIndex === -1) return;
            
            const play = currentTeamGame.plays[playIndex];
            const st = currentTeamGame.playerStats[play.playerId];
            
            if (play.playType === '2p-made') { st.twoPointsMade--; st.twoPointsAttempted--; }
            else if (play.playType === '2p-miss') { st.twoPointsAttempted--; }
            else if (play.playType === '3p-made') { st.threePointsMade--; st.threePointsAttempted--; }
            else if (play.playType === '3p-miss') { st.threePointsAttempted--; }
            else if (play.playType === 'ft-made') { st.freeThrowsMade--; st.freeThrowsAttempted--; }
            else if (play.playType === 'ft-miss') { st.freeThrowsAttempted--; }
            else if (play.playType === 'oreb') { st.offensiveRebounds--; }
            else if (play.playType === 'dreb') { st.defensiveRebounds--; }
            else if (play.playType === 'ast') { st.assists--; }
            else if (play.playType === 'stl') { st.steals--; }
            else if (play.playType === 'blk') { st.blocks--; }
            else if (play.playType === 'to') { st.turnovers--; }
            else if (play.playType === 'foul') { st.fouls--; }
            
            currentTeamGame.plays.splice(playIndex, 1);
            
            updateTeamStats();
            displayPlayHistory();
        }

        function displayPlayHistory() {
    const histEl = document.getElementById('playHistory');
    
    // ========== Ã¨Â¿Â½Ã¥Å Â Ã¯Â¼Å¡Ã¥Â­ËœÃ¥Å“Â¨Ã£Æ’ÂÃ£â€šÂ§Ã£Æ’Æ’Ã£â€šÂ¯ ==========
    if (!currentTeamGame || !currentTeamGame.plays) {
        histEl.innerHTML = '<div style="text-align: center; color: #999; font-size: 0.9em;">Ã£Æ’â€”Ã£Æ’Â¬Ã£â€šÂ¤Ã¥Â±Â¥Ã¦Â­Â´Ã£ÂÅ’Ã£Ââ€œÃ£Ââ€œÃ£ÂÂ«Ã¨Â¡Â¨Ã§Â¤ÂºÃ£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¾Ã£Ââ„¢</div>';
        return;
    }
    // ========================================
    
    if (currentTeamGame.plays.length === 0) {
        histEl.innerHTML = '<div style="text-align: center; color: #999; font-size: 0.9em;">Ã£Æ’â€”Ã£Æ’Â¬Ã£â€šÂ¤Ã¥Â±Â¥Ã¦Â­Â´Ã£ÂÅ’Ã£Ââ€œÃ£Ââ€œÃ£ÂÂ«Ã¨Â¡Â¨Ã§Â¤ÂºÃ£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¾Ã£Ââ„¢</div>';
        return;
    }
    
    const recentPlays = currentTeamGame.plays.slice().reverse().slice(0, 10);
    histEl.innerHTML = '<div style="margin-bottom: 10px; font-size: 0.9em; color: #666; font-weight: bold;">Ã¦Å“â‚¬Ã¦â€“Â°Ã£ÂÂ®Ã£Æ’â€”Ã£Æ’Â¬Ã£â€šÂ¤Ã¯Â¼Ë†Ã¦Å“â‚¬Ã¥Â¤Â§10Ã¤Â»Â¶Ã¯Â¼â€° - Ã£â€šÂ¿Ã£Æ’Æ’Ã£Æ’â€”Ã£ÂÂ§Ã¥â€°Å Ã©â„¢Â¤</div>' +
        recentPlays.map(function(play) {
            const p = players.find(function(pl) {
                return pl.id === play.playerId;
            });
            return '<div class="play-item">' +
                '<div>' +
                '<strong>' + play.period + 'Q | #' + p.number + ' ' + p.name + '</strong>' +
                '<div style="font-size: 0.85em; color: #666; margin-top: 2px;">' + getPlayLabel(play.playType) + '</div>' +
                '</div>' +
                '<button class="undo-btn" onclick="deletePlay(' + play.timestamp + ')">Ã¥â€°Å Ã©â„¢Â¤</button>' +
                '</div>';
        }).join('');
}

        function updateTeamStats() {
            const el = document.getElementById('teamStats');
            let html = '';

            players.forEach(function(p) {
                const st = currentTeamGame.playerStats[p.id];
                const pts = (st.twoPointsMade * 2) + (st.threePointsMade * 3) + st.freeThrowsMade;
                const reb = st.offensiveRebounds + st.defensiveRebounds;

                html += '<div style="padding: 10px; background: #f7f7f7; border-radius: 8px; margin-bottom: 10px;">' +
                    '<div style="font-weight: bold; margin-bottom: 5px;">#' + p.number + ' ' + p.name + '</div>' +
                    '<div style="font-size: 0.9em; color: #666;">' +
                    pts + 'Ã§â€šÂ¹ | ' + reb + 'Ã£Æ’ÂªÃ£Æ’ÂÃ£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€° | ' + st.assists + 'Ã£â€šÂ¢Ã£â€šÂ·Ã£â€šÂ¹Ã£Æ’Ë† | ' + st.steals + 'Ã£â€šÂ¹Ã£Æ’â€ Ã£â€šÂ£Ã£Æ’Â¼Ã£Æ’Â« | ' + st.blocks + 'Ã£Æ’â€“Ã£Æ’Â­Ã£Æ’Æ’Ã£â€šÂ¯' +
                    '</div>' +
                    '</div>';
            });

            el.innerHTML = html;
        }

        function saveTeamGame() {
            if (!currentTeamGame) return;

            teamGames.unshift(currentTeamGame);

            players.forEach(function(player) {
                if (currentTeamGame.playerStats[player.id]) {
                    const st = currentTeamGame.playerStats[player.id];
                    const totalReb = st.offensiveRebounds + st.defensiveRebounds;
                    const totalPts = (st.twoPointsMade * 2) + (st.threePointsMade * 3) + st.freeThrowsMade;

                    const personalGame = {
                        id: Date.now() + Math.random(),
                        date: currentTeamGame.date,
                        opponent: currentTeamGame.opponent,
                        playTime: 0,
                        playerId: player.id,
                        twoPointsMade: st.twoPointsMade,
                        twoPointsAttempted: st.twoPointsAttempted,
                        threePointsMade: st.threePointsMade,
                        threePointsAttempted: st.threePointsAttempted,
                        freeThrowsMade: st.freeThrowsMade,
                        freeThrowsAttempted: st.freeThrowsAttempted,
                        offensiveRebounds: st.offensiveRebounds,
                        defensiveRebounds: st.defensiveRebounds,
                        assists: st.assists,
                        steals: st.steals,
                        blocks: st.blocks,
                        turnovers: st.turnovers,
                        fouls: st.fouls,
                        totalRebounds: totalReb,
                        twoPointPercentage: st.twoPointsAttempted > 0 ? ((st.twoPointsMade / st.twoPointsAttempted) * 100).toFixed(1) : '0',
                        threePointPercentage: st.threePointsAttempted > 0 ? ((st.threePointsMade / st.threePointsAttempted) * 100).toFixed(1) : '0',
                        freeThrowPercentage: st.freeThrowsAttempted > 0 ? ((st.freeThrowsMade / st.freeThrowsAttempted) * 100).toFixed(1) : '0',
                        totalPoints: totalPts,
                        source: 'team',
                        teamGameId: currentTeamGame.id
                    };

                    personalGames.unshift(personalGame);
                }
            });

            saveData();
            
            if (teamData) {
                syncGamesOnly();
            }

            // Ã©â‚¬â€Ã¤Â¸Â­Ã¤Â¿ÂÃ¥Â­ËœÃ£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã¥â€°Å Ã©â„¢Â¤Ã¯Â¼Ë†Ã¨Â©Â¦Ã¥ÂË†Ã¥Â®Å’Ã¤Âºâ€ Ã£Ââ€”Ã£ÂÅ¸Ã£ÂÂ®Ã£ÂÂ§Ã¤Â¸ÂÃ¨Â¦ÂÃ¯Â¼â€°
            clearDraftTeamGame();
            
            // Ã¨Â­Â¦Ã¥â€˜Å Ã£Æ’Å“Ã£Æ’Æ’Ã£â€šÂ¯Ã£â€šÂ¹Ã£â€šâ€šÃ¥â€°Å Ã©â„¢Â¤
            const alertBox = document.getElementById('draftGameAlert');
            if (alertBox) {
                alertBox.remove();
            }
            
            currentTeamGame = null;
            selectedPlayer = null;
            currentPeriod = 1;
            document.getElementById('teamRecording').style.display = 'none';
            document.getElementById('teamGameDate').valueAsDate = new Date();
            document.getElementById('teamOpponent').value = '';
            
            alert('Ã¢Å“â€¦ Ã¨Â©Â¦Ã¥ÂË†Ã¨Â¨ËœÃ©Å’Â²Ã£â€šâ€™Ã¤Â¿ÂÃ¥Â­ËœÃ£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸Ã¯Â¼Â\n\nÃ¥â€¦Â¨Ã©ÂÂ¸Ã¦â€°â€¹Ã£ÂÂ®Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£ÂÅ’Ã¥â‚¬â€¹Ã¤ÂºÂºÃ£Æ’Â¢Ã£Æ’Â¼Ã£Æ’â€°Ã£ÂÂ«Ã¥ÂÂÃ¦ËœÂ Ã£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¾Ã£Ââ„¢Ã£â‚¬â€š');
        }

        // ========== Ã©â‚¬â€Ã¤Â¸Â­Ã¤Â¿ÂÃ¥Â­ËœÃ¦Â©Å¸Ã¨Æ’Â½ ==========
        function saveDraftTeamGame() {
            if (!currentTeamGame) {
                alert('Ã¢ÂÅ’ Ã¨Â¨ËœÃ©Å’Â²Ã¤Â¸Â­Ã£ÂÂ®Ã¨Â©Â¦Ã¥ÂË†Ã£ÂÅ’Ã£Ââ€šÃ£â€šÅ Ã£ÂÂ¾Ã£Ââ€ºÃ£â€šâ€œ');
                return;
            }
            
            // Ã§ÂÂ¾Ã¥Å“Â¨Ã£ÂÂ®Ã¨Â©Â¦Ã¥ÂË†Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã©â‚¬â€Ã¤Â¸Â­Ã¤Â¿ÂÃ¥Â­ËœÃ§â€Â¨Ã£ÂÂ«Ã¤Â¿ÂÃ¥Â­Ëœ
            draftTeamGame = {
                id: currentTeamGame.id,
                date: currentTeamGame.date,
                opponent: currentTeamGame.opponent,
                plays: currentTeamGame.plays.slice(), // Ã£â€šÂ³Ã£Æ’â€Ã£Æ’Â¼Ã£â€šâ€™Ã¤Â½Å“Ã¦Ë†Â
                playerStats: JSON.parse(JSON.stringify(currentTeamGame.playerStats)), // Ã¦Â·Â±Ã£Ââ€Ã£â€šÂ³Ã£Æ’â€Ã£Æ’Â¼
                scores: JSON.parse(JSON.stringify(currentTeamGame.scores)), // Ã£â€šÂ¹Ã£â€šÂ³Ã£â€šÂ¢Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€šÃ¤Â¿ÂÃ¥Â­Ëœ
                currentPeriod: currentPeriod, // Ã§ÂÂ¾Ã¥Å“Â¨Ã£ÂÂ®Ã£Æ’â€Ã£Æ’ÂªÃ£â€šÂªÃ£Æ’â€°Ã£â€šâ€šÃ¤Â¿ÂÃ¥Â­Ëœ
                savedAt: new Date().toISOString() // Ã¤Â¿ÂÃ¥Â­ËœÃ¦â€”Â¥Ã¦â„¢â€š
            };
            
            // Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã¤Â¿ÂÃ¥Â­Ëœ
            saveData();
            
            alert('Ã¢Å“â€¦ Ã©â‚¬â€Ã¤Â¸Â­Ã¤Â¿ÂÃ¥Â­ËœÃ£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸Ã¯Â¼Â\n\nÃ¨Â¨ËœÃ©Å’Â²Ã£â€šâ€™Ã§Â¶Å¡Ã£Ââ€˜Ã£â€šâ€¹Ã£Ââ€¹Ã£â‚¬ÂÃ¥Â¾Å’Ã£Ââ€¹Ã£â€šâ€°Ã£â‚¬Å’Ã§Â¶Å¡Ã£ÂÂÃ£Ââ€¹Ã£â€šâ€°Ã¨Â¨ËœÃ©Å’Â²Ã£â‚¬ÂÃ£ÂÂ§Ã¥â€ ÂÃ©â€“â€¹Ã£ÂÂ§Ã£ÂÂÃ£ÂÂ¾Ã£Ââ„¢Ã£â‚¬â€š');
        }

        // ========== Ã§Â¶Å¡Ã£ÂÂÃ£Ââ€¹Ã£â€šâ€°Ã¨Â¨ËœÃ©Å’Â²Ã¯Â¼Ë†Ã¥â€ ÂÃ©â€“â€¹Ã¯Â¼â€°Ã¦Â©Å¸Ã¨Æ’Â½ ==========
        function resumeDraftGame() {
            if (!draftTeamGame) {
                alert('Ã¢ÂÅ’ Ã©â‚¬â€Ã¤Â¸Â­Ã¤Â¿ÂÃ¥Â­ËœÃ£Ââ€¢Ã£â€šÅ’Ã£ÂÅ¸Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£ÂÅ’Ã£Ââ€šÃ£â€šÅ Ã£ÂÂ¾Ã£Ââ€ºÃ£â€šâ€œ');
                return;
            }
            
            // Ã§Â¢ÂºÃ¨ÂªÂÃ£Æ’Â¡Ã£Æ’Æ’Ã£â€šÂ»Ã£Æ’Â¼Ã£â€šÂ¸
            const dateStr = new Date(draftTeamGame.date).toLocaleDateString('ja-JP', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            if (!confirm('Ã°Å¸â€œâ€¹ Ã¦Å“ÂªÃ¥Â®Å’Ã¤Âºâ€ Ã£ÂÂ®Ã¨Â©Â¦Ã¥ÂË†Ã¨Â¨ËœÃ©Å’Â²Ã£ÂÅ’Ã£Ââ€šÃ£â€šÅ Ã£ÂÂ¾Ã£Ââ„¢\n\n' +
                        'Ã¦â€”Â¥Ã¤Â»Ëœ: ' + dateStr + '\n' +
                        'Ã¥Â¯Â¾Ã¦Ë†Â¦Ã§â€ºÂ¸Ã¦â€°â€¹: ' + (draftTeamGame.opponent || 'Ã¦Å“ÂªÃ¨Â¨Â­Ã¥Â®Å¡') + '\n' +
                        'Ã¤Â¿ÂÃ¥Â­ËœÃ¦â€”Â¥Ã¦â„¢â€š: ' + new Date(draftTeamGame.savedAt).toLocaleString('ja-JP') + '\n\n' +
                        'Ã§Â¶Å¡Ã£ÂÂÃ£Ââ€¹Ã£â€šâ€°Ã¨Â¨ËœÃ©Å’Â²Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ„¢Ã£Ââ€¹Ã¯Â¼Å¸')) {
                return;
            }
            
            // Ã¤Â¿ÂÃ¥Â­ËœÃ£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¦Ã£Ââ€Ã£ÂÅ¸Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã¥Â¾Â©Ã¥â€¦Æ’
            currentTeamGame = {
                id: draftTeamGame.id,
                date: draftTeamGame.date,
                opponent: draftTeamGame.opponent,
                plays: draftTeamGame.plays.slice(),
                playerStats: JSON.parse(JSON.stringify(draftTeamGame.playerStats)),
                scores: draftTeamGame.scores ? JSON.parse(JSON.stringify(draftTeamGame.scores)) : {
                    our: { q1: 0, q2: 0, q3: 0, q4: 0 },
                    opp: { q1: 0, q2: 0, q3: 0, q4: 0 }
                }
            };
            
            // Ã£Æ’â€Ã£Æ’ÂªÃ£â€šÂªÃ£Æ’â€°Ã£â€šâ€šÃ¥Â¾Â©Ã¥â€¦Æ’
            currentPeriod = draftTeamGame.currentPeriod || 1;
            selectPeriod(currentPeriod);
            
            // Ã¦â€”Â¥Ã¤Â»ËœÃ£ÂÂ¨Ã¥Â¯Â¾Ã¦Ë†Â¦Ã§â€ºÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã§â€Â»Ã©ÂÂ¢Ã£ÂÂ«Ã¨Â¡Â¨Ã§Â¤Âº
            document.getElementById('teamGameDate').value = draftTeamGame.date;
            document.getElementById('teamOpponent').value = draftTeamGame.opponent || '';
            
            // Ã¨Â¨ËœÃ©Å’Â²Ã§â€Â»Ã©ÂÂ¢Ã£â€šâ€™Ã¨Â¡Â¨Ã§Â¤Âº
            document.getElementById('teamRecording').style.display = 'block';
            displayPlayerSelector();
            updateTeamStats();
            displayPlayHistory();
            
            alert('Ã¢Å“â€¦ Ã¨Â©Â¦Ã¥ÂË†Ã¨Â¨ËœÃ©Å’Â²Ã£â€šâ€™Ã¥â€ ÂÃ©â€“â€¹Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸Ã¯Â¼Â\n\nÃ¥â€°ÂÃ¥â€ºÅ¾Ã£ÂÂ®Ã§Â¶Å¡Ã£ÂÂÃ£Ââ€¹Ã£â€šâ€°Ã¨Â¨ËœÃ©Å’Â²Ã£ÂÂ§Ã£ÂÂÃ£ÂÂ¾Ã£Ââ„¢Ã£â‚¬â€š');
        }

        // ========== Ã©â‚¬â€Ã¤Â¸Â­Ã¤Â¿ÂÃ¥Â­ËœÃ£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£ÂÂ®Ã¥â€°Å Ã©â„¢Â¤Ã¯Â¼Ë†Ã¨Â©Â¦Ã¥ÂË†Ã¥Â®Å’Ã¤Âºâ€ Ã¦â„¢â€šÃ¯Â¼â€°==========
        function clearDraftTeamGame() {
            draftTeamGame = null;
            saveData();
        }

        // ========== Ã¨ÂµÂ·Ã¥â€¹â€¢Ã¦â„¢â€šÃ£ÂÂ«Ã©â‚¬â€Ã¤Â¸Â­Ã¤Â¿ÂÃ¥Â­ËœÃ£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£ÂÅ’Ã£Ââ€šÃ£â€šâ€¹Ã£Ââ€¹Ã£Æ’ÂÃ£â€šÂ§Ã£Æ’Æ’Ã£â€šÂ¯ ==========
        function checkAndShowDraftGame() {
            // Ã©â‚¬â€Ã¤Â¸Â­Ã¤Â¿ÂÃ¥Â­ËœÃ£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£ÂÅ’Ã£ÂÂªÃ£Ââ€˜Ã£â€šÅ’Ã£ÂÂ°Ã¤Â½â€¢Ã£â€šâ€šÃ£Ââ€”Ã£ÂÂªÃ£Ââ€
            if (!draftTeamGame) {
                return;
            }
            
            // Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¨Â¨ËœÃ©Å’Â²Ã£â€šÂ¿Ã£Æ’â€“Ã£ÂÂ®Ã¤Â¸â‚¬Ã§â€¢ÂªÃ¤Â¸Å Ã£ÂÂ«Ã£â‚¬Å’Ã§Â¶Å¡Ã£ÂÂÃ£Ââ€¹Ã£â€šâ€°Ã¨Â¨ËœÃ©Å’Â²Ã£â‚¬ÂÃ£Æ’Å“Ã£â€šÂ¿Ã£Æ’Â³Ã£â€šâ€™Ã¨Â¡Â¨Ã§Â¤Âº
            const teamRecordTab = document.getElementById('teamRecordTab');
            
            // Ã¦â€”Â¢Ã£ÂÂ«Ã¨Â¡Â¨Ã§Â¤ÂºÃ£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¦Ã£Ââ€Ã£â€šâ€¹Ã£ÂÂªÃ£â€šâ€°Ã¤Â½â€¢Ã£â€šâ€šÃ£Ââ€”Ã£ÂÂªÃ£Ââ€
            if (document.getElementById('draftGameAlert')) {
                return;
            }
            
            // Ã¦â€”Â¥Ã¤Â»ËœÃ£â€šâ€™Ã¨Â¦â€¹Ã£â€šâ€Ã£Ââ„¢Ã£ÂÂÃ¦â€¢Â´Ã¥Â½Â¢
            const dateStr = new Date(draftTeamGame.date).toLocaleDateString('ja-JP', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            // Ã£â€šÂ¢Ã£Æ’Â©Ã£Æ’Â¼Ã£Æ’Ë†Ã£Æ’Å“Ã£Æ’Æ’Ã£â€šÂ¯Ã£â€šÂ¹Ã£â€šâ€™Ã¤Â½Å“Ã¦Ë†Â
            const alertBox = document.createElement('div');
            alertBox.id = 'draftGameAlert';
            alertBox.className = 'card';
            alertBox.style.background = 'linear-gradient(135deg, #ffd93d 0%, #ffb03a 100%)';
            alertBox.style.color = '#333';
            alertBox.style.marginBottom = '20px';
            alertBox.innerHTML = 
                '<div style="display: flex; align-items: center; margin-bottom: 15px;">' +
                '<span style="font-size: 2em; margin-right: 10px;">Ã¢Å¡Â Ã¯Â¸Â</span>' +
                '<h2 style="margin: 0;">Ã¦Å“ÂªÃ¥Â®Å’Ã¤Âºâ€ Ã£ÂÂ®Ã¨Â©Â¦Ã¥ÂË†Ã¨Â¨ËœÃ©Å’Â²Ã£ÂÅ’Ã£Ââ€šÃ£â€šÅ Ã£ÂÂ¾Ã£Ââ„¢</h2>' +
                '</div>' +
                '<div style="background: rgba(255,255,255,0.9); padding: 15px; border-radius: 10px; margin-bottom: 15px;">' +
                '<div style="margin-bottom: 8px;"><strong>Ã°Å¸â€œâ€¦ Ã¨Â©Â¦Ã¥ÂË†Ã¦â€”Â¥:</strong> ' + dateStr + '</div>' +
                '<div style="margin-bottom: 8px;"><strong>Ã°Å¸Ââ‚¬ Ã¥Â¯Â¾Ã¦Ë†Â¦Ã§â€ºÂ¸Ã¦â€°â€¹:</strong> ' + (draftTeamGame.opponent || 'Ã¦Å“ÂªÃ¨Â¨Â­Ã¥Â®Å¡') + '</div>' +
                '<div><strong>Ã°Å¸â€™Â¾ Ã¤Â¿ÂÃ¥Â­ËœÃ¦â€”Â¥Ã¦â„¢â€š:</strong> ' + new Date(draftTeamGame.savedAt).toLocaleString('ja-JP') + '</div>' +
                '</div>' +
                '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">' +
                '<button class="primary-btn" style="background: #2ecc71;" onclick="resumeDraftGame()">Ã¢â€“Â¶Ã¯Â¸Â Ã§Â¶Å¡Ã£ÂÂÃ£Ââ€¹Ã£â€šâ€°Ã¨Â¨ËœÃ©Å’Â²</button>' +
                '<button class="primary-btn" style="background: #e74c3c;" onclick="deleteDraftGame()">Ã°Å¸â€”â€˜Ã¯Â¸Â Ã¥â€°Å Ã©â„¢Â¤Ã£Ââ€”Ã£ÂÂ¦Ã¦â€“Â°Ã¨Â¦ÂÃ¤Â½Å“Ã¦Ë†Â</button>' +
                '</div>';
            
            // Ã£â€šÂ¿Ã£Æ’â€“Ã£ÂÂ®Ã¦Å“â‚¬Ã¥Ë†ÂÃ£ÂÂ«Ã¦Å’Â¿Ã¥â€¦Â¥
            teamRecordTab.insertBefore(alertBox, teamRecordTab.firstChild);
        }

        // ========== Ã©â‚¬â€Ã¤Â¸Â­Ã¤Â¿ÂÃ¥Â­ËœÃ£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã¥â€°Å Ã©â„¢Â¤Ã£Ââ€”Ã£ÂÂ¦Ã¦â€“Â°Ã¨Â¦ÂÃ¤Â½Å“Ã¦Ë†Â ==========
        function deleteDraftGame() {
            if (!confirm('Ã¢Å¡Â Ã¯Â¸Â Ã©â‚¬â€Ã¤Â¸Â­Ã¤Â¿ÂÃ¥Â­ËœÃ£Ââ€¢Ã£â€šÅ’Ã£ÂÅ¸Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã¥â€°Å Ã©â„¢Â¤Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ„¢\n\nÃ¥â€°Å Ã©â„¢Â¤Ã£Ââ„¢Ã£â€šâ€¹Ã£ÂÂ¨Ã¥Â¾Â©Ã¥â€¦Æ’Ã£ÂÂ§Ã£ÂÂÃ£ÂÂ¾Ã£Ââ€ºÃ£â€šâ€œÃ£â‚¬â€š\nÃ¦Å“Â¬Ã¥Â½â€œÃ£ÂÂ«Ã£â€šË†Ã£â€šÂÃ£Ââ€”Ã£Ââ€Ã£ÂÂ§Ã£Ââ„¢Ã£Ââ€¹Ã¯Â¼Å¸')) {
                return;
            }
            
            clearDraftTeamGame();
            
            // Ã¨Â­Â¦Ã¥â€˜Å Ã£Æ’Å“Ã£Æ’Æ’Ã£â€šÂ¯Ã£â€šÂ¹Ã£â€šâ€™Ã¥â€°Å Ã©â„¢Â¤
            const alertBox = document.getElementById('draftGameAlert');
            if (alertBox) {
                alertBox.remove();
            }
            
            alert('Ã¢Å“â€¦ Ã©â‚¬â€Ã¤Â¸Â­Ã¤Â¿ÂÃ¥Â­ËœÃ£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã¥â€°Å Ã©â„¢Â¤Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸\n\nÃ¦â€“Â°Ã£Ââ€”Ã£Ââ€Ã¨Â©Â¦Ã¥ÂË†Ã£â€šâ€™Ã¨Â¨ËœÃ©Å’Â²Ã£ÂÂ§Ã£ÂÂÃ£ÂÂ¾Ã£Ââ„¢Ã£â‚¬â€š');
        }

        

        function switchTeamTab(tab) {
            // Ã£â€šÂ¿Ã£Æ’â€“Ã£Æ’Å“Ã£â€šÂ¿Ã£Æ’Â³Ã£Â®Ã¥Ë†â€¡Ã£â€šÅ Ã¦â€ºÂ¿Ã£Ë†
            const tabs = document.querySelectorAll('#teamMode .tab');
            tabs.forEach(function(t) {
                t.classList.remove('active');
            });
            
            if (tab === 'record') {
                tabs[0].classList.add('active');
                document.getElementById('teamRecordTab').style.display = 'block';
                document.getElementById('teamHistoryTab').style.display = 'none';
                document.getElementById('teamRankingTab').style.display = 'none';
                checkAndShowDraftGame();
            } else if (tab === 'history') {
                tabs[1].classList.add('active');
                document.getElementById('teamRecordTab').style.display = 'none';
                document.getElementById('teamHistoryTab').style.display = 'block';
                document.getElementById('teamRankingTab').style.display = 'none';
                displayTeamGamesHistory();
            } else if (tab === 'ranking') {
                tabs[2].classList.add('active');
                document.getElementById('teamRecordTab').style.display = 'none';
                document.getElementById('teamHistoryTab').style.display = 'none';
                document.getElementById('teamRankingTab').style.display = 'block';
                displayTeamRankings();
            }
        }

        }

        function displayTeamGamesHistory() {
            const listEl = document.getElementById('teamGamesList');
            
            if (teamGames.length === 0) {
                listEl.innerHTML = '<div class="empty-state"><div class="icon">Ã°Å¸Ââ‚¬</div><h3>Ã£ÂÂ¾Ã£ÂÂ Ã¨Â©Â¦Ã¥ÂË†Ã¨Â¨ËœÃ©Å’Â²Ã£ÂÅ’Ã£Ââ€šÃ£â€šÅ Ã£ÂÂ¾Ã£Ââ€ºÃ£â€šâ€œ</h3><p>Ã¨Â©Â¦Ã¥ÂË†Ã¨Â¨ËœÃ©Å’Â²Ã£â€šÂ¿Ã£Æ’â€“Ã£ÂÂ§Ã¨Â¨ËœÃ©Å’Â²Ã£â€šâ€™Ã©â€“â€¹Ã¥Â§â€¹Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£â€šâ€¡Ã£Ââ€ Ã¯Â¼Â</p></div>';
                return;
            }
            
            let html = '<div class="card"><h2 style="margin-bottom: 20px;">Ã°Å¸â€œÅ  Ã¨Â©Â¦Ã¥ÂË†Ã¥Â±Â¥Ã¦Â­Â´</h2></div>';
            
            // ========== Ã¦Å“â‚¬Ã¦â€“Â°Ã£ÂÂ®Ã¨Â©Â¦Ã¥ÂË†Ã£ÂÅ’Ã¤Â¸Å Ã£ÂÂ«Ã¦ÂÂ¥Ã£â€šâ€¹Ã£â€šË†Ã£Ââ€ Ã£ÂÂ«Ã£â€šÂ½Ã£Æ’Â¼Ã£Æ’Ë† ==========
            const sortedGames = teamGames.slice().sort(function(a, b) {
                const dateA = new Date(a.date);
                const dateB = new Date(b.date);
                return dateB - dateA; // Ã¦â€“Â°Ã£Ââ€”Ã£Ââ€Ã©Â â€ Ã¯Â¼Ë†Ã©â„¢ÂÃ©Â â€ Ã¯Â¼â€°
            });
            // ====================================================
            
            sortedGames.forEach(function(game, index) {
                // Ã¥â€¦Æ’Ã£ÂÂ®Ã£â€šÂ¤Ã£Æ’Â³Ã£Æ’â€¡Ã£Æ’Æ’Ã£â€šÂ¯Ã£â€šÂ¹Ã£â€šâ€™Ã¥Ââ€“Ã¥Â¾â€”Ã¯Â¼Ë†Ã§Â·Â¨Ã©â€ºâ€ Ã£Æ’Â»Ã¥â€°Å Ã©â„¢Â¤Ã§â€Â¨Ã¯Â¼â€°
                const originalIndex = teamGames.indexOf(game);
                const dateObj = new Date(game.date);
                const dateStr = dateObj.toLocaleDateString('ja-JP', {year: 'numeric', month: 'long', day: 'numeric'});
                
                // Ã£â€šÂ¹Ã£â€šÂ³Ã£â€šÂ¢Ã¦Æ’â€¦Ã¥Â Â±Ã£â€šâ€™Ã¨Â¨Ë†Ã§Â®â€”
                let scoreHtml = '';
                if (game.scores) {
                    const ourTotal = (game.scores.our.q1 || 0) + (game.scores.our.q2 || 0) + (game.scores.our.q3 || 0) + (game.scores.our.q4 || 0);
                    const oppTotal = (game.scores.opp.q1 || 0) + (game.scores.opp.q2 || 0) + (game.scores.opp.q3 || 0) + (game.scores.opp.q4 || 0);
                    const isWin = ourTotal > oppTotal;
                    const outcome = ourTotal === oppTotal ? 'Ã¥Â¼â€¢Ã£ÂÂÃ¥Ë†â€ Ã£Ââ€˜' : (isWin ? 'Ã¥â€¹ÂÃ¥Ë†Â©' : 'Ã¦â€¢â€”Ã¥Å’â€”');
                    
                    scoreHtml = '<div style="font-size: 1.5em; font-weight: bold; margin-top: 5px;">' +
                        ourTotal + ' - ' + oppTotal + ' (' + outcome + ')' +
                        '</div>';
                }
                
                html += '<div class="game-history-item" onclick="toggleGameDetail(' + originalIndex + ')">' +
                    '<div class="game-date">' + dateStr + '</div>' +
                    '<div class="game-opponent">vs ' + (game.opponent || 'Ã¥Â¯Â¾Ã¦Ë†Â¦Ã§â€ºÂ¸Ã¦â€°â€¹Ã£ÂÂªÃ£Ââ€”') + '</div>' +
                    scoreHtml +
                    '</div>' +
                    '<div class="game-detail" id="gameDetail' + originalIndex + '">' +
                    generateScoreDetail(game) +
                    '<button class="edit-game-btn" onclick="event.stopPropagation(); openEditGameModal(' + originalIndex + ')">Ã°Å¸â€œÂ Ã¨Â©Â¦Ã¥ÂË†Ã¨Â¨ËœÃ©Å’Â²Ã£â€šâ€™Ã§Â·Â¨Ã©â€ºâ€ Ã¯Â¼Ë†Ã§Â®Â¡Ã§Ââ€ Ã¨â‚¬â€¦Ã£ÂÂ®Ã£ÂÂ¿Ã¯Â¼â€°</button>' +
                    generateGameRankings(game) +
                    '</div>';
            });
            
            listEl.innerHTML = html;
        }

        function toggleGameDetail(index) {
            const detail = document.getElementById('gameDetail' + index);
            detail.classList.toggle('active');
        }

        function generateScoreDetail(game) {
            if (!game.scores) return '';
            
            const ourTotal = (game.scores.our.q1 || 0) + (game.scores.our.q2 || 0) + (game.scores.our.q3 || 0) + (game.scores.our.q4 || 0);
            const oppTotal = (game.scores.opp.q1 || 0) + (game.scores.opp.q2 || 0) + (game.scores.opp.q3 || 0) + (game.scores.opp.q4 || 0);
            const isWin = ourTotal > oppTotal;
            const outcome = ourTotal === oppTotal ? 'Ã¥Â¼â€¢Ã£ÂÂÃ¥Ë†â€ Ã£Ââ€˜' : (isWin ? 'Ã¥â€¹ÂÃ¥Ë†Â©' : 'Ã¦â€¢â€”Ã¥Å’â€”');
            
            // Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¥ÂÂÃ£â€šâ€™Ã¥Ââ€“Ã¥Â¾â€”
            const ourTeamName = teamData ? teamData.name : 'Ã¨â€¡ÂªÃ£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â ';
            const oppTeamName = game.opponent || 'Ã¥Â¯Â¾Ã¦Ë†Â¦Ã§â€ºÂ¸Ã¦â€°â€¹';
            
            let html = '<div class="game-result' + (isWin ? '' : ' loss') + '">';
            html += '<div class="result-label">Ã¨Â©Â¦Ã¥ÂË†Ã§ÂµÂÃ¦Å¾Å“</div>';
            html += '<div class="result-score">' + ourTotal + ' - ' + oppTotal + '</div>';
            
            // ========== Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¥ÂÂÃ£â€šâ€™Ã¨Â¿Â½Ã¥Å Â  ==========
            html += '<div class="team-names">';
            html += '<span class="our-team-name">' + ourTeamName + '</span>';
            html += '<span class="vs-label">VS</span>';
            html += '<span class="opp-team-name">' + oppTeamName + '</span>';
            html += '</div>';
            // ===================================
            
            html += '<div class="result-outcome">' + outcome + '</div>';
            html += '</div>';
            
            html += '<div class="quarter-scores">';
            for (let i = 1; i <= 4; i++) {
                const ourScore = game.scores.our['q' + i] || 0;
                const oppScore = game.scores.opp['q' + i] || 0;
                const diff = ourScore - oppScore;
                const diffClass = diff > 0 ? 'positive' : (diff < 0 ? 'negative' : '');
                const diffText = diff > 0 ? '+' + diff : diff;
                
                html += '<div class="quarter-score-item">';
                html += '<div class="quarter-label">Q' + i + '</div>';
                html += '<div class="quarter-value">' + ourScore + ' - ' + oppScore + '</div>';
                html += '<div class="quarter-diff ' + diffClass + '">(' + diffText + ')</div>';
                html += '</div>';
            }
            html += '</div>';
            
            return html;
        }

        function generateGameRankings(game) {
            let html = '';
            
            // Ã¥Â¾â€”Ã§â€šÂ¹Ã£Æ’Â©Ã£Æ’Â³Ã£â€šÂ­Ã£Æ’Â³Ã£â€šÂ°
            html += generateRankingSection(game, 'points', 'Ã°Å¸Ââ€  Ã¥Â¾â€”Ã§â€šÂ¹Ã§Å½â€¹', function(stats) {
                return (stats.twoPointsMade * 2) + (stats.threePointsMade * 3) + stats.freeThrowsMade;
            }, 'Ã§â€šÂ¹');
            
            // Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã¦Ë†ÂÃ¥Å Å¸Ã§Å½â€¡Ã£Æ’Â©Ã£Æ’Â³Ã£â€šÂ­Ã£Æ’Â³Ã£â€šÂ°
            html += generateRankingSection(game, 'fieldGoalPct', 'Ã°Å¸Å½Â¯ Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã¦Ë†ÂÃ¥Å Å¸Ã§Å½â€¡', function(stats) {
                const made = stats.twoPointsMade + stats.threePointsMade;
                const attempted = stats.twoPointsAttempted + stats.threePointsAttempted;
                return attempted > 0 ? ((made / attempted) * 100).toFixed(1) : 0;
            }, '%', true);
            
            // Ã£Æ’ÂªÃ£Æ’ÂÃ£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°Ã£Æ’Â©Ã£Æ’Â³Ã£â€šÂ­Ã£Æ’Â³Ã£â€šÂ°
            html += generateRankingSection(game, 'rebounds', 'Ã°Å¸â€œÂ¦ Ã£Æ’ÂªÃ£Æ’ÂÃ£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°Ã§Å½â€¹', function(stats) {
                return stats.offensiveRebounds + stats.defensiveRebounds;
            }, 'Ã¦Å“Â¬');
            
            // Ã£â€šÂ¢Ã£â€šÂ·Ã£â€šÂ¹Ã£Æ’Ë†Ã£Æ’Â©Ã£Æ’Â³Ã£â€šÂ­Ã£Æ’Â³Ã£â€šÂ°
            html += generateRankingSection(game, 'assists', 'Ã°Å¸Â¤Â Ã£â€šÂ¢Ã£â€šÂ·Ã£â€šÂ¹Ã£Æ’Ë†Ã§Å½â€¹', function(stats) {
                return stats.assists;
            }, 'Ã¥â€ºÅ¾');
            
            // Ã£â€šÂ¹Ã£Æ’â€ Ã£â€šÂ£Ã£Æ’Â¼Ã£Æ’Â«Ã£Æ’Â©Ã£Æ’Â³Ã£â€šÂ­Ã£Æ’Â³Ã£â€šÂ°
            html += generateRankingSection(game, 'steals', 'Ã°Å¸â€ºÂ¡Ã¯Â¸Â Ã£â€šÂ¹Ã£Æ’â€ Ã£â€šÂ£Ã£Æ’Â¼Ã£Æ’Â«Ã§Å½â€¹', function(stats) {
                return stats.steals;
            }, 'Ã¥â€ºÅ¾');
            
            return html;
        }
        

        function generateRankingSection(game, key, title, calcFunc, unit, isPercentage) {
            // Ã©ÂÂ¸Ã¦â€°â€¹Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã©â€¦ÂÃ¥Ë†â€”Ã£ÂÂ«Ã¥Â¤â€°Ã¦Ââ€ºÃ£Ââ€”Ã£ÂÂ¦Ã¥â‚¬Â¤Ã£â€šâ€™Ã¨Â¨Ë†Ã§Â®â€”
            const playerData = [];
            Object.keys(game.playerStats).forEach(function(playerId) {
                const player = players.find(function(p) { return p.id === playerId; });
                if (player) {
                    const stats = game.playerStats[playerId];
                    const value = calcFunc(stats);
                    
                    // Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã¦Ë†ÂÃ¥Å Å¸Ã§Å½â€¡Ã£ÂÂ®Ã¥Â Â´Ã¥ÂË†Ã£â‚¬ÂÃ¨Â©Â¦Ã¦Å â€¢Ã¦â€¢Â°Ã£ÂÅ’0Ã£ÂÂ®Ã©ÂÂ¸Ã¦â€°â€¹Ã£ÂÂ¯Ã©â„¢Â¤Ã¥Â¤â€“
                    if (isPercentage) {
                        const attempted = stats.twoPointsAttempted + stats.threePointsAttempted;
                        if (attempted > 0) {
                            playerData.push({
                                player: player,
                                value: parseFloat(value),
                                displayValue: value
                            });
                        }
                    } else {
                        playerData.push({
                            player: player,
                            value: parseFloat(value),
                            displayValue: value
                        });
                    }
                }
            });
            
            // Ã¥â‚¬Â¤Ã£ÂÂ§Ã£â€šÂ½Ã£Æ’Â¼Ã£Æ’Ë†Ã¯Â¼Ë†Ã©â„¢ÂÃ©Â â€ Ã¯Â¼â€°
            playerData.sort(function(a, b) { return b.value - a.value; });
            
            if (playerData.length === 0) {
                return '';
            }
            
            let html = '<div class="ranking-section">';
            html += '<h3>' + title + '</h3>';
            
            // TOP3Ã£â€šâ€™Ã¨Â¡Â¨Ã§Â¤Âº
            html += '<div class="top3-container">';
            const medals = ['Ã°Å¸Â¥â€¡', 'Ã°Å¸Â¥Ë†', 'Ã°Å¸Â¥â€°'];
            for (let i = 0; i < Math.min(3, playerData.length); i++) {
                const data = playerData[i];
                html += '<div class="ranking-card">' +
                    '<span class="ranking-medal">' + medals[i] + '</span>' +
                    '<div class="ranking-info">' +
                    '<span class="player-name">#' + data.player.number + ' ' + data.player.name + '</span>' +
                    '<span class="stat-value">' + data.displayValue + unit + '</span>' +
                    '</div>' +
                    '</div>';
            }
            html += '</div>';
            
            // Ã¥â€¦Â¨Ã©ÂÂ¸Ã¦â€°â€¹Ã£Æ’Â©Ã£Æ’Â³Ã£â€šÂ­Ã£Æ’Â³Ã£â€šÂ°Ã¯Â¼Ë†Ã¦Å ËœÃ£â€šÅ Ã£ÂÅ¸Ã£ÂÅ¸Ã£ÂÂ¿Ã¯Â¼â€°
            if (playerData.length > 3) {
                html += '<button class="toggle-rankings" onclick="toggleAllRankings(\'' + key + game.id + '\')">' +
                    'Ã¢â€“Â¼ Ã¥â€¦Â¨' + playerData.length + 'Ã¥ÂÂÃ£ÂÂ®Ã£Æ’Â©Ã£Æ’Â³Ã£â€šÂ­Ã£Æ’Â³Ã£â€šÂ°Ã£â€šâ€™Ã¨Â¡Â¨Ã§Â¤Âº' +
                    '</button>';
                
                html += '<div class="all-rankings" id="allRankings' + key + game.id + '">';
                playerData.forEach(function(data, index) {
                    html += '<div class="ranking-card">' +
                        '<div class="ranking-info">' +
                        '<span class="rank">' + (index + 1) + 'Ã¤Â½Â</span>' +
                        '<span class="player-name">#' + data.player.number + ' ' + data.player.name + '</span>' +
                        '<span class="stat-value">' + data.displayValue + unit + '</span>' +
                        '</div>' +
                        '</div>';
                });
                html += '</div>';
            }
            
            html += '</div>';
            
            return html;
        }

        function toggleAllRankings(id) {
            const el = document.getElementById('allRankings' + id);
            const btn = event.target;
            
            if (el.classList.contains('active')) {
                el.classList.remove('active');
                btn.classList.remove('active');
                btn.textContent = btn.textContent.replace('Ã¢â€“Â² Ã©â€“â€°Ã£ÂËœÃ£â€šâ€¹', 'Ã¢â€“Â¼ Ã¥â€¦Â¨' + btn.textContent.match(/\d+/)[0] + 'Ã¥ÂÂÃ£ÂÂ®Ã£Æ’Â©Ã£Æ’Â³Ã£â€šÂ­Ã£Æ’Â³Ã£â€šÂ°Ã£â€šâ€™Ã¨Â¡Â¨Ã§Â¤Âº');
            } else {
                el.classList.add('active');
                btn.classList.add('active');
                btn.textContent = 'Ã¢â€“Â² Ã©â€“â€°Ã£ÂËœÃ£â€šâ€¹';
            }
        }
        

        // ========== Ã£Æ’Ã£Æ’Â¼Ã£Æ’ Ã£Æ’Â©Ã£Æ’Â³Ã£â€šÂ­Ã£Æ’Â³Ã£â€šÂ°Ã¨Â¡Â¨Ã§Â¤ÂºÃ©â€“Â¢Ã¦â€¢Â° ==========
        function displayTeamRankings() {
            const container = document.getElementById('teamRankingsDisplay');
            
            if (teamGames.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="icon">Ã°Å¸â€ </div><h3>Ã£Â¾Ã£ Ã¨Â©Â¦Ã¥Ë†Ã¨Â¨ËœÃ©Å’Â²Ã£Å’Ã£â€šÃ£â€šÅ Ã£Â¾Ã£â€ºÃ£â€š"</h3><p>Ã¨Â©Â¦Ã¥Ë†Ã¨Â¨ËœÃ©Å’Â²Ã£â€šÂ¿Ã£Æ’â€“Ã£Â§Ã¨Â¨ËœÃ©Å’Â²Ã£â€š'Ã©â€“â€¹Ã¥Â§â€¹Ã£â€”Ã£Â¾Ã£â€”Ã£â€šâ€¡Ã£â€ Ã¯Â¼</p></div>';
                return;
            }
            
            let html = '';
            
            // Ã§â€ºÂ´Ã¨Â¿'3Ã¨Â©Â¦Ã¥Ë†Ã£Â®Ã£Æ’Â©Ã£Æ’Â³Ã£â€šÂ­Ã£Æ’Â³Ã£â€šÂ°
            html += '<div class="card">';
            html += '<h2 style="margin-bottom: 20px;">Ã°Å¸"Å  Ã§â€ºÂ´Ã¨Â¿'3Ã¨Â©Â¦Ã¥Ë†Ã£Â®Ã£Æ’Â©Ã£Æ’Â³Ã£â€šÂ­Ã£Æ’Â³Ã£â€šÂ°</h2>';
            html += '<p style="color: #666; margin-bottom: 20px; font-size: 0.9em;">Ã¦Å“â‚¬Ã¦â€“Â°3Ã¨Â©Â¦Ã¥Ë†Ã£Â®Ã¥Ë†Ã¨Â¨Ë†Ã¥â‚¬Â¤Ã£Æ’Â»Ã¥Â¹Â³Ã¥â€¡Ã¥â‚¬Â¤Ã£Â§Ã§Â®â€”Ã¥â€¡Âº</p>';
            html += calculateRecentGamesRankings();
            html += '</div>';
            
            // Ã¥â€¦Â¨Ã¨Â©Â¦Ã¥Ë†Ã£Â®Ã£Æ’Â©Ã£Æ’Â³Ã£â€šÂ­Ã£Æ’Â³Ã£â€šÂ°
            html += '<div class="card">';
            html += '<h2 style="margin-bottom: 20px;">Ã°Å¸â€  Ã¥â€¦Â¨Ã¨Â©Â¦Ã¥Ë†Ã©â‚¬Å¡Ã§Â®â€”Ã£Æ’Â©Ã£Æ’Â³Ã£â€šÂ­Ã£Æ’Â³Ã£â€šÂ°</h2>';
            html += '<p style="color: #666; margin-bottom: 20px; font-size: 0.9em;">Ã¥â€¦Â¨' + teamGames.length + 'Ã¨Â©Â¦Ã¥Ë†Ã£Â®Ã¥Â¹Â³Ã¥â€¡Ã¥â‚¬Â¤Ã£Æ’Â»Ã¥Ë†Ã¨Â¨Ë†Ã¥â‚¬Â¤Ã£Â§Ã§Â®â€”Ã¥â€¡Âº</p>';
            html += calculateAllGamesRankings();
            html += '</div>';
            
            container.innerHTML = html;
        }
        
        function calculateRecentGamesRankings() {
            // Ã¦Å“â‚¬Ã¦â€“Â°3Ã¨Â©Â¦Ã¥Ë†Ã£â€š'Ã¥â€“Ã¥Â¾â€”
            const recentGames = teamGames.slice().sort(function(a, b) {
                return new Date(b.date) - new Date(a.date);
            }).slice(0, 3);
            
            if (recentGames.length === 0) return '';
            
            // Ã¥â€Ã©Â¸Ã¦â€°â€¹Ã£Â®Ã§ÂµÂ±Ã¨Â¨Ë†Ã£â€š'Ã©â€ºâ€ Ã¨Â¨Ë†
            const playerStats = {};
            
            recentGames.forEach(function(game) {
                Object.keys(game.playerStats).forEach(function(playerId) {
                    const stats = game.playerStats[playerId];
                    
                    if (!playerStats[playerId]) {
                        playerStats[playerId] = {
                            gamesPlayed: 0,
                            totalPoints: 0,
                            totalRebounds: 0,
                            totalAssists: 0,
                            totalFGMade: 0,
                            totalFGAttempted: 0
                        };
                    }
                    
                    playerStats[playerId].gamesPlayed++;
                    playerStats[playerId].totalPoints += (stats.twoPointsMade * 2) + (stats.threePointsMade * 3) + stats.freeThrowsMade;
                    playerStats[playerId].totalRebounds += stats.offensiveRebounds + stats.defensiveRebounds;
                    playerStats[playerId].totalAssists += stats.assists;
                    playerStats[playerId].totalFGMade += stats.twoPointsMade + stats.threePointsMade;
                    playerStats[playerId].totalFGAttempted += stats.twoPointsAttempted + stats.threePointsAttempted;
                });
            });
            
            let html = '';
            
            // Ã¥Â¾â€”Ã§â€šÂ¹Ã§Å½â€¹Ã¯Â¼Ë†Ã¥Ë†Ã¨Â¨Ë†Ã¯Â¼â€°
            html += generateTeamRankingSection(
                playerStats,
                'Ã°Å¸â€  Ã¥Â¾â€”Ã§â€šÂ¹Ã§Å½â€¹Ã¯Â¼Ë†Ã¥Ë†Ã¨Â¨Ë†Ã¯Â¼â€°',
                function(stats) { return stats.totalPoints; },
                'Ã§â€šÂ¹',
                false,
                'recentPoints'
            );
            
            // Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã¦Ë†Ã¥Å Å¸Ã§Å½â€¡Ã¯Â¼Ë†Ã¥Â¹Â³Ã¥â€¡Ã¯Â¼â€°
            html += generateTeamRankingSection(
                playerStats,
                'Ã°Å¸Å½Â¯ Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã¦Ë†Ã¥Å Å¸Ã§Å½â€¡Ã¯Â¼Ë†Ã¥Â¹Â³Ã¥â€¡Ã¯Â¼â€°',
                function(stats) { 
                    return stats.totalFGAttempted > 0 ? (stats.totalFGMade / stats.totalFGAttempted * 100).toFixed(1) : 0;
                },
                '%',
                true,
                'recentFG'
            );
            
            // Ã£Æ’ÂªÃ£Æ’Ã£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°Ã§Å½â€¹Ã¯Â¼Ë†Ã¥Ë†Ã¨Â¨Ë†Ã¯Â¼â€°
            html += generateTeamRankingSection(
                playerStats,
                'Ã°Å¸"Â¦ Ã£Æ’ÂªÃ£Æ’Ã£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°Ã§Å½â€¹Ã¯Â¼Ë†Ã¥Ë†Ã¨Â¨Ë†Ã¯Â¼â€°',
                function(stats) { return stats.totalRebounds; },
                'Ã¦Å“Â¬',
                false,
                'recentReb'
            );
            
            // Ã£â€šÂ¢Ã£â€šÂ·Ã£â€šÂ¹Ã£Æ’Ë†Ã§Å½â€¹Ã¯Â¼Ë†Ã¥Ë†Ã¨Â¨Ë†Ã¯Â¼â€°
            html += generateTeamRankingSection(
                playerStats,
                'Ã°Å¸Â¤ Ã£â€šÂ¢Ã£â€šÂ·Ã£â€šÂ¹Ã£Æ’Ë†Ã§Å½â€¹Ã¯Â¼Ë†Ã¥Ë†Ã¨Â¨Ë†Ã¯Â¼â€°',
                function(stats) { return stats.totalAssists; },
                'Ã¥â€ºÅ¾',
                false,
                'recentAst'
            );
            
            return html;
        }
        
        function calculateAllGamesRankings() {
            if (teamGames.length === 0) return '';
            
            // Ã¥â€Ã©Â¸Ã¦â€°â€¹Ã£Â®Ã§ÂµÂ±Ã¨Â¨Ë†Ã£â€š'Ã©â€ºâ€ Ã¨Â¨Ë†
            const playerStats = {};
            
            teamGames.forEach(function(game) {
                Object.keys(game.playerStats).forEach(function(playerId) {
                    const stats = game.playerStats[playerId];
                    
                    if (!playerStats[playerId]) {
                        playerStats[playerId] = {
                            gamesPlayed: 0,
                            totalPoints: 0,
                            totalRebounds: 0,
                            totalAssists: 0,
                            totalFGMade: 0,
                            totalFGAttempted: 0
                        };
                    }
                    
                    playerStats[playerId].gamesPlayed++;
                    playerStats[playerId].totalPoints += (stats.twoPointsMade * 2) + (stats.threePointsMade * 3) + stats.freeThrowsMade;
                    playerStats[playerId].totalRebounds += stats.offensiveRebounds + stats.defensiveRebounds;
                    playerStats[playerId].totalAssists += stats.assists;
                    playerStats[playerId].totalFGMade += stats.twoPointsMade + stats.threePointsMade;
                    playerStats[playerId].totalFGAttempted += stats.twoPointsAttempted + stats.threePointsAttempted;
                });
            });
            
            let html = '';
            
            // Ã¥Â¾â€”Ã§â€šÂ¹Ã§Å½â€¹Ã¯Â¼Ë†Ã¥Â¹Â³Ã¥â€¡ + Ã¥Ë†Ã¨Â¨Ë†Ã¯Â¼â€°
            html += generateTeamRankingSection(
                playerStats,
                'Ã°Å¸â€  Ã¥Â¾â€”Ã§â€šÂ¹Ã§Å½â€¹',
                function(stats) { 
                    const avg = (stats.totalPoints / stats.gamesPlayed).toFixed(1);
                    return { value: parseFloat(avg), display: avg + 'Ã§â€šÂ¹Ã¯Â¼Ë†Ã¥Ë†Ã¨Â¨Ë†' + stats.totalPoints + 'Ã§â€šÂ¹Ã¯Â¼â€°' };
                },
                '',
                false,
                'allPoints',
                true
            );
            
            // Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã¦Ë†Ã¥Å Å¸Ã§Å½â€¡Ã¯Â¼Ë†Ã¥Â¹Â³Ã¥â€¡Ã¯Â¼â€°
            html += generateTeamRankingSection(
                playerStats,
                'Ã°Å¸Å½Â¯ Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã¦Ë†Ã¥Å Å¸Ã§Å½â€¡',
                function(stats) { 
                    return stats.totalFGAttempted > 0 ? (stats.totalFGMade / stats.totalFGAttempted * 100).toFixed(1) : 0;
                },
                '%',
                true,
                'allFG'
            );
            
            // Ã£Æ’ÂªÃ£Æ’Ã£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°Ã§Å½â€¹Ã¯Â¼Ë†Ã¥Â¹Â³Ã¥â€¡ + Ã¥Ë†Ã¨Â¨Ë†Ã¯Â¼â€°
            html += generateTeamRankingSection(
                playerStats,
                'Ã°Å¸"Â¦ Ã£Æ’ÂªÃ£Æ’Ã£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°Ã§Å½â€¹',
                function(stats) { 
                    const avg = (stats.totalRebounds / stats.gamesPlayed).toFixed(1);
                    return { value: parseFloat(avg), display: avg + 'Ã¦Å“Â¬Ã¯Â¼Ë†Ã¥Ë†Ã¨Â¨Ë†' + stats.totalRebounds + 'Ã¦Å“Â¬Ã¯Â¼â€°' };
                },
                '',
                false,
                'allReb',
                true
            );
            
            // Ã£â€šÂ¢Ã£â€šÂ·Ã£â€šÂ¹Ã£Æ’Ë†Ã§Å½â€¹Ã¯Â¼Ë†Ã¥Â¹Â³Ã¥â€¡ + Ã¥Ë†Ã¨Â¨Ë†Ã¯Â¼â€°
            html += generateTeamRankingSection(
                playerStats,
                'Ã°Å¸Â¤ Ã£â€šÂ¢Ã£â€šÂ·Ã£â€šÂ¹Ã£Æ’Ë†Ã§Å½â€¹',
                function(stats) { 
                    const avg = (stats.totalAssists / stats.gamesPlayed).toFixed(1);
                    return { value: parseFloat(avg), display: avg + 'Ã¥â€ºÅ¾Ã¯Â¼Ë†Ã¥Ë†Ã¨Â¨Ë†' + stats.totalAssists + 'Ã¥â€ºÅ¾Ã¯Â¼â€°' };
                },
                '',
                false,
                'allAst',
                true
            );
            
            return html;
        }
        
        function generateTeamRankingSection(playerStats, title, calcFunc, unit, isPercentage, key, useCustomDisplay) {
            const playerData = [];
            
            Object.keys(playerStats).forEach(function(playerId) {
                const player = players.find(function(p) { return p.id === playerId; });
                if (!player) return;
                
                const stats = playerStats[playerId];
                const result = calcFunc(stats);
                
                let value, displayValue;
                if (useCustomDisplay && typeof result === 'object') {
                    value = result.value;
                    displayValue = result.display;
                } else {
                    value = parseFloat(result);
                    displayValue = result + unit;
                }
                
                // Ã£â€šÂ·Ã£Æ’Â¥Ã£Æ’Â¼Ã£Æ’Ë†Ã¦Ë†Ã¥Å Å¸Ã§Å½â€¡Ã£Â®Ã¥ Â´Ã¥Ë†Ã£â‚¬Ã¨Â©Â¦Ã¦Å â€¢Ã¦â€¢Â°Ã£Å’0Ã£Â®Ã©Â¸Ã¦â€°â€¹Ã£Â¯Ã©â„¢Â¤Ã¥Â¤â€“
                if (isPercentage && stats.totalFGAttempted === 0) {
                    return;
                }
                
                // Ã¥â‚¬Â¤Ã£Å’0Ã¤Â»Â¥Ã¤Â¸Å Ã£Â®Ã¥ Â´Ã¥Ë†Ã£Â®Ã£Â¿Ã¨Â¿Â½Ã¥Å  
                if (value > 0 || !isPercentage) {
                    playerData.push({
                        player: player,
                        value: value,
                        displayValue: displayValue
                    });
                }
            });
            
            // Ã¥â‚¬Â¤Ã£Â§Ã£â€šÂ½Ã£Æ’Â¼Ã£Æ’Ë†Ã¯Â¼Ë†Ã©â„¢Ã© â€ Ã¯Â¼â€°
            playerData.sort(function(a, b) { return b.value - a.value; });
            
            if (playerData.length === 0) {
                return '';
            }
            
            let html = '<div class="ranking-section">';
            html += '<h3>' + title + '</h3>';
            
            // TOP3Ã£â€š'Ã¨Â¡Â¨Ã§Â¤Âº
            html += '<div class="top3-container">';
            const medals = ['Ã°Å¸Â¥â€¡', 'Ã°Å¸Â¥Ë†', 'Ã°Å¸Â¥â€°'];
            for (let i = 0; i < Math.min(3, playerData.length); i++) {
                const data = playerData[i];
                html += '<div class="ranking-card">' +
                    '<span class="ranking-medal">' + medals[i] + '</span>' +
                    '<div class="ranking-info">' +
                    '<span class="player-name">#' + data.player.number + ' ' + data.player.name + '</span>' +
                    '<span class="stat-value">' + data.displayValue + '</span>' +
                    '</div>' +
                    '</div>';
            }
            html += '</div>';
            
            // Ã¥â€¦Â¨Ã©Â¸Ã¦â€°â€¹Ã£Æ’Â©Ã£Æ’Â³Ã£â€šÂ­Ã£Æ’Â³Ã£â€šÂ°Ã¯Â¼Ë†Ã¦Å ËœÃ£â€šÅ Ã£Å¸Ã£Å¸Ã£Â¿Ã¯Â¼â€°
            if (playerData.length > 3) {
                html += '<button class="toggle-rankings" onclick="toggleAllRankings('' + key + '')">' +
                    'Ã¢â€“Â¼ Ã¥â€¦Â¨' + playerData.length + 'Ã¥Ã£Â®Ã£Æ’Â©Ã£Æ’Â³Ã£â€šÂ­Ã£Æ’Â³Ã£â€šÂ°Ã£â€š'Ã¨Â¡Â¨Ã§Â¤Âº' +
                    '</button>';
                
                html += '<div class="all-rankings" id="allRankings' + key + '">';
                playerData.forEach(function(data, index) {
                    html += '<div class="ranking-card">' +
                        '<div class="ranking-info">' +
                        '<span class="rank">' + (index + 1) + 'Ã¤Â½</span>' +
                        '<span class="player-name">#' + data.player.number + ' ' + data.player.name + '</span>' +
                        '<span class="stat-value">' + data.displayValue + '</span>' +
                        '</div>' +
                        '</div>';
                });
                html += '</div>';
            }
            
            html += '</div>';
            
            return html;
        }
        
        function showCreateTeamModal() {
            document.getElementById('createTeamModal').classList.add('active');
        }

        let currentEditingGameIndex = null;

        function openEditGameModal(gameIndex) {
            // Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£ÂÂ«Ã¥Ââ€šÃ¥Å Â Ã£Ââ€”Ã£ÂÂ¦Ã£Ââ€Ã£ÂÂªÃ£Ââ€Ã¥Â Â´Ã¥ÂË†
            if (!teamData) {
                alert('Ã¢ÂÅ’ Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£ÂÂ«Ã¥Ââ€šÃ¥Å Â Ã£Ââ€”Ã£ÂÂ¦Ã£Ââ€Ã£ÂÂ¾Ã£Ââ€ºÃ£â€šâ€œ');
                return;
            }
            
            // Ã£Æ’â€¡Ã£Æ’ÂÃ£Æ’Æ’Ã£â€šÂ°Ã¯Â¼Å¡Ã§Â®Â¡Ã§Ââ€ Ã¨â‚¬â€¦Ã£Æ’â€˜Ã£â€šÂ¹Ã£Æ’Â¯Ã£Æ’Â¼Ã£Æ’â€°Ã£ÂÅ’Ã¥Ââ€“Ã¥Â¾â€”Ã£ÂÂ§Ã£ÂÂÃ£ÂÂ¦Ã£Ââ€Ã£â€šâ€¹Ã£Ââ€¹Ã§Â¢ÂºÃ¨ÂªÂ
            console.log('teamData:', teamData);
            console.log('Ã§Â®Â¡Ã§Ââ€ Ã¨â‚¬â€¦Ã£Æ’â€˜Ã£â€šÂ¹Ã£Æ’Â¯Ã£Æ’Â¼Ã£Æ’â€°:', teamData.adminPassword);
            
            // Ã§Â®Â¡Ã§Ââ€ Ã¨â‚¬â€¦Ã£Æ’â€˜Ã£â€šÂ¹Ã£Æ’Â¯Ã£Æ’Â¼Ã£Æ’â€°Ã£ÂÅ’Ã¨Â¨Â­Ã¥Â®Å¡Ã£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¦Ã£Ââ€Ã£ÂÂªÃ£Ââ€Ã¥Â Â´Ã¥ÂË†
            if (!teamData.adminPassword) {
                alert('Ã¢Å¡Â Ã¯Â¸Â Ã§Â®Â¡Ã§Ââ€ Ã¨â‚¬â€¦Ã£Æ’â€˜Ã£â€šÂ¹Ã£Æ’Â¯Ã£Æ’Â¼Ã£Æ’â€°Ã£ÂÅ’Ã¨Â¨Â­Ã¥Â®Å¡Ã£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¦Ã£Ââ€Ã£ÂÂ¾Ã£Ââ€ºÃ£â€šâ€œ\n\nÃ£â€šÂ¹Ã£Æ’â€”Ã£Æ’Â¬Ã£Æ’Æ’Ã£Æ’â€°Ã£â€šÂ·Ã£Æ’Â¼Ã£Æ’Ë†Ã£ÂÂ®Ã£â‚¬Å’Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¦Æ’â€¦Ã¥Â Â±Ã£â‚¬ÂÃ£â€šÂ·Ã£Æ’Â¼Ã£Æ’Ë†B4Ã£â€šÂ»Ã£Æ’Â«Ã£ÂÂ«Ã£Æ’â€˜Ã£â€šÂ¹Ã£Æ’Â¯Ã£Æ’Â¼Ã£Æ’â€°Ã£â€šâ€™Ã¨Â¨Â­Ã¥Â®Å¡Ã£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€Ã£â‚¬â€š\nÃ£ÂÂÃ£ÂÂ®Ã¥Â¾Å’Ã£â‚¬ÂÃ£â‚¬Å’Ã¤Â»Å Ã£Ââ„¢Ã£ÂÂÃ¥ÂÅ’Ã¦Å“Å¸Ã£â‚¬ÂÃ£Æ’Å“Ã£â€šÂ¿Ã£Æ’Â³Ã£â€šâ€™Ã¦Å Â¼Ã£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€Ã£â‚¬â€š');
                return;
            }
            
            // Ã§Â®Â¡Ã§Ââ€ Ã¨â‚¬â€¦Ã£Æ’â€˜Ã£â€šÂ¹Ã£Æ’Â¯Ã£Æ’Â¼Ã£Æ’â€°Ã£â€šâ€™Ã§Â¢ÂºÃ¨ÂªÂ
            const password = prompt('Ã°Å¸â€â€™ Ã§Â®Â¡Ã§Ââ€ Ã¨â‚¬â€¦Ã£Æ’â€˜Ã£â€šÂ¹Ã£Æ’Â¯Ã£Æ’Â¼Ã£Æ’â€°Ã£â€šâ€™Ã¥â€¦Â¥Ã¥Å â€ºÃ£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€\n\nÃ¢â‚¬Â»Ã£â€šÂ¹Ã£Æ’â€”Ã£Æ’Â¬Ã£Æ’Æ’Ã£Æ’â€°Ã£â€šÂ·Ã£Æ’Â¼Ã£Æ’Ë†Ã£ÂÂ®Ã£â‚¬Å’Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¦Æ’â€¦Ã¥Â Â±Ã£â‚¬ÂÃ£â€šÂ·Ã£Æ’Â¼Ã£Æ’Ë†B4Ã£â€šÂ»Ã£Æ’Â«Ã£ÂÂ§Ã§Â¢ÂºÃ¨ÂªÂÃ£ÂÂ§Ã£ÂÂÃ£ÂÂ¾Ã£Ââ„¢');
            
            if (!password) {
                return;
            }
            
            // Ã§Â©ÂºÃ§â„¢Â½Ã£Æ’ÂÃ£â€šÂ§Ã£Æ’Æ’Ã£â€šÂ¯
            if (password.trim() === '') {
                alert('Ã¢ÂÅ’ Ã£Æ’â€˜Ã£â€šÂ¹Ã£Æ’Â¯Ã£Æ’Â¼Ã£Æ’â€°Ã£â€šâ€™Ã¥â€¦Â¥Ã¥Å â€ºÃ£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€');
                return;
            }
            
            // Ã£Æ’â€˜Ã£â€šÂ¹Ã£Æ’Â¯Ã£Æ’Â¼Ã£Æ’â€°Ã£â€šâ€™Ã¦Â¤Å“Ã¨Â¨Â¼
            const correctPassword = teamData.adminPassword || '';
            
            if (password !== correctPassword) {
                alert('Ã¢ÂÅ’ Ã§Â®Â¡Ã§Ââ€ Ã¨â‚¬â€¦Ã£Æ’â€˜Ã£â€šÂ¹Ã£Æ’Â¯Ã£Æ’Â¼Ã£Æ’â€°Ã£ÂÅ’Ã¦Â­Â£Ã£Ââ€”Ã£ÂÂÃ£Ââ€šÃ£â€šÅ Ã£ÂÂ¾Ã£Ââ€ºÃ£â€šâ€œ\n\nÃ£â€šÂ¹Ã£Æ’â€”Ã£Æ’Â¬Ã£Æ’Æ’Ã£Æ’â€°Ã£â€šÂ·Ã£Æ’Â¼Ã£Æ’Ë†Ã£ÂÂ®Ã£â‚¬Å’Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¦Æ’â€¦Ã¥Â Â±Ã£â‚¬ÂÃ£â€šÂ·Ã£Æ’Â¼Ã£Æ’Ë†B4Ã£â€šÂ»Ã£Æ’Â«Ã£â€šâ€™Ã§Â¢ÂºÃ¨ÂªÂÃ£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€Ã£â‚¬â€š');
                return;
            }
            
            // Ã£Æ’â€˜Ã£â€šÂ¹Ã£Æ’Â¯Ã£Æ’Â¼Ã£Æ’â€°Ã¨ÂªÂÃ¨Â¨Â¼Ã¦Ë†ÂÃ¥Å Å¸
            currentEditingGameIndex = gameIndex;
            const game = teamGames[gameIndex];
            
            // Ã¨Â©Â¦Ã¥ÂË†Ã¦Æ’â€¦Ã¥Â Â±Ã£â€šâ€™Ã¥â€¦Â¥Ã¥Å â€ºÃ¦Â¬â€Ã£ÂÂ«Ã¨Â¨Â­Ã¥Â®Å¡
            document.getElementById('editGameDate').value = game.date;
            document.getElementById('editOpponent').value = game.opponent || '';
            
            // Ã£â€šÂ¹Ã£â€šÂ³Ã£â€šÂ¢Ã£â€šâ€™Ã¥â€¦Â¥Ã¥Å â€ºÃ¦Â¬â€Ã£ÂÂ«Ã¨Â¨Â­Ã¥Â®Å¡
            if (game.scores) {
                document.getElementById('editOurQ1').value = game.scores.our.q1 || 0;
                document.getElementById('editOppQ1').value = game.scores.opp.q1 || 0;
                document.getElementById('editOurQ2').value = game.scores.our.q2 || 0;
                document.getElementById('editOppQ2').value = game.scores.opp.q2 || 0;
                document.getElementById('editOurQ3').value = game.scores.our.q3 || 0;
                document.getElementById('editOppQ3').value = game.scores.opp.q3 || 0;
                document.getElementById('editOurQ4').value = game.scores.our.q4 || 0;
                document.getElementById('editOppQ4').value = game.scores.opp.q4 || 0;
            }
            
            // Ã©ÂÂ¸Ã¦â€°â€¹Ã§ÂµÂ±Ã¨Â¨Ë†Ã£â€šâ€™Ã¨Â¡Â¨Ã§Â¤Âº
            displayEditPlayerStats(game);
            
            // Ã£Æ’Â¢Ã£Æ’Â¼Ã£Æ’â‚¬Ã£Æ’Â«Ã£â€šâ€™Ã©â€“â€¹Ã£ÂÂ
            document.getElementById('editGameModal').classList.add('active');
        }

        function displayEditPlayerStats(game) {
            const container = document.getElementById('editPlayersList');
            let html = '';
            
            Object.keys(game.playerStats).forEach(function(playerId) {
                const player = players.find(function(p) { return p.id === playerId; });
                if (!player) return;
                
                const stats = game.playerStats[playerId];
                
                html += '<div class="player-stat-edit">';
                html += '<div class="player-header">#' + player.number + ' ' + player.name + '</div>';
                html += '<div class="stat-edit-grid">';
                
                html += '<div class="stat-edit-item"><label>2PÃ¦Ë†ÂÃ¥Å Å¸</label><input type="number" min="0" id="edit_' + playerId + '_2pm" value="' + stats.twoPointsMade + '"></div>';
                html += '<div class="stat-edit-item"><label>2PÃ¨Â©Â¦Ã¦Å â€¢</label><input type="number" min="0" id="edit_' + playerId + '_2pa" value="' + stats.twoPointsAttempted + '"></div>';
                html += '<div class="stat-edit-item"><label>3PÃ¦Ë†ÂÃ¥Å Å¸</label><input type="number" min="0" id="edit_' + playerId + '_3pm" value="' + stats.threePointsMade + '"></div>';
                html += '<div class="stat-edit-item"><label>3PÃ¨Â©Â¦Ã¦Å â€¢</label><input type="number" min="0" id="edit_' + playerId + '_3pa" value="' + stats.threePointsAttempted + '"></div>';
                html += '<div class="stat-edit-item"><label>FTÃ¦Ë†ÂÃ¥Å Å¸</label><input type="number" min="0" id="edit_' + playerId + '_ftm" value="' + stats.freeThrowsMade + '"></div>';
                html += '<div class="stat-edit-item"><label>FTÃ¨Â©Â¦Ã¦Å â€¢</label><input type="number" min="0" id="edit_' + playerId + '_fta" value="' + stats.freeThrowsAttempted + '"></div>';
                html += '<div class="stat-edit-item"><label>Ã£â€šÂªÃ£Æ’â€¢Ã£â€šÂ§Ã£Æ’Â³Ã£â€šÂ¹RB</label><input type="number" min="0" id="edit_' + playerId + '_oreb" value="' + stats.offensiveRebounds + '"></div>';
                html += '<div class="stat-edit-item"><label>Ã£Æ’â€¡Ã£â€šÂ£Ã£Æ’â€¢Ã£â€šÂ§Ã£Æ’Â³Ã£â€šÂ¹RB</label><input type="number" min="0" id="edit_' + playerId + '_dreb" value="' + stats.defensiveRebounds + '"></div>';
                html += '<div class="stat-edit-item"><label>Ã£â€šÂ¢Ã£â€šÂ·Ã£â€šÂ¹Ã£Æ’Ë†</label><input type="number" min="0" id="edit_' + playerId + '_ast" value="' + stats.assists + '"></div>';
                html += '<div class="stat-edit-item"><label>Ã£â€šÂ¹Ã£Æ’â€ Ã£â€šÂ£Ã£Æ’Â¼Ã£Æ’Â«</label><input type="number" min="0" id="edit_' + playerId + '_stl" value="' + stats.steals + '"></div>';
                html += '<div class="stat-edit-item"><label>Ã£Æ’â€“Ã£Æ’Â­Ã£Æ’Æ’Ã£â€šÂ¯</label><input type="number" min="0" id="edit_' + playerId + '_blk" value="' + stats.blocks + '"></div>';
                html += '<div class="stat-edit-item"><label>TO</label><input type="number" min="0" id="edit_' + playerId + '_to" value="' + stats.turnovers + '"></div>';
                html += '<div class="stat-edit-item"><label>Ã£Æ’â€¢Ã£â€šÂ¡Ã£â€šÂ¦Ã£Æ’Â«</label><input type="number" min="0" id="edit_' + playerId + '_foul" value="' + stats.fouls + '"></div>';
                
                html += '</div></div>';
            });
            
            container.innerHTML = html;
        }

        function saveGameEdit() {
            if (currentEditingGameIndex === null) return;
            
            const game = teamGames[currentEditingGameIndex];
            
            // Ã¨Â©Â¦Ã¥ÂË†Ã¦Æ’â€¦Ã¥Â Â±Ã£â€šâ€™Ã¦â€ºÂ´Ã¦â€“Â°
            game.date = document.getElementById('editGameDate').value;
            game.opponent = document.getElementById('editOpponent').value;
            
            // Ã£â€šÂ¹Ã£â€šÂ³Ã£â€šÂ¢Ã£â€šâ€™Ã¦â€ºÂ´Ã¦â€“Â°
            if (!game.scores) {
                game.scores = {
                    our: { q1: 0, q2: 0, q3: 0, q4: 0 },
                    opp: { q1: 0, q2: 0, q3: 0, q4: 0 }
                };
            }
            
            game.scores.our.q1 = parseInt(document.getElementById('editOurQ1').value) || 0;
            game.scores.opp.q1 = parseInt(document.getElementById('editOppQ1').value) || 0;
            game.scores.our.q2 = parseInt(document.getElementById('editOurQ2').value) || 0;
            game.scores.opp.q2 = parseInt(document.getElementById('editOppQ2').value) || 0;
            game.scores.our.q3 = parseInt(document.getElementById('editOurQ3').value) || 0;
            game.scores.opp.q3 = parseInt(document.getElementById('editOppQ3').value) || 0;
            game.scores.our.q4 = parseInt(document.getElementById('editOurQ4').value) || 0;
            game.scores.opp.q4 = parseInt(document.getElementById('editOppQ4').value) || 0;
            
            // Ã¥Ââ€Ã©ÂÂ¸Ã¦â€°â€¹Ã£ÂÂ®Ã§ÂµÂ±Ã¨Â¨Ë†Ã£â€šâ€™Ã¦â€ºÂ´Ã¦â€“Â°
            Object.keys(game.playerStats).forEach(function(playerId) {
                const stats = game.playerStats[playerId];
                
                stats.twoPointsMade = parseInt(document.getElementById('edit_' + playerId + '_2pm').value) || 0;
                stats.twoPointsAttempted = parseInt(document.getElementById('edit_' + playerId + '_2pa').value) || 0;
                stats.threePointsMade = parseInt(document.getElementById('edit_' + playerId + '_3pm').value) || 0;
                stats.threePointsAttempted = parseInt(document.getElementById('edit_' + playerId + '_3pa').value) || 0;
                stats.freeThrowsMade = parseInt(document.getElementById('edit_' + playerId + '_ftm').value) || 0;
                stats.freeThrowsAttempted = parseInt(document.getElementById('edit_' + playerId + '_fta').value) || 0;
                stats.offensiveRebounds = parseInt(document.getElementById('edit_' + playerId + '_oreb').value) || 0;
                stats.defensiveRebounds = parseInt(document.getElementById('edit_' + playerId + '_dreb').value) || 0;
                stats.assists = parseInt(document.getElementById('edit_' + playerId + '_ast').value) || 0;
                stats.steals = parseInt(document.getElementById('edit_' + playerId + '_stl').value) || 0;
                stats.blocks = parseInt(document.getElementById('edit_' + playerId + '_blk').value) || 0;
                stats.turnovers = parseInt(document.getElementById('edit_' + playerId + '_to').value) || 0;
                stats.fouls = parseInt(document.getElementById('edit_' + playerId + '_foul').value) || 0;
            });
            
            // Ã¥â‚¬â€¹Ã¤ÂºÂºÃ£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€šÃ¦â€ºÂ´Ã¦â€“Â°
            updatePersonalGamesFromTeamGame(game);
            
            // Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã¤Â¿ÂÃ¥Â­Ëœ
            saveData();
            
            // Ã¥ÂÅ’Ã¦Å“Å¸
            if (teamData) {
                syncGamesOnly();
            }
            
            // Ã¨Â¡Â¨Ã§Â¤ÂºÃ£â€šâ€™Ã¦â€ºÂ´Ã¦â€“Â°
            displayTeamGamesHistory();
            
            // Ã£Æ’Â¢Ã£Æ’Â¼Ã£Æ’â‚¬Ã£Æ’Â«Ã£â€šâ€™Ã©â€“â€°Ã£ÂËœÃ£â€šâ€¹
            closeModal('editGameModal');
            
            alert('Ã¢Å“â€¦ Ã¨Â©Â¦Ã¥ÂË†Ã¨Â¨ËœÃ©Å’Â²Ã£â€šâ€™Ã¦â€ºÂ´Ã¦â€“Â°Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸Ã¯Â¼Â');
        }

        function updatePersonalGamesFromTeamGame(teamGame) {
    // Ã£Ââ€œÃ£ÂÂ®Ã¨Â©Â¦Ã¥ÂË†Ã£ÂÂ«Ã©â€“Â¢Ã©â‚¬Â£Ã£Ââ„¢Ã£â€šâ€¹Ã¥â‚¬â€¹Ã¤ÂºÂºÃ£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã¥â€¦Â¨Ã£ÂÂ¦Ã¥â€°Å Ã©â„¢Â¤(Ã¨Â©Â¦Ã¥ÂË†IDÃ£ÂÂ§Ã§Â¢ÂºÃ¥Â®Å¸Ã£ÂÂ«Ã¥â€°Å Ã©â„¢Â¤)
    personalGames = personalGames.filter(function(g) {
        return !(g.source === 'team' && g.teamGameId === teamGame.id);
    });
    
    // Ã¦â€“Â°Ã£Ââ€”Ã£Ââ€Ã¥â‚¬â€¹Ã¤ÂºÂºÃ£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã¤Â½Å“Ã¦Ë†Â
    Object.keys(teamGame.playerStats).forEach(function(playerId) {
        const stats = teamGame.playerStats[playerId];
        const totalReb = stats.offensiveRebounds + stats.defensiveRebounds;
        const totalPts = (stats.twoPointsMade * 2) + (stats.threePointsMade * 3) + stats.freeThrowsMade;
        
        const personalGame = {
            id: Date.now() + Math.random(),
            date: teamGame.date,
            opponent: teamGame.opponent,
            playTime: 0,
            playerId: playerId,
            twoPointsMade: stats.twoPointsMade,
            twoPointsAttempted: stats.twoPointsAttempted,
            threePointsMade: stats.threePointsMade,
            threePointsAttempted: stats.threePointsAttempted,
            freeThrowsMade: stats.freeThrowsMade,
            freeThrowsAttempted: stats.freeThrowsAttempted,
            offensiveRebounds: stats.offensiveRebounds,
            defensiveRebounds: stats.defensiveRebounds,
            assists: stats.assists,
            steals: stats.steals,
            blocks: stats.blocks,
            turnovers: stats.turnovers,
            fouls: stats.fouls,
            totalRebounds: totalReb,
            twoPointPercentage: stats.twoPointsAttempted > 0 ? ((stats.twoPointsMade / stats.twoPointsAttempted) * 100).toFixed(1) : '0',
            threePointPercentage: stats.threePointsAttempted > 0 ? ((stats.threePointsMade / stats.threePointsAttempted) * 100).toFixed(1) : '0',
            freeThrowPercentage: stats.freeThrowsAttempted > 0 ? ((stats.freeThrowsMade / stats.freeThrowsAttempted) * 100).toFixed(1) : '0',
            totalPoints: totalPts,
            source: 'team',
            teamGameId: teamGame.id  // Ã¢â€ Â Ã¢Ëœâ€¦Ã£Ââ€œÃ£Ââ€œÃ£ÂÅ’Ã©â€¡ÂÃ¨Â¦Â!Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£â€šÂ²Ã£Æ’Â¼Ã£Æ’Â IDÃ£â€šâ€™Ã¤Â¿ÂÃ¥Â­Ëœ
        };
        
        personalGames.unshift(personalGame);
    });
    
    // Ã¥Â±Â¥Ã¦Â­Â´Ã£â€šâ€Ã£â€šÂ°Ã£Æ’Â©Ã£Æ’â€¢Ã£â€šâ€™Ã¦â€ºÂ´Ã¦â€“Â°
    displayGames();
    displayRankings();
    updateCharts();
}
        async function deleteGame() {
    if (currentEditingGameIndex === null) return;
    
    const game = teamGames[currentEditingGameIndex];
    const dateStr = new Date(game.date).toLocaleDateString('ja-JP');
    
    if (!confirm('Ã¢Å¡Â Ã¯Â¸Â Ã¦Å“Â¬Ã¥Â½â€œÃ£ÂÂ«Ã£Ââ€œÃ£ÂÂ®Ã¨Â©Â¦Ã¥ÂË†Ã£â€šâ€™Ã¥â€°Å Ã©â„¢Â¤Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ„¢Ã£Ââ€¹Ã¯Â¼Å¸\n\n' + dateStr + ' vs ' + game.opponent + '\n\nÃ£Ââ€œÃ£ÂÂ®Ã¦â€œÂÃ¤Â½Å“Ã£ÂÂ¯Ã¥Ââ€“Ã£â€šÅ Ã¦Â¶Ë†Ã£Ââ€ºÃ£ÂÂ¾Ã£Ââ€ºÃ£â€šâ€œÃ¯Â¼Â')) {
        return;
    }
    
    // Ã£Æ’Â­Ã£Æ’Â¼Ã£â€šÂ«Ã£Æ’Â«Ã£ÂÂ®Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£Ââ€¹Ã£â€šâ€°Ã¥â€°Å Ã©â„¢Â¤
    teamGames.splice(currentEditingGameIndex, 1);
    
    // Ã¥â‚¬â€¹Ã¤ÂºÂºÃ£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£Ââ€¹Ã£â€šâ€°Ã£â€šâ€šÃ¥â€°Å Ã©â„¢Â¤(Ã¨Â©Â¦Ã¥ÂË†IDÃ£ÂÂ§Ã§Â¢ÂºÃ¥Â®Å¸Ã£ÂÂ«Ã¥â€°Å Ã©â„¢Â¤)
personalGames = personalGames.filter(function(g) {
    return !(g.source === 'team' && g.teamGameId === game.id);
});
    
    saveData();
    
    // Ã£â€šÂµÃ£Æ’Â¼Ã£Æ’ÂÃ£Æ’Â¼Ã£Ââ€¹Ã£â€šâ€°Ã£â€šâ€šÃ¥â€°Å Ã©â„¢Â¤
    if (teamData && teamData.adminPassword) {
        try {
            showSyncIndicator('syncing', 'Ã£â€šÂµÃ£Æ’Â¼Ã£Æ’ÂÃ£Æ’Â¼Ã£Ââ€¹Ã£â€šâ€°Ã¥â€°Å Ã©â„¢Â¤Ã¤Â¸Â­...');
            
            const response = await fetch(API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'text/plain',
                },
                body: JSON.stringify({
                    action: 'deleteGame',
                    teamCode: teamData.code,
                    gameId: game.id,
                    adminPassword: teamData.adminPassword
                })
            });
            
            const result = await response.json();
            
            if (result.success) {
                showSyncIndicator('success', 'Ã¥â€°Å Ã©â„¢Â¤Ã¥Â®Å’Ã¤Âºâ€ Ã¯Â¼Â');
            } else {
                showSyncIndicator('error', result.error || 'Ã¥â€°Å Ã©â„¢Â¤Ã¥Â¤Â±Ã¦â€¢â€”');
                alert('Ã¢Å¡Â Ã¯Â¸Â Ã£â€šÂµÃ£Æ’Â¼Ã£Æ’ÂÃ£Æ’Â¼Ã£Ââ€¹Ã£â€šâ€°Ã£ÂÂ®Ã¥â€°Å Ã©â„¢Â¤Ã£ÂÂ«Ã¥Â¤Â±Ã¦â€¢â€”Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸Ã¯Â¼Å¡' + (result.error || 'Ã¤Â¸ÂÃ¦ËœÅ½Ã£ÂÂªÃ£â€šÂ¨Ã£Æ’Â©Ã£Æ’Â¼'));
            }
        } catch (error) {
            console.error('Ã¥â€°Å Ã©â„¢Â¤Ã£â€šÂ¨Ã£Æ’Â©Ã£Æ’Â¼:', error);
            showSyncIndicator('error', 'Ã¥â€°Å Ã©â„¢Â¤Ã¥Â¤Â±Ã¦â€¢â€”');
            alert('Ã¢Å¡Â Ã¯Â¸Â Ã£â€šÂ¨Ã£Æ’Â©Ã£Æ’Â¼Ã£ÂÅ’Ã§â„¢ÂºÃ§â€Å¸Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸Ã¯Â¼Å¡' + error.message);
        }
    }
    
    // Ã§â€Â»Ã©ÂÂ¢Ã£â€šâ€™Ã¦â€ºÂ´Ã¦â€“Â°
    displayGames();
    displayRankings();
    updateCharts();
    if (typeof displayTeamGamesHistory === 'function') {
        displayTeamGamesHistory();
    }
    
    closeModal('editGameModal');
    currentEditingGameIndex = null;
}

        
        function showJoinTeamModal() {
            document.getElementById('joinTeamModal').classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function openGlossary() {
            document.getElementById('glossaryModal').classList.add('active');
        }
        
        function generateTeamCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let code = '';
            for (let i = 0; i < 6; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return code;
        }

        async function createTeam() {
            const teamName = document.getElementById('newTeamName').value.trim();
            if (!teamName) {
                alert('Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¥ÂÂÃ£â€šâ€™Ã¥â€¦Â¥Ã¥Å â€ºÃ£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€');
                return;
            }

            showSyncIndicator('syncing', 'Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£â€šâ€™Ã¤Â½Å“Ã¦Ë†ÂÃ¤Â¸Â­...');
            
            const teamCode = generateTeamCode();
            
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'text/plain',
                    },
                    body: JSON.stringify({
                        action: 'createTeam',
                        teamName: teamName,
                        teamCode: teamCode
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    teamData = {
                        name: teamName,
                        code: teamCode,
                        spreadsheetId: result.spreadsheetId,
                        createdAt: new Date().toISOString()
                    };
                    saveData();
                    closeModal('createTeamModal');
                    displayTeamStatus();
                    showSyncIndicator('success', 'Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¤Â½Å“Ã¦Ë†ÂÃ¥Â®Å’Ã¤Âºâ€ !');
                    
                    alert('Ã¢Å“â€¦ Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£â‚¬Å’' + teamName + 'Ã£â‚¬ÂÃ£â€šâ€™Ã¤Â½Å“Ã¦Ë†ÂÃ£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸Ã¯Â¼Â\n\nÃ£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£â€šÂ³Ã£Æ’Â¼Ã£Æ’â€°: ' + teamCode + '\n\nÃ£Ââ€œÃ£ÂÂ®Ã£â€šÂ³Ã£Æ’Â¼Ã£Æ’â€°Ã£â€šâ€™Ã¥Ââ€¹Ã©Ââ€Ã£ÂÂ«Ã¥â€¦Â±Ã¦Å“â€°Ã£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€Ã£â‚¬â€š\n\nÃ£â€šÂ¹Ã£Æ’â€”Ã£Æ’Â¬Ã£Æ’Æ’Ã£Æ’â€°Ã£â€šÂ·Ã£Æ’Â¼Ã£Æ’Ë†: ' + result.spreadsheetUrl);
                } else {
                    throw new Error(result.error || 'Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¤Â½Å“Ã¦Ë†ÂÃ£ÂÂ«Ã¥Â¤Â±Ã¦â€¢â€”Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸');
                }
            } catch (error) {
                console.error('Ã£â€šÂ¨Ã£Æ’Â©Ã£Æ’Â¼:', error);
                showSyncIndicator('error', 'Ã£â€šÂ¨Ã£Æ’Â©Ã£Æ’Â¼Ã£ÂÅ’Ã§â„¢ÂºÃ§â€Å¸Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸');
                alert('Ã¢ÂÅ’ Ã£â€šÂ¨Ã£Æ’Â©Ã£Æ’Â¼: ' + error.message + '\n\nÃ£â€šâ€šÃ£Ââ€ Ã¤Â¸â‚¬Ã¥ÂºÂ¦Ã£ÂÅ Ã¨Â©Â¦Ã£Ââ€”Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€Ã£â‚¬â€š');
            }
        }

        async function joinTeam() {
            const teamCode = document.getElementById('joinTeamCode').value.trim().toUpperCase();
            if (!teamCode || teamCode.length !== 6) {
                alert('Ã¦Â­Â£Ã£Ââ€”Ã£Ââ€6Ã¦Â¡ÂÃ£ÂÂ®Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£â€šÂ³Ã£Æ’Â¼Ã£Æ’â€°Ã£â€šâ€™Ã¥â€¦Â¥Ã¥Å â€ºÃ£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€');
                return;
            }

            showSyncIndicator('syncing', 'Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£ÂÂ«Ã¥Ââ€šÃ¥Å Â Ã¤Â¸Â­...');
            
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'text/plain',
                    },
                    body: JSON.stringify({
                        action: 'joinTeam',
                        teamCode: teamCode
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    teamData = {
                        name: result.teamData ? result.teamData.name : 'Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â ',
                        code: teamCode,
                        spreadsheetId: result.spreadsheetId,
                        joinedAt: new Date().toISOString()
                    };
                    
                    saveData();
                    closeModal('joinTeamModal');
                    
                    // Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã¥Ââ€“Ã¥Â¾â€”
                    await loadTeamData();
                    
                    // Ã¨Â¡Â¨Ã§Â¤ÂºÃ£â€šâ€™Ã¦â€ºÂ´Ã¦â€“Â°
                    displayTeamStatus();
                    displayPlayers();
                    updateMyPlayerSelect();
                    
                    showSyncIndicator('success', 'Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¥Ââ€šÃ¥Å Â Ã¥Â®Å’Ã¤Âºâ€ !');
                    alert('Ã¢Å“â€¦ Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£ÂÂ«Ã¥Ââ€šÃ¥Å Â Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸Ã¯Â¼Â\n\nÃ£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¥ÂÂ: ' + teamData.name + '\nÃ£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£â€šÂ³Ã£Æ’Â¼Ã£Æ’â€°: ' + teamCode + '\n\nÃ©ÂÂ¸Ã¦â€°â€¹Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã¥Ââ€“Ã¥Â¾â€”Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸Ã£â‚¬â€š\nÃ¨Â¨Â­Ã¥Â®Å¡Ã£â€šÂ¿Ã£Æ’â€“Ã£ÂÂ®Ã£â‚¬Å’Ã¥â‚¬â€¹Ã¤ÂºÂºÃ£Æ’Â¢Ã£Æ’Â¼Ã£Æ’â€°Ã¨Â¡Â¨Ã§Â¤ÂºÃ¨Â¨Â­Ã¥Â®Å¡Ã£â‚¬ÂÃ£ÂÂ§Ã©ÂÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã©ÂÂ¸Ã¦Å Å¾Ã£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€Ã£â‚¬â€š');
                } else {
                    throw new Error(result.error || 'Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¥Ââ€šÃ¥Å Â Ã£ÂÂ«Ã¥Â¤Â±Ã¦â€¢â€”Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸');
                }
            } catch (error) {
                console.error('Ã£â€šÂ¨Ã£Æ’Â©Ã£Æ’Â¼:', error);
                showSyncIndicator('error', 'Ã£â€šÂ¨Ã£Æ’Â©Ã£Æ’Â¼Ã£ÂÅ’Ã§â„¢ÂºÃ§â€Å¸Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸');
                alert('Ã¢ÂÅ’ Ã£â€šÂ¨Ã£Æ’Â©Ã£Æ’Â¼: ' + error.message);
            }
        }

        async function syncWithServer(options = { pushPlayers: false, pushGames: true }) {
    if (!teamData) return;

    showSyncIndicator('syncing', 'Ã¥ÂÅ’Ã¦Å“Å¸Ã¤Â¸Â­...');

    try {
        const payload = {
            action: 'syncData',
            teamCode: teamData.code
        };

        // Ã¦â€“Â°Ã¨Â¦ÂÃ¨Â¿Â½Ã¥Å Â Ã£Ââ€”Ã£ÂÅ¸Ã©ÂÂ¸Ã¦â€°â€¹Ã£ÂÂ Ã£Ââ€˜Ã©â‚¬ÂÃ£â€šâ€¹Ã¯Â¼Ë†Ã¥Â¾Å’Ã¨Â¿Â°Ã£ÂÂ® addPlayer Ã£ÂÂ§ _localNew Ã£â€šâ€™Ã¤Â»ËœÃ£Ââ€˜Ã£â€šâ€¹Ã¯Â¼â€°
        if (options.pushPlayers) {
            const newPlayers = players.filter(p => p && p._localNew === true);
            if (newPlayers.length > 0) payload.players = newPlayers;
        }

        if (options.pushGames) {
            payload.games = teamGames;
        }

        const response = await fetch(API_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'text/plain' },
            body: JSON.stringify(payload)
        });

        const result = await response.json();
        if (!result.success) throw new Error(result.error || 'syncData failed');

        // Ã©â‚¬ÂÃ¤Â¿Â¡Ã£ÂÂ«Ã¦Ë†ÂÃ¥Å Å¸Ã£Ââ€”Ã£ÂÅ¸Ã¢â‚¬Å“Ã¦â€“Â°Ã¨Â¦ÂÃ©ÂÂ¸Ã¦â€°â€¹Ã¢â‚¬ÂÃ£ÂÂ¯Ã£Æ’â€¢Ã£Æ’Â©Ã£â€šÂ°Ã£â€šâ€™Ã¥Â¤â€“Ã£Ââ€”Ã£ÂÂ¦Ã£ÂÅ Ã£ÂÂ
        if (options.pushPlayers) {
            players.forEach(p => { if (p._localNew) p._localNew = false; });
        }

        showSyncIndicator('success', 'Ã©â‚¬ÂÃ¤Â¿Â¡Ã¥Â®Å’Ã¤Âºâ€ ');
    } catch (e) {
        console.error(e);
        showSyncIndicator('error', 'Ã¥ÂÅ’Ã¦Å“Å¸Ã¥Â¤Â±Ã¦â€¢â€”Ã¯Â¼Å¡' + e.message);
    }
}

// Ã¢â€“Â¼Ã¢â€“Â¼Ã¢â€“Â¼ Ã¨Â¿Â½Ã¥Å Â Ã¯Â¼Å¡Ã¨Â©Â¦Ã¥ÂË†Ã£ÂÂ Ã£Ââ€˜Ã£â€šâ€™Ã©â‚¬ÂÃ£â€šâ€¹Ã¥ÂÅ’Ã¦Å“Å¸Ã¯Â¼Ë†Ã©ÂÂ¸Ã¦â€°â€¹Ã£ÂÂ¯Ã©â‚¬ÂÃ£â€šâ€°Ã£ÂÂªÃ£Ââ€Ã¯Â¼â€° Ã¢â€“Â¼Ã¢â€“Â¼Ã¢â€“Â¼
async function syncGamesOnly() {
  if (!teamData) return;

  showSyncIndicator('syncing', 'Ã¥ÂÅ’Ã¦Å“Å¸Ã¤Â¸Â­...');

  try {
    const payload = {
      action: 'syncData',
      teamCode: teamData.code,
      // Ã¢â€ Â Ã©ÂÂ¸Ã¦â€°â€¹Ã£ÂÂ¯Ã©â‚¬ÂÃ£â€šâ€°Ã£ÂÂªÃ£Ââ€
      games: teamGames       // Ã¢â€ Â Ã¨Â©Â¦Ã¥ÂË†Ã£ÂÂ Ã£Ââ€˜Ã©â‚¬ÂÃ£â€šâ€¹
    };

    const response = await fetch(API_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'text/plain' },
      body: JSON.stringify(payload)
    });

    const result = await response.json();
    if (!result.success) throw new Error(result.error || 'syncData failed');

    showSyncIndicator('success', 'Ã©â‚¬ÂÃ¤Â¿Â¡Ã¥Â®Å’Ã¤Âºâ€ ');
  } catch (e) {
    console.error(e);
    showSyncIndicator('error', 'Ã¥ÂÅ’Ã¦Å“Å¸Ã¥Â¤Â±Ã¦â€¢â€”Ã¯Â¼Å¡' + e.message);
  }
}
// Ã¢â€“Â²Ã¢â€“Â²Ã¢â€“Â² Ã¨Â¿Â½Ã¥Å Â Ã£Ââ€œÃ£Ââ€œÃ£ÂÂ¾Ã£ÂÂ§ Ã¢â€“Â²Ã¢â€“Â²Ã¢â€“Â²
        
        
        // Ã¢â€“Â¼Ã¢â€“Â¼Ã¢â€“Â¼ Ã£Ââ€œÃ£Ââ€œÃ£Ââ€¹Ã£â€šâ€°Ã¨Â¿Â½Ã¥Å Â Ã¯Â¼Å¡Ã©â‚¬ÂÃ¥Ââ€”Ã¤Â¿Â¡Ã£ÂÂ¾Ã£ÂÂ¨Ã£â€šÂÃ£ÂÂ¦Ã¨Â¡Å’Ã£Ââ€  Ã¢â€“Â¼Ã¢â€“Â¼Ã¢â€“Â¼
async function syncAll() {
  if (!teamData) { alert('Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£ÂÂ«Ã¥Ââ€šÃ¥Å Â Ã£Ââ€”Ã£ÂÂ¦Ã£Ââ€Ã£ÂÂ¾Ã£Ââ€ºÃ£â€šâ€œ'); return; }
  showSyncIndicator('syncing', 'Ã¥ÂÅ’Ã¦Å“Å¸Ã¤Â¸Â­Ã¢â‚¬Â¦');

  try {
    // 1) Ã£ÂÂ¾Ã£ÂÅ¡Ã£â€šÂµÃ£Æ’Â¼Ã£Æ’ÂÃ£Æ’Â¼Ã£Ââ€¹Ã£â€šâ€°Ã¦Å“â‚¬Ã¦â€“Â°Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã¥Ââ€“Ã¥Â¾â€”Ã¯Â¼Ë†Ã¥Ââ€”Ã¤Â¿Â¡Ã¥â€ÂªÃ¥â€¦Ë†Ã¯Â¼â€°
    await loadTeamData();

    // 2) Ã§â€Â»Ã©ÂÂ¢Ã£â€šâ€™Ã¦Å“â‚¬Ã¦â€“Â°Ã¥Å’â€“
    displayPlayers();
    updateMyPlayerSelect();
    displayGames();
    displayRankings();
    updateCharts();

    showSyncIndicator('success', 'Ã¥ÂÅ’Ã¦Å“Å¸Ã¥Â®Å’Ã¤Âºâ€ Ã¯Â¼Â');
  } catch (e) {
    console.error(e);
    showSyncIndicator('error', 'Ã¥ÂÅ’Ã¦Å“Å¸Ã¥Â¤Â±Ã¦â€¢â€”Ã¯Â¼Å¡' + e.message);
  }
}
// Ã¢â€“Â²Ã¢â€“Â²Ã¢â€“Â² Ã¨Â¿Â½Ã¥Å Â Ã£Ââ€œÃ£Ââ€œÃ£ÂÂ¾Ã£ÂÂ§ Ã¢â€“Â²Ã¢â€“Â²Ã¢â€“Â²


        async function loadTeamData() {
    if (!teamData) return;
    
    showSyncIndicator('syncing', 'Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã¥Ââ€“Ã¥Â¾â€”Ã¤Â¸Â­...');
    
    try {
        const response = await fetch(API_URL, {
            method: 'POST',
            headers: {
                'Content-Type': 'text/plain',
            },
            body: JSON.stringify({
                action: 'getData',
                teamCode: teamData.code
            })
        });
        
        const result = await response.json();
        
        if (result.success) {
            let addedCount = 0;
            
            // Ã§Â®Â¡Ã§Ââ€ Ã¨â‚¬â€¦Ã£Æ’â€˜Ã£â€šÂ¹Ã£Æ’Â¯Ã£Æ’Â¼Ã£Æ’â€°Ã£â€šâ€™teamDataÃ£ÂÂ«Ã¤Â¿ÂÃ¥Â­Ëœ
if (result.teamData && result.teamData.adminPassword) {
    teamData.adminPassword = result.teamData.adminPassword;
    saveData();  // Ã£Ââ„¢Ã£ÂÂÃ£ÂÂ«Ã¤Â¿ÂÃ¥Â­Ëœ
}
            
            // Ã©ÂÂ¸Ã¦â€°â€¹Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã¥Ââ€“Ã¥Â¾â€”Ã¯Â¼Ë†Ã£â€šÂµÃ£Æ’Â¼Ã£Æ’ÂÃ£Æ’Â¼Ã£ÂÂ®Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£ÂÂ§Ã¥Â®Å’Ã¥â€¦Â¨Ã£ÂÂ«Ã¤Â¸Å Ã¦â€ºÂ¸Ã£ÂÂÃ¯Â¼â€°
if (result.players) {
    // Ã£â€šÂµÃ£Æ’Â¼Ã£Æ’ÂÃ£Æ’Â¼Ã£ÂÂ®Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã¤Â¿Â¡Ã©Â Â¼Ã£Ââ€”Ã£ÂÂ¦Ã¥Â®Å’Ã¥â€¦Â¨Ã£ÂÂ«Ã§Â½Â®Ã£ÂÂÃ¦Ââ€ºÃ£ÂË†Ã£â€šâ€¹
    players = result.players.map(function(serverPlayer) {
        serverPlayer._localNew = false;
        return serverPlayer;
    });
    addedCount = players.length;
}
            
            // Ã¨Â©Â¦Ã¥ÂË†Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã¥Ââ€“Ã¥Â¾â€”Ã£Ââ€”Ã£ÂÂ¦personalGamesÃ£ÂÂ«Ã¥Â¤â€°Ã¦Ââ€º
            if (result.games) {
                // Ã£â€šÂµÃ£Æ’Â¼Ã£Æ’ÂÃ£Æ’Â¼Ã£ÂÂ®Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£ÂÂ§Ã¥Â®Å’Ã¥â€¦Â¨Ã£ÂÂ«Ã¤Â¸Å Ã¦â€ºÂ¸Ã£ÂÂÃ£Ââ„¢Ã£â€šâ€¹
                teamGames = [];
                personalGames = personalGames.filter(function(g) {
                    return g.source !== 'team';
                });
                
                result.games.forEach(function(game) {
                    teamGames.push(game);
                    
                    // Ã¥Ââ€Ã©ÂÂ¸Ã¦â€°â€¹Ã£ÂÂ®Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™personalGamesÃ£ÂÂ«Ã¨Â¿Â½Ã¥Å Â 
                    Object.keys(game.playerStats).forEach(function(playerId) {
                        const stats = game.playerStats[playerId];
                        const totalReb = stats.offensiveRebounds + stats.defensiveRebounds;
                        const totalPts = (stats.twoPointsMade * 2) + (stats.threePointsMade * 3) + stats.freeThrowsMade;
                        
                        const personalGame = {
                            id: Date.now() + Math.random(),
                            date: game.date,
                            opponent: game.opponent,
                            playTime: 0,
                            playerId: playerId,
                            twoPointsMade: stats.twoPointsMade,
                            twoPointsAttempted: stats.twoPointsAttempted,
                            threePointsMade: stats.threePointsMade,
                            threePointsAttempted: stats.threePointsAttempted,
                            freeThrowsMade: stats.freeThrowsMade,
                            freeThrowsAttempted: stats.freeThrowsAttempted,
                            offensiveRebounds: stats.offensiveRebounds,
                            defensiveRebounds: stats.defensiveRebounds,
                            assists: stats.assists,
                            steals: stats.steals,
                            blocks: stats.blocks,
                            turnovers: stats.turnovers,
                            fouls: stats.fouls,
                            totalRebounds: totalReb,
                            twoPointPercentage: stats.twoPointsAttempted > 0 ? ((stats.twoPointsMade / stats.twoPointsAttempted) * 100).toFixed(1) : '0',
                            threePointPercentage: stats.threePointsAttempted > 0 ? ((stats.threePointsMade / stats.threePointsAttempted) * 100).toFixed(1) : '0',
                            freeThrowPercentage: stats.freeThrowsAttempted > 0 ? ((stats.freeThrowsMade / stats.freeThrowsAttempted) * 100).toFixed(1) : '0',
                            totalPoints: totalPts,
                            source: 'team',
                            teamGameId: game.id  // Ã¢â€ Â Ã£Ââ€œÃ£ÂÂ®Ã¨Â¡Å’Ã£â€šâ€™Ã¨Â¿Â½Ã¥Å Â 
                        };
                        
                        personalGames.unshift(personalGame);
                    });
                });
            }
            
            saveData();
            
            const gameCount = result.games ? result.games.length : 0;
            showSyncIndicator('success', addedCount + 'Ã¤ÂºÂºÃ£ÂÂ®Ã©ÂÂ¸Ã¦â€°â€¹Ã£â‚¬Â' + gameCount + 'Ã¨Â©Â¦Ã¥ÂË†Ã£ÂÂ®Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã¥Ââ€“Ã¥Â¾â€”');
            
            return addedCount;
        } else {
            showSyncIndicator('error', 'Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã¥Ââ€“Ã¥Â¾â€”Ã¥Â¤Â±Ã¦â€¢â€”');
        }
    } catch (error) {
        console.error('Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã¥Ââ€“Ã¥Â¾â€”Ã£â€šÂ¨Ã£Æ’Â©Ã£Æ’Â¼:', error);
        showSyncIndicator('error', 'Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã¥Ââ€“Ã¥Â¾â€”Ã¥Â¤Â±Ã¦â€¢â€”');
    }
}
        function displayTeamStatus() {
            const statusEl = document.getElementById('teamStatus');
            
            if (!teamData) {
                statusEl.innerHTML = '<p style="color: #999; text-align: center;">Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£ÂÂ«Ã¥Ââ€šÃ¥Å Â Ã£Ââ€”Ã£ÂÂ¦Ã£Ââ€Ã£ÂÂ¾Ã£Ââ€ºÃ£â€šâ€œ</p>';
                return;
            }
            
            statusEl.innerHTML = 
                '<div class="team-code-display">' +
                '<div style="font-size: 0.9em; color: #666;">Ã§ÂÂ¾Ã¥Å“Â¨Ã£ÂÂ®Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â </div>' +
                '<div style="font-size: 1.3em; font-weight: bold; color: #667eea; margin: 10px 0;">' + teamData.name + '</div>' +
                '<div style="font-size: 0.9em; color: #666;">Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£â€šÂ³Ã£Æ’Â¼Ã£Æ’â€°</div>' +
                '<div class="code">' + teamData.code + '</div>' +
                '<button class="primary-btn" style="background: #2ecc71; margin-top: 15px;" onclick="syncAll()">Ã¤Â»Å Ã£Ââ„¢Ã£ÂÂÃ¥ÂÅ’Ã¦Å“Å¸Ã¯Â¼Ë†Ã©â‚¬ÂÃ¥Ââ€”Ã¤Â¿Â¡Ã¯Â¼â€°</button>' +
                '<button class="primary-btn" style="background: #e74c3c; margin-top: 10px;" onclick="leaveTeam()">Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£Ââ€¹Ã£â€šâ€°Ã©â‚¬â‚¬Ã¥â€¡Âº</button>' +
                '</div>';
        }

        function leaveTeam() {
            if (confirm('Ã¦Å“Â¬Ã¥Â½â€œÃ£ÂÂ«Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£Ââ€¹Ã£â€šâ€°Ã©â‚¬â‚¬Ã¥â€¡ÂºÃ£Ââ€”Ã£ÂÂ¾Ã£Ââ„¢Ã£Ââ€¹Ã¯Â¼Å¸')) {
                teamData = null;
                saveData();
                displayTeamStatus();
                alert('Ã¢Å“â€¦ Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£Ââ€¹Ã£â€šâ€°Ã©â‚¬â‚¬Ã¥â€¡ÂºÃ£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸');
            }
        }

        document.getElementById('gameDate').valueAsDate = new Date();
        document.getElementById('teamGameDate').valueAsDate = new Date();

        function switchMode(mode) {
           currentMode = mode;
            
            // Ã£Ââ„¢Ã£ÂÂ¹Ã£ÂÂ¦Ã£ÂÂ®Ã£Æ’Å“Ã£â€šÂ¿Ã£Æ’Â³Ã£ÂÂ®Ã£â€šÂ¢Ã£â€šÂ¯Ã£Æ’â€ Ã£â€šÂ£Ã£Æ’â€“Ã§Å Â¶Ã¦â€¦â€¹Ã£â€šâ€™Ã£Æ’ÂªÃ£â€šÂ»Ã£Æ’Æ’Ã£Æ’Ë†
            document.querySelectorAll('.mode-btn').forEach(function(btn) {
               btn.classList.remove('active');
               btn.classList.remove('team-mode');
           });
            
            // Ã¨Æ’Å’Ã¦â„¢Â¯Ã¨â€°Â²Ã£â€šâ€™Ã£Æ’ÂªÃ£â€šÂ»Ã£Æ’Æ’Ã£Æ’Ë†
           document.body.classList.remove('personal-mode', 'team-mode');
           
            // Ã£Ââ„¢Ã£ÂÂ¹Ã£ÂÂ¦Ã£ÂÂ®Ã£Æ’Â¢Ã£Æ’Â¼Ã£Æ’â€°Ã£â€šâ€™Ã©ÂÅ¾Ã¨Â¡Â¨Ã§Â¤Âº
            document.getElementById('personalMode').style.display = 'none';
            document.getElementById('teamMode').style.display = 'none';
            document.getElementById('settingsMode').style.display = 'none';
            
            // Ã©ÂÂ¸Ã¦Å Å¾Ã£Ââ€¢Ã£â€šÅ’Ã£ÂÅ¸Ã£Æ’Â¢Ã£Æ’Â¼Ã£Æ’â€°Ã£â€šâ€™Ã¨Â¡Â¨Ã§Â¤Âº
           if (mode === 'personal') {
                document.querySelector('.mode-btn:nth-child(1)').classList.add('active');
                document.getElementById('personalMode').style.display = 'block';
                document.body.classList.add('personal-mode');
                displayGames();
            } else if (mode === 'team') {
                const teamBtn = document.querySelector('.mode-btn:nth-child(2)');
                teamBtn.classList.add('active');
                teamBtn.classList.add('team-mode');
                document.getElementById('teamMode').style.display = 'block';
                document.body.classList.add('team-mode');
            } else if (mode === 'settings') {
                document.querySelector('.mode-btn:nth-child(3)').classList.add('active');
                document.getElementById('settingsMode').style.display = 'block';
           }
        }
        
        function switchTab(tab) {
            document.querySelectorAll('#personalMode .tab').forEach(function(t) {
                t.classList.remove('active');
            });
            document.querySelectorAll('#personalMode .tab-content').forEach(function(c) {
                c.classList.remove('active');
            });
            
            const tabs = ['input', 'list', 'ranking', 'graph', 'settings'];
            const index = tabs.indexOf(tab);
            document.querySelector('#personalMode .tab:nth-child(' + (index + 1) + ')').classList.add('active');
            document.getElementById(tab + 'Tab').classList.add('active');
            
            if (tab === 'graph') updateCharts();
            if (tab === 'settings') { 
                displayPlayers(); 
                updateMyPlayerSelect();
                displayTeamStatus();
            }
            if (tab === 'ranking') displayRankings();
            if (tab === 'list') displayGames();
        }

        function changeValue(key, delta) {
            stats[key] = Math.max(0, stats[key] + delta);
            
            if (key === 'twoPointsMade' && stats.twoPointsMade > stats.twoPointsAttempted) {
                stats.twoPointsAttempted = stats.twoPointsMade;
            }
            if (key === 'twoPointsAttempted' && stats.twoPointsMade > stats.twoPointsAttempted) {
                stats.twoPointsMade = stats.twoPointsAttempted;
            }
            if (key === 'threePointsMade' && stats.threePointsMade > stats.threePointsAttempted) {
                stats.threePointsAttempted = stats.threePointsMade;
            }
            if (key === 'threePointsAttempted' && stats.threePointsMade > stats.threePointsAttempted) {
                stats.threePointsMade = stats.threePointsAttempted;
            }
            if (key === 'freeThrowsMade' && stats.freeThrowsMade > stats.freeThrowsAttempted) {
                stats.freeThrowsAttempted = stats.freeThrowsMade;
            }
            if (key === 'freeThrowsAttempted' && stats.freeThrowsMade > stats.freeThrowsAttempted) {
                stats.freeThrowsMade = stats.freeThrowsAttempted;
            }
            
            updateDisplay();
        }

        function updateDisplay() {
            Object.keys(stats).forEach(function(key) {
                const el = document.getElementById(key);
                if (el) el.textContent = stats[key];
            });
            
            const twoP = stats.twoPointsAttempted > 0 ? ((stats.twoPointsMade / stats.twoPointsAttempted) * 100).toFixed(1) : '0';
            const threeP = stats.threePointsAttempted > 0 ? ((stats.threePointsMade / stats.threePointsAttempted) * 100).toFixed(1) : '0';
            const ft = stats.freeThrowsAttempted > 0 ? ((stats.freeThrowsMade / stats.freeThrowsAttempted) * 100).toFixed(1) : '0';
            const totalPoints = (stats.twoPointsMade * 2) + (stats.threePointsMade * 3) + stats.freeThrowsMade;
            
            document.getElementById('twoPointPercentage').textContent = twoP + '%';
            document.getElementById('threePointPercentage').textContent = threeP + '%';
            document.getElementById('freeThrowPercentage').textContent = ft + '%';
            document.getElementById('totalPoints').textContent = totalPoints;
            
            // Ã¥Ë†â€ Ã¦â€¢Â°Ã£â€šâ€™Ã¨Â¡Â¨Ã§Â¤Âº
            document.getElementById('twoPointFraction').textContent = '(' + stats.twoPointsMade + '/' + stats.twoPointsAttempted + ')';
            document.getElementById('threePointFraction').textContent = '(' + stats.threePointsMade + '/' + stats.threePointsAttempted + ')';
            document.getElementById('freeThrowFraction').textContent = '(' + stats.freeThrowsMade + '/' + stats.freeThrowsAttempted + ')';
        }
        function savePersonalGame() {
            const date = document.getElementById('gameDate').value;
            if (!date) {
                alert('Ã¨Â©Â¦Ã¥ÂË†Ã¦â€”Â¥Ã£â€šâ€™Ã©ÂÂ¸Ã¦Å Å¾Ã£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€');
                return;
            }

            const saveBtn = document.getElementById('saveGameBtn');
            saveBtn.disabled = true;
            saveBtn.textContent = 'Ã¤Â¿ÂÃ¥Â­ËœÃ¤Â¸Â­...';

            const game = {
                id: Date.now(),
                date: date,
                opponent: document.getElementById('opponent').value.trim(),
                playTime: parseInt(document.getElementById('playTime').value) || 0,
                playerId: myPlayerId,
                twoPointsMade: stats.twoPointsMade,
                twoPointsAttempted: stats.twoPointsAttempted,
                threePointsMade: stats.threePointsMade,
                threePointsAttempted: stats.threePointsAttempted,
                freeThrowsMade: stats.freeThrowsMade,
                freeThrowsAttempted: stats.freeThrowsAttempted,
                offensiveRebounds: stats.offensiveRebounds,
                defensiveRebounds: stats.defensiveRebounds,
                assists: stats.assists,
                steals: stats.steals,
                blocks: stats.blocks,
                turnovers: stats.turnovers,
                fouls: stats.fouls,
                totalRebounds: stats.offensiveRebounds + stats.defensiveRebounds,
                twoPointPercentage: stats.twoPointsAttempted > 0 ? ((stats.twoPointsMade / stats.twoPointsAttempted) * 100).toFixed(1) : '0',
                threePointPercentage: stats.threePointsAttempted > 0 ? ((stats.threePointsMade / stats.threePointsAttempted) * 100).toFixed(1) : '0',
                freeThrowPercentage: stats.freeThrowsAttempted > 0 ? ((stats.freeThrowsMade / stats.freeThrowsAttempted) * 100).toFixed(1) : '0',
                totalPoints: (stats.twoPointsMade * 2) + (stats.threePointsMade * 3) + stats.freeThrowsMade,
                source: 'personal'
            };

            personalGames.unshift(game);
            saveData();
            
            if (teamData) {
                syncGamesOnly();
            }
            
            displayGames();
            resetForm();
            
            saveBtn.disabled = false;
            saveBtn.textContent = 'Ã¨Â¨ËœÃ©Å’Â²Ã£â€šâ€™Ã¤Â¿ÂÃ¥Â­Ëœ';
            
            alert('Ã¢Å“â€¦ Ã¨Â©Â¦Ã¥ÂË†Ã¨Â¨ËœÃ©Å’Â²Ã£â€šâ€™Ã¤Â¿ÂÃ¥Â­ËœÃ£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸Ã¯Â¼Â');
        }

        function resetForm() {
            Object.keys(stats).forEach(function(key) {
                stats[key] = 0;
            });
            document.getElementById('gameDate').valueAsDate = new Date();
            document.getElementById('opponent').value = '';
            document.getElementById('playTime').value = 0;
            updateDisplay();
        }

        function displayGames() {
    const gameList = document.getElementById('gameList');
    
    // myPlayerIdÃ£ÂÅ’Ã¨Â¨Â­Ã¥Â®Å¡Ã£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¦Ã£Ââ€Ã£ÂÂªÃ£Ââ€Ã¥Â Â´Ã¥ÂË†Ã£ÂÂ¯Ã¥â€¦Â¨Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã¨Â¡Â¨Ã§Â¤Âº
    const myGames = myPlayerId 
        ? personalGames.filter(function(g) {
            return !g.playerId || g.playerId === myPlayerId;
          })
        : personalGames;
    
    if (myGames.length === 0) {
        gameList.innerHTML = '<div class="empty-state"><div class="icon">Ã°Å¸Ââ‚¬</div><h3>Ã£ÂÂ¾Ã£ÂÂ Ã¨Â¨ËœÃ©Å’Â²Ã£ÂÅ’Ã£Ââ€šÃ£â€šÅ Ã£ÂÂ¾Ã£Ââ€ºÃ£â€šâ€œ</h3><p>Ã¦Å“â‚¬Ã¥Ë†ÂÃ£ÂÂ®Ã¨Â©Â¦Ã¥ÂË†Ã£â€šâ€™Ã¨Â¨ËœÃ©Å’Â²Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£â€šâ€¡Ã£Ââ€ Ã¯Â¼Â</p></div>';
        return;
    }

            gameList.innerHTML = myGames.map(function(g) {
                const dateObj = new Date(g.date);
                const dateStr = dateObj.toLocaleDateString('ja-JP', {year: 'numeric', month: 'long', day: 'numeric'});
                const sourceLabel = g.source === 'team' ? ' <span style="background: #2ecc71; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8em;">Ã¨Â©Â¦Ã¥ÂË†Ã¨Â¨ËœÃ©Å’Â²</span>' : '';
                
                return '<div class="game-item">' +
                    '<div class="game-date">' + dateStr + 
                    (g.opponent ? ' vs ' + g.opponent : '') + 
                    (g.playTime ? ' (' + g.playTime + 'Ã¥Ë†â€ )' : '') + 
                    sourceLabel +
                    '</div>' +
                    '<div class="game-stats">' +
                    '<div class="stat-box"><div class="label">Ã§Â·ÂÃ¥Â¾â€”Ã§â€šÂ¹</div><div class="value">' + g.totalPoints + 'Ã§â€šÂ¹</div></div>' +
                    '<div class="stat-box"><div class="label">2PÃ§Å½â€¡</div><div class="value">' + g.twoPointPercentage + '%</div><div class="fraction">(' + g.twoPointsMade + '/' + g.twoPointsAttempted + ')</div></div>' +
                    '<div class="stat-box"><div class="label">3PÃ§Å½â€¡</div><div class="value">' + g.threePointPercentage + '%</div><div class="fraction">(' + g.threePointsMade + '/' + g.threePointsAttempted + ')</div></div>' +
                    '<div class="stat-box"><div class="label">FTÃ§Å½â€¡</div><div class="value">' + g.freeThrowPercentage + '%</div><div class="fraction">(' + g.freeThrowsMade + '/' + g.freeThrowsAttempted + ')</div></div>' +
                    '<div class="stat-box"><div class="label">Ã£Æ’ÂªÃ£Æ’ÂÃ£â€šÂ¦Ã£Æ’Â³Ã£Æ’â€°</div><div class="value">' + g.totalRebounds + '</div></div>' +
                    '<div class="stat-box"><div class="label">Ã£â€šÂ¢Ã£â€šÂ·Ã£â€šÂ¹Ã£Æ’Ë†</div><div class="value">' + g.assists + '</div></div>' +
                    '</div>' +
                    '</div>';
            }).join('');
        }

        function displayRankings() {
            const myGames = myPlayerId 
    ? personalGames.filter(function(g) {
        return !g.playerId || g.playerId === myPlayerId;
      })
    : personalGames;
            
            if (myGames.length === 0) {
                document.getElementById('topPoints').innerHTML = '<p style="text-align: center; color: #999;">Ã¨Â¨ËœÃ©Å’Â²Ã£ÂÅ’Ã£Ââ€šÃ£â€šÅ Ã£ÂÂ¾Ã£Ââ€ºÃ£â€šâ€œ</p>';
                return;
            }

            const topPoints = myGames.slice().sort(function(a, b) {
                return b.totalPoints - a.totalPoints;
            }).slice(0, 10);

            if (topPoints.length > 0) {
                const top = topPoints[0];
                const dateObj = new Date(top.date);
                const dateStr = dateObj.toLocaleDateString('ja-JP', {year: 'numeric', month: 'long', day: 'numeric'});
                
                let html = '<div class="top-record">' +
                    '<div class="trophy">Ã°Å¸Ââ€ </div>' +
                    '<div style="font-size: 1.2em; margin-bottom: 10px;">Ã¦Å“â‚¬Ã©Â«ËœÃ¥Â¾â€”Ã§â€šÂ¹</div>' +
                    '<div class="value">' + top.totalPoints + 'Ã§â€šÂ¹</div>' +
                    '<div style="font-size: 1.1em; opacity: 0.95;">' + dateStr;
                
                if (top.opponent) {
                    html += '<br>vs ' + top.opponent;
                }
                
                html += '</div></div>';
                
                document.getElementById('topPoints').innerHTML = html;
            }
        }

        function updateCharts() {
            const myGames = myPlayerId 
    ? personalGames.filter(function(g) {
        return !g.playerId || g.playerId === myPlayerId;
      })
    : personalGames;
            
            if (myGames.length === 0) return;

            const sorted = myGames.slice().reverse();
            const labels = sorted.map(function(g) {
                const d = new Date(g.date).toLocaleDateString('ja-JP', {month: 'short', day: 'numeric'});
                return g.opponent ? d + ' vs ' + g.opponent : d;
            });

            if (charts.shooting) charts.shooting.destroy();
            charts.shooting = new Chart(document.getElementById('shootingChart'), {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '2PÃ¦Ë†ÂÃ¥Å Å¸Ã§Å½â€¡',
                        data: sorted.map(function(g) { return parseFloat(g.twoPointPercentage); }),
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4
                    }, {
                        label: '3PÃ¦Ë†ÂÃ¥Å Å¸Ã§Å½â€¡',
                        data: sorted.map(function(g) { return parseFloat(g.threePointPercentage); }),
                        borderColor: '#f093fb',
                        backgroundColor: 'rgba(240, 147, 251, 0.1)',
                        tension: 0.4
                    }, {
                        label: 'FTÃ¦Ë†ÂÃ¥Å Å¸Ã§Å½â€¡',
                        data: sorted.map(function(g) { return parseFloat(g.freeThrowPercentage); }),
                        borderColor: '#4facfe',
                        backgroundColor: 'rgba(79, 172, 254, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'bottom' } },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: { callback: function(v) { return v + '%'; } }
                        }
                    }
                }
            });
        }

        function addPlayer() {
            const num = document.getElementById('playerNumber').value;
            const name = document.getElementById('playerName').value.trim();

            if (!num || !name) { 
                alert('Ã¨Æ’Å’Ã§â€¢ÂªÃ¥ÂÂ·Ã£ÂÂ¨Ã¥ÂÂÃ¥â€°ÂÃ£â€šâ€™Ã¥â€¦Â¥Ã¥Å â€ºÃ£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€'); 
                return; 
            }
            
            const exists = players.some(function(p) {
                return p.number === num;
            });
            
            if (exists) { 
                alert('Ã£Ââ€œÃ£ÂÂ®Ã¨Æ’Å’Ã§â€¢ÂªÃ¥ÂÂ·Ã£ÂÂ¯Ã¦â€”Â¢Ã£ÂÂ«Ã§â„¢Â»Ã©Å’Â²Ã£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¦Ã£Ââ€Ã£ÂÂ¾Ã£Ââ„¢'); 
                return; 
            }

            const player = { 
                id: Date.now().toString(), 
                number: num, 
                name: name 
            };
            players.push(player);
            
            if (!myPlayerId) myPlayerId = player.id;
            
            saveData();

if (teamData) {
    // Ã¦â€“Â°Ã¨Â¦ÂÃ¨Â¿Â½Ã¥Å Â Ã£Æ’â€¢Ã£Æ’Â©Ã£â€šÂ°Ã£â€šâ€™Ã£ÂÂ¤Ã£Ââ€˜Ã£â€šâ€¹
    // Ã¯Â¼Ë†Ã£Ââ€œÃ£ÂÂ®Ã¨Â¡Å’Ã£ÂÂ¯Ã£â‚¬ÂÃ£Æ’â€”Ã£Æ’Â¬Ã£â€šÂ¤Ã£Æ’Â¤Ã£Æ’Â¼Ã£â€šÂªÃ£Æ’â€“Ã£â€šÂ¸Ã£â€šÂ§Ã£â€šÂ¯Ã£Æ’Ë†Ã§â€Å¸Ã¦Ë†ÂÃ§â€ºÂ´Ã¥Â¾Å’Ã£ÂÂ§Ã£â€šâ€šOKÃ¯Â¼â€°
    player._localNew = true;

    // Ã©ÂÂ¸Ã¦â€°â€¹Ã£ÂÂ Ã£Ââ€˜Ã©â‚¬ÂÃ¤Â¿Â¡Ã¯Â¼Ë†Ã¨Â©Â¦Ã¥ÂË†Ã£ÂÂ¯Ã©â‚¬ÂÃ£â€šâ€°Ã£ÂÂªÃ£Ââ€Ã¯Â¼â€°
    syncWithServer({ pushPlayers: true, pushGames: false });
}
            
            displayPlayers();
            updateMyPlayerSelect();

            document.getElementById('playerNumber').value = '';
            document.getElementById('playerName').value = '';
            
            alert('Ã¢Å“â€¦ ' + name + ' #' + num + ' Ã£â€šâ€™Ã§â„¢Â»Ã©Å’Â²Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸Ã¯Â¼Â');
        }

        function editPlayer(playerId) {
            const player = players.find(function(p) {
                return p.id === playerId;
            });
            
            if (!player) return;
            
            const newNumber = prompt('Ã¦â€“Â°Ã£Ââ€”Ã£Ââ€Ã¨Æ’Å’Ã§â€¢ÂªÃ¥ÂÂ·Ã£â€šâ€™Ã¥â€¦Â¥Ã¥Å â€ºÃ£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€Ã¯Â¼Ë†Ã§ÂÂ¾Ã¥Å“Â¨: #' + player.number + 'Ã¯Â¼â€°', player.number);
            if (newNumber === null) return;
            
            if (!newNumber || newNumber.trim() === '') {
                alert('Ã¨Æ’Å’Ã§â€¢ÂªÃ¥ÂÂ·Ã£â€šâ€™Ã¥â€¦Â¥Ã¥Å â€ºÃ£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€');
                return;
            }
            
            const duplicate = players.some(function(p) {
                return p.id !== playerId && p.number === newNumber.trim();
            });
            
            if (duplicate) {
                alert('Ã£Ââ€œÃ£ÂÂ®Ã¨Æ’Å’Ã§â€¢ÂªÃ¥ÂÂ·Ã£ÂÂ¯Ã¦â€”Â¢Ã£ÂÂ«Ã¤Â»â€“Ã£ÂÂ®Ã©ÂÂ¸Ã¦â€°â€¹Ã£ÂÅ’Ã¤Â½Â¿Ã§â€Â¨Ã£Ââ€”Ã£ÂÂ¦Ã£Ââ€Ã£ÂÂ¾Ã£Ââ„¢');
                return;
            }
            
            const newName = prompt('Ã¦â€“Â°Ã£Ââ€”Ã£Ââ€Ã¥ÂÂÃ¥â€°ÂÃ£â€šâ€™Ã¥â€¦Â¥Ã¥Å â€ºÃ£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€Ã¯Â¼Ë†Ã§ÂÂ¾Ã¥Å“Â¨: ' + player.name + 'Ã¯Â¼â€°', player.name);
            if (newName === null) return;
            
            if (!newName || newName.trim() === '') {
                alert('Ã¥ÂÂÃ¥â€°ÂÃ£â€šâ€™Ã¥â€¦Â¥Ã¥Å â€ºÃ£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€');
                return;
            }
            
            player.number = newNumber.trim();
            player.name = newName.trim();
            
            saveData();

// Ã£â€šÂµÃ£Æ’Â¼Ã£Æ’ÂÃ£ÂÂ¸Ã£ÂÂ¯Ã©â‚¬ÂÃ£â€šâ€°Ã£ÂÂªÃ£Ââ€Ã¯Â¼Ë†Ã§Â·Â¨Ã©â€ºâ€ /Ã¥â€°Å Ã©â„¢Â¤Ã£ÂÂ¯Ã¦â€°â€¹Ã¥â€¹â€¢Ã£ÂÂ§Ã£â€šÂ·Ã£Æ’Â¼Ã£Æ’Ë†Ã£â€šâ€™Ã§â€ºÂ´Ã£Ââ„¢Ã©Ââ€¹Ã§â€Â¨Ã¯Â¼â€°
/* if (teamData) {
    syncWithServer();
} */
            
            displayPlayers();
            updateMyPlayerSelect();
            displayGames();
            displayRankings();
            updateCharts();
            
            alert('Ã¢Å“â€¦ Ã©ÂÂ¸Ã¦â€°â€¹Ã¦Æ’â€¦Ã¥Â Â±Ã£â€šâ€™Ã¦â€ºÂ´Ã¦â€“Â°Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸Ã¯Â¼Â\n\n#' + player.number + ' ' + player.name);
        }

        function deletePlayer(playerId) {
            const player = players.find(function(p) {
                return p.id === playerId;
            });
            
            if (!player) return;
            
            if (!confirm('Ã£â‚¬Å’#' + player.number + ' ' + player.name + 'Ã£â‚¬ÂÃ£â€šâ€™Ã¥â€°Å Ã©â„¢Â¤Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ„¢Ã£Ââ€¹Ã¯Â¼Å¸\n\nÃ¢Å¡Â Ã¯Â¸Â Ã£Ââ€œÃ£ÂÂ®Ã©ÂÂ¸Ã¦â€°â€¹Ã£ÂÂ®Ã¨Â©Â¦Ã¥ÂË†Ã¨Â¨ËœÃ©Å’Â²Ã£â€šâ€šÃ¥â€¦Â¨Ã£ÂÂ¦Ã¥â€°Å Ã©â„¢Â¤Ã£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¾Ã£Ââ„¢Ã£â‚¬â€š')) {
                return;
            }
            
            players = players.filter(function(p) {
                return p.id !== playerId;
            });
            
            personalGames = personalGames.filter(function(g) {
                return g.playerId !== playerId;
            });
            
            teamGames.forEach(function(game) {
                if (game.playerStats && game.playerStats[playerId]) {
                    delete game.playerStats[playerId];
                }
                if (game.plays) {
                    game.plays = game.plays.filter(function(play) {
                        return play.playerId !== playerId;
                    });
                }
            });
            
            if (myPlayerId === playerId) {
                myPlayerId = players.length > 0 ? players[0].id : null;
            }
            
            saveData();
            
            if (teamData) {
                syncWithServer();
            }
            
            displayPlayers();
            updateMyPlayerSelect();
            displayGames();
            displayRankings();
            updateCharts();
            
            alert('Ã¢Å“â€¦ Ã©ÂÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã¥â€°Å Ã©â„¢Â¤Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸');
        }
        
        function changeMyPlayer() {
            myPlayerId = document.getElementById('myPlayerSelect').value || null;
            saveData();
            displayGames();
            displayRankings();
            updateCharts();
            
            updatePlayerBanners();  // Ã¢â€ Â Ã¨Â¿Â½Ã¥Å Â 
            
            if (myPlayerId) {
                const p = players.find(function(pl) {
                    return pl.id === myPlayerId;
                });
                alert('Ã¢Å“â€¦ Ã¥â‚¬â€¹Ã¤ÂºÂºÃ£Æ’Â¢Ã£Æ’Â¼Ã£Æ’â€°Ã¨Â¡Â¨Ã§Â¤ÂºÃ£â€šâ€™Ã£â‚¬Å’' + p.name + ' #' + p.number + 'Ã£â‚¬ÂÃ£ÂÂ«Ã¨Â¨Â­Ã¥Â®Å¡Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸\n\nÃ¥Â±Â¥Ã¦Â­Â´Ã£Æ’Â»Ã£Æ’Â©Ã£Æ’Â³Ã£â€šÂ­Ã£Æ’Â³Ã£â€šÂ°Ã£Æ’Â»Ã£â€šÂ°Ã£Æ’Â©Ã£Æ’â€¢Ã£ÂÅ’Ã¦â€ºÂ´Ã¦â€“Â°Ã£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸Ã¯Â¼Â');
            }
        }

        function updatePlayerBanners() {
            // Ã©ÂÂ¸Ã¦â€°â€¹Ã£ÂÅ’Ã©ÂÂ¸Ã¦Å Å¾Ã£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¦Ã£Ââ€Ã£â€šâ€¹Ã£Ââ€¹Ã£Æ’ÂÃ£â€šÂ§Ã£Æ’Æ’Ã£â€šÂ¯
            if (myPlayerId && players.length > 0) {
                const player = players.find(function(p) { return p.id === myPlayerId; });
                const playerText = player ? player.name + ' #' + player.number : 'Ã©ÂÂ¸Ã¦â€°â€¹Ã£ÂÅ’Ã¨Â¦â€¹Ã£ÂÂ¤Ã£Ââ€¹Ã£â€šÅ Ã£ÂÂ¾Ã£Ââ€ºÃ£â€šâ€œ';

                const banners = [
                    { banner: 'inputPlayerBanner', name: 'inputPlayerName' },
                    { banner: 'listPlayerBanner', name: 'listPlayerName' },
                    { banner: 'rankingPlayerBanner', name: 'rankingPlayerName' },
                    { banner: 'graphPlayerBanner', name: 'graphPlayerName' }
                ];

                banners.forEach(function(b) {
                    const bannerEl = document.getElementById(b.banner);
                    const nameEl = document.getElementById(b.name);
                    
                    if (bannerEl && nameEl) {
                        bannerEl.style.display = 'flex';
                        nameEl.textContent = playerText;
                        
                        // Ã£â€šÂ¯Ã£Æ’ÂªÃ£Æ’Æ’Ã£â€šÂ¯Ã¦Â©Å¸Ã¨Æ’Â½Ã£â€šâ€™Ã¨Â¿Â½Ã¥Å Â 
                        bannerEl.style.cursor = 'pointer';
                        bannerEl.style.transition = 'all 0.3s';
                        bannerEl.onclick = showPlayerSelectDialog;
                        
                        // Ã£Æ’Å¾Ã£â€šÂ¦Ã£â€šÂ¹Ã£â€šâ€™Ã¤Â¹â€”Ã£Ââ€ºÃ£ÂÅ¸Ã£ÂÂ¨Ã£ÂÂÃ£ÂÂ®Ã¥Å Â¹Ã¦Å¾Å“
                        bannerEl.onmouseenter = function() {
                            this.style.transform = 'scale(1.02)';
                            this.style.boxShadow = '0 4px 12px rgba(0,0,0,0.2)';
                        };
                        
                        bannerEl.onmouseleave = function() {
                            this.style.transform = 'scale(1)';
                            this.style.boxShadow = '0 2px 8px rgba(0,0,0,0.1)';
                        };
                    }
                });
            } else {
                // Ã©ÂÂ¸Ã¦â€°â€¹Ã£ÂÅ’Ã©ÂÂ¸Ã¦Å Å¾Ã£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¦Ã£Ââ€Ã£ÂÂªÃ£Ââ€Ã¥Â Â´Ã¥ÂË†Ã£ÂÂ¯Ã©ÂÅ¾Ã¨Â¡Â¨Ã§Â¤Âº
                ['inputPlayerBanner', 'listPlayerBanner', 'rankingPlayerBanner', 'graphPlayerBanner'].forEach(function(id) {
                    const el = document.getElementById(id);
                    if (el) {
                        el.style.display = 'none';
                    }
                });
            }
        }
        
        // Ã©ÂÂ¸Ã¦â€°â€¹Ã©ÂÂ¸Ã¦Å Å¾Ã£Æ’â‚¬Ã£â€šÂ¤Ã£â€šÂ¢Ã£Æ’Â­Ã£â€šÂ°Ã£â€šâ€™Ã¨Â¡Â¨Ã§Â¤ÂºÃ£Ââ„¢Ã£â€šâ€¹Ã©â€“Â¢Ã¦â€¢Â°
        function showPlayerSelectDialog() {
            if (!players || players.length === 0) {
                alert('Ã©ÂÂ¸Ã¦â€°â€¹Ã£ÂÅ’Ã§â„¢Â»Ã©Å’Â²Ã£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¦Ã£Ââ€Ã£ÂÂ¾Ã£Ââ€ºÃ£â€šâ€œÃ£â‚¬â€š\nÃ¥â€¦Ë†Ã£ÂÂ«Ã£â‚¬Å’Ã©ÂÂ¸Ã¦â€°â€¹Ã§Â®Â¡Ã§Ââ€ Ã£â‚¬ÂÃ£ÂÂ§Ã©ÂÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã¨Â¿Â½Ã¥Å Â Ã£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€Ã£â‚¬â€š');
                return;
            }
            
            // Ã£Æ’â€°Ã£Æ’Â­Ã£Æ’Æ’Ã£Æ’â€”Ã£Æ’â‚¬Ã£â€šÂ¦Ã£Æ’Â³Ã£ÂÂ«Ã©ÂÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã¨Â¿Â½Ã¥Å Â 
            const dropdown = document.getElementById('playerSelectDropdown');
            dropdown.innerHTML = '<option value="">Ã©ÂÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã©ÂÂ¸Ã¦Å Å¾...</option>';
            
            players.forEach(function(p) {
                const option = document.createElement('option');
                option.value = p.id;
                option.textContent = p.name + ' #' + p.number;
                
                // Ã§ÂÂ¾Ã¥Å“Â¨Ã©ÂÂ¸Ã¦Å Å¾Ã¤Â¸Â­Ã£ÂÂ®Ã©ÂÂ¸Ã¦â€°â€¹Ã£ÂÂ«Ã£Æ’Å¾Ã£Æ’Â¼Ã£â€šÂ¯Ã£â€šâ€™Ã¤Â»ËœÃ£Ââ€˜Ã£â€šâ€¹
                if (p.id === myPlayerId) {
                    option.textContent = 'Ã¢Ëœâ€¦ ' + option.textContent;
                    option.selected = true;
                }
                
                dropdown.appendChild(option);
            });
            
            // Ã£Æ’Â¢Ã£Æ’Â¼Ã£Æ’â‚¬Ã£Æ’Â«Ã£â€šâ€™Ã¨Â¡Â¨Ã§Â¤Âº
            const modal = document.getElementById('playerSelectModal');
            modal.style.display = 'flex';
        }
        
        // Ã£Æ’â‚¬Ã£â€šÂ¤Ã£â€šÂ¢Ã£Æ’Â­Ã£â€šÂ°Ã£â€šâ€™Ã©â€“â€°Ã£ÂËœÃ£â€šâ€¹Ã©â€“Â¢Ã¦â€¢Â°
        function closePlayerSelectDialog() {
            const modal = document.getElementById('playerSelectModal');
            modal.style.display = 'none';
        }
        
        // Ã©ÂÂ¸Ã¦â€°â€¹Ã©ÂÂ¸Ã¦Å Å¾Ã£â€šâ€™Ã§Â¢ÂºÃ¥Â®Å¡Ã£Ââ„¢Ã£â€šâ€¹Ã©â€“Â¢Ã¦â€¢Â°
        function confirmPlayerSelection() {
            const dropdown = document.getElementById('playerSelectDropdown');
            const selectedPlayerId = dropdown.value;
            
            if (!selectedPlayerId || selectedPlayerId === '') {
                alert('Ã¢ÂÅ’ Ã©ÂÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã©ÂÂ¸Ã¦Å Å¾Ã£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€');
                return;
            }
            
            // Ã©ÂÂ¸Ã¦Å Å¾Ã£Ââ€”Ã£ÂÅ¸Ã©ÂÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã¦Å½Â¢Ã£Ââ„¢
            const selectedPlayer = players.find(function(p) {
                return p.id === selectedPlayerId;
            });
            
            if (!selectedPlayer) {
                alert('Ã¢ÂÅ’ Ã©ÂÂ¸Ã¦â€°â€¹Ã£ÂÅ’Ã¨Â¦â€¹Ã£ÂÂ¤Ã£Ââ€¹Ã£â€šÅ Ã£ÂÂ¾Ã£Ââ€ºÃ£â€šâ€œÃ£ÂÂ§Ã£Ââ€”Ã£ÂÅ¸');
                return;
            }
            
            // Ã©ÂÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã¥Ë†â€¡Ã£â€šÅ Ã¦â€ºÂ¿Ã£ÂË†
            myPlayerId = selectedPlayer.id;
            saveData();
            
            // Ã£Æ’â‚¬Ã£â€šÂ¤Ã£â€šÂ¢Ã£Æ’Â­Ã£â€šÂ°Ã£â€šâ€™Ã©â€“â€°Ã£ÂËœÃ£â€šâ€¹
            closePlayerSelectDialog();
            
            // Ã§â€Â»Ã©ÂÂ¢Ã£â€šâ€™Ã¦â€ºÂ´Ã¦â€“Â°
            updateDisplay();
            updatePlayerBanners();
            displayGames();
            displayRankings();
            updateCharts();
            
            alert('Ã¢Å“â€¦ ' + selectedPlayer.name + ' #' + selectedPlayer.number + ' Ã£â€šâ€™Ã©ÂÂ¸Ã¦Å Å¾Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸Ã¯Â¼Â');
        }
        function updateMyPlayerSelect() {
            const sel = document.getElementById('myPlayerSelect');
            sel.innerHTML = '<option value="">Ã©ÂÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã©ÂÂ¸Ã¦Å Å¾Ã£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€</option>';
            players.forEach(function(p) {
                const opt = document.createElement('option');
                opt.value = p.id;
                opt.textContent = p.name + ' #' + p.number;
                if (p.id === myPlayerId) opt.selected = true;
                sel.appendChild(opt);
            });
        }

        function displayPlayers() {
            const playerList = document.getElementById('playerList');
            
            if (players.length === 0) {
                playerList.innerHTML = '<p style="text-align: center; color: #999;">Ã£ÂÂ¾Ã£ÂÂ Ã©ÂÂ¸Ã¦â€°â€¹Ã£ÂÅ’Ã§â„¢Â»Ã©Å’Â²Ã£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¦Ã£Ââ€Ã£ÂÂ¾Ã£Ââ€ºÃ£â€šâ€œ</p>';
                return;
            }

            playerList.innerHTML = players.map(function(p) {
                const isMyPlayer = p.id === myPlayerId;
                
                return '<div class="player-item">' +
                    '<div class="player-info">' +
                    '<div>' +
                    '<span class="number">#' + p.number + '</span>' +
                    '<span style="font-weight: bold; margin-left: 10px;">' + p.name + '</span>' +
                    '</div>' +
                    '<div>' +
                    (isMyPlayer ? '<span class="my-data-badge">Ã¥â‚¬â€¹Ã¤ÂºÂºÃ£Æ’Â¢Ã£Æ’Â¼Ã£Æ’â€°Ã¨Â¡Â¨Ã§Â¤ÂºÃ¤Â¸Â­</span>' : '') +
                    '</div>' +
                    '</div>' +
                    '<div style="display: flex; gap: 10px; margin-top: 10px;">' +
                    '<button class="primary-btn" style="flex: 1; padding: 10px; font-size: 0.9em; background: #3498db;" onclick="editPlayer(\'' + p.id + '\')">Ã§Â·Â¨Ã©â€ºâ€ </button>' +
                    '<button class="primary-btn" style="flex: 1; padding: 10px; font-size: 0.9em; background: #e74c3c;" onclick="deletePlayer(\'' + p.id + '\')">Ã¥â€°Å Ã©â„¢Â¤</button>' +
                    '</div>' +
                    '</div>';
            }).join('');
        }

        function exportData() {
            const data = {
                version: '2.0',
                exportDate: new Date().toISOString(),
                personalGames: personalGames,
                teamGames: teamGames,
                players: players,
                myPlayerId: myPlayerId,
                teamData: teamData
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Ã£Æ’ÂÃ£â€šÂ¹Ã£â€šÂ±Ã¨Â¨ËœÃ©Å’Â²_' + new Date().toISOString().split('T')[0] + '.json';
            a.click();
            URL.revokeObjectURL(url);
            
            alert('Ã¢Å“â€¦ Ã£Æ’ÂÃ£Æ’Æ’Ã£â€šÂ¯Ã£â€šÂ¢Ã£Æ’Æ’Ã£Æ’â€”Ã£ÂÅ’Ã¥Â®Å’Ã¤Âºâ€ Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸Ã¯Â¼Â');
        }

        function importData(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(ev) {
                try {
                    const data = JSON.parse(ev.target.result);
                    if (confirm('Ã¢Å¡Â Ã¯Â¸Â Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã¥Â¾Â©Ã¥â€¦Æ’Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ„¢\n\nÃ§ÂÂ¾Ã¥Å“Â¨Ã£ÂÂ®Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£ÂÂ¯Ã¤Â¸Å Ã¦â€ºÂ¸Ã£ÂÂÃ£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¾Ã£Ââ„¢Ã£â‚¬â€šÃ£â€šË†Ã£â€šÂÃ£Ââ€”Ã£Ââ€Ã£ÂÂ§Ã£Ââ„¢Ã£Ââ€¹Ã¯Â¼Å¸')) {
                        personalGames = data.personalGames || [];
                        teamGames = data.teamGames || [];
                        players = data.players || [];
                        myPlayerId = data.myPlayerId || null;
                        teamData = data.teamData || null;
                        saveData();
                        displayGames();
                        displayPlayers();
                        alert('Ã¢Å“â€¦ Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£ÂÂ®Ã¥Â¾Â©Ã¥â€¦Æ’Ã£ÂÅ’Ã¥Â®Å’Ã¤Âºâ€ Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸Ã¯Â¼Â');
                        location.reload();
                    }
                } catch (err) {
                    alert('Ã¢ÂÅ’ Ã£Æ’â€¢Ã£â€šÂ¡Ã£â€šÂ¤Ã£Æ’Â«Ã£ÂÂ®Ã¨ÂªÂ­Ã£ÂÂ¿Ã¨Â¾Â¼Ã£ÂÂ¿Ã£ÂÂ«Ã¥Â¤Â±Ã¦â€¢â€”Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸');
                }
            };
            reader.readAsText(file);
            e.target.value = '';
        }
        // ========== Ã¥â‚¬â€¹Ã¤ÂºÂºÃ§â€Â¨Ã¯Â¼Å¡Ã£Ââ€œÃ£ÂÂ®Ã£â€šÂ¹Ã£Æ’Å¾Ã£Æ’â€ºÃ£ÂÂ®Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã£â€šÂ¯Ã£Æ’ÂªÃ£â€šÂ¢ ==========
        function confirmClearLocalData() {
            const message = 'Ã¢Å¡Â Ã¯Â¸Â Ã£Ââ€œÃ£ÂÂ®Ã£â€šÂ¹Ã£Æ’Å¾Ã£Æ’â€ºÃ£ÂÂ®Ã¨Â©Â¦Ã¥ÂË†Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã£â€šÂ¯Ã£Æ’ÂªÃ£â€šÂ¢Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ„¢\n\n' +
                'Ã£â‚¬ÂÃ£â€šÂ¯Ã£Æ’ÂªÃ£â€šÂ¢Ã£Ââ€¢Ã£â€šÅ’Ã£â€šâ€¹Ã£â€šâ€šÃ£ÂÂ®Ã£â‚¬â€˜\n' +
                'Ã¢â‚¬Â¢ Ã£Ââ€œÃ£ÂÂ®Ã£â€šÂ¹Ã£Æ’Å¾Ã£Æ’â€ºÃ£ÂÂ®Ã¨Â©Â¦Ã¥ÂË†Ã¨Â¨ËœÃ©Å’Â²Ã¯Â¼Ë†' + personalGames.length + 'Ã¤Â»Â¶Ã¯Â¼â€°\n\n' +
                'Ã£â‚¬ÂÃ£â€šÂ¯Ã£Æ’ÂªÃ£â€šÂ¢Ã£Ââ€¢Ã£â€šÅ’Ã£ÂÂªÃ£Ââ€Ã£â€šâ€šÃ£ÂÂ®Ã£â‚¬â€˜\n' +
                'Ã¢â‚¬Â¢ Ã©ÂÂ¸Ã¦â€°â€¹Ã¦Æ’â€¦Ã¥Â Â±\n' +
                'Ã¢â‚¬Â¢ Google SheetsÃ£ÂÂ®Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã¯Â¼Ë†Ã¥â€¦Â¨Ã¥â€œÂ¡Ã¥â€¦Â±Ã¦Å“â€°Ã¯Â¼â€°\n' +
                'Ã¢â‚¬Â¢ Ã¤Â»â€“Ã£ÂÂ®Ã¤ÂºÂºÃ£ÂÂ®Ã£â€šÂ¹Ã£Æ’Å¾Ã£Æ’â€ºÃ£ÂÂ®Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿\n\n' +
                'Ã°Å¸â€™Â¡ Ã£Æ’â€™Ã£Æ’Â³Ã£Æ’Ë†Ã¯Â¼Å¡Ã£â‚¬Å’Ã¤Â»Å Ã£Ââ„¢Ã£ÂÂÃ¥ÂÅ’Ã¦Å“Å¸Ã£â‚¬ÂÃ£ÂÂ§Ã¥Â¾Â©Ã¥â€¦Æ’Ã£ÂÂ§Ã£ÂÂÃ£ÂÂ¾Ã£Ââ„¢\n\n' +
                'Ã¦Å“Â¬Ã¥Â½â€œÃ£ÂÂ«Ã£â€šÂ¯Ã£Æ’ÂªÃ£â€šÂ¢Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ„¢Ã£Ââ€¹Ã¯Â¼Å¸';
            
            if (confirm(message)) {
                clearLocalData();
            }
        }

        function clearLocalData() {
    personalGames = [];
    teamGames = [];
    players = [];
    myPlayerId = null;

    saveData();

    displayGames();
    displayRankings();
    updateCharts();
    // ...Ã¥Â¿â€¦Ã¨Â¦ÂÃ£ÂÂªUIÃ¦â€ºÂ´Ã¦â€“Â°
}
        // ========== Ã§Â®Â¡Ã§Ââ€ Ã¨â‚¬â€¦Ã§â€Â¨Ã¯Â¼Å¡Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¥â€¦Â¨Ã¤Â½â€œÃ£ÂÂ®Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã£Æ’ÂªÃ£â€šÂ»Ã£Æ’Æ’Ã£Æ’Ë† ==========
        function confirmResetTeamData() {
    if (!teamData) {
        alert('Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã£ÂÂ«Ã¥Ââ€šÃ¥Å Â Ã£Ââ€”Ã£ÂÂ¦Ã£Ââ€Ã£ÂÂ¾Ã£Ââ€ºÃ£â€šâ€œ');
        return;
    }
    
    const message = 'Ã°Å¸â€Â Ã§Â®Â¡Ã§Ââ€ Ã¨â‚¬â€¦Ã£ÂÂ®Ã£ÂÂ¿Ã¥Â®Å¸Ã¨Â¡Å’Ã¥ÂÂ¯Ã¨Æ’Â½\n\n' +
        'Ã¢Å¡Â Ã¯Â¸Â Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¥â€¦Â¨Ã¤Â½â€œÃ£ÂÂ®Ã¨Â©Â¦Ã¥ÂË†Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã£Æ’ÂªÃ£â€šÂ»Ã£Æ’Æ’Ã£Æ’Ë†Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ„¢\n\n' +
        'Ã£â‚¬ÂÃ¥Â½Â±Ã©Å¸Â¿Ã£â‚¬â€˜\n' +
        'Ã¢â‚¬Â¢ Google SheetsÃ£ÂÂ®Ã¨Â©Â¦Ã¥ÂË†Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£ÂÅ’Ã¥â€°Å Ã©â„¢Â¤Ã£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¾Ã£Ââ„¢\n' +
        'Ã¢â‚¬Â¢ Ã¥â€¦Â¨Ã£Æ’Â¡Ã£Æ’Â³Ã£Æ’ÂÃ£Æ’Â¼Ã£ÂÂ®Ã£â€šÂ¹Ã£Æ’Å¾Ã£Æ’â€ºÃ£Ââ€¹Ã£â€šâ€°Ã¨Â©Â¦Ã¥ÂË†Ã¨Â¨ËœÃ©Å’Â²Ã£ÂÅ’Ã¦Â¶Ë†Ã£ÂË†Ã£ÂÂ¾Ã£Ââ„¢\n' +
        'Ã¢â‚¬Â¢ Ã¥Â¾Â©Ã¥â€¦Æ’Ã£ÂÂ§Ã£ÂÂÃ£ÂÂ¾Ã£Ââ€ºÃ£â€šâ€œÃ¯Â¼Â\n\n' +
        'Ã£â‚¬ÂÃ¦Â®â€¹Ã£â€šâ€¹Ã£â€šâ€šÃ£ÂÂ®Ã£â‚¬â€˜\n' +
        'Ã¢â‚¬Â¢ Ã©ÂÂ¸Ã¦â€°â€¹Ã¦Æ’â€¦Ã¥Â Â±\n' +
        'Ã¢â‚¬Â¢ Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¨Â¨Â­Ã¥Â®Å¡\n\n' +
        'Ã§Â¶Å¡Ã£Ââ€˜Ã£â€šâ€¹Ã£ÂÂ«Ã£ÂÂ¯Ã£â‚¬ÂÃ§Â®Â¡Ã§Ââ€ Ã¨â‚¬â€¦Ã£Æ’â€˜Ã£â€šÂ¹Ã£Æ’Â¯Ã£Æ’Â¼Ã£Æ’â€°Ã£â€šâ€™Ã¥â€¦Â¥Ã¥Å â€ºÃ£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€Ã¯Â¼Å¡';
    
    const inputPassword = prompt(message);
    
    if (inputPassword === null) {
        return;
    }
    
    if (!inputPassword || inputPassword.trim() === '') {
        alert('Ã¢ÂÅ’ Ã£Æ’â€˜Ã£â€šÂ¹Ã£Æ’Â¯Ã£Æ’Â¼Ã£Æ’â€°Ã£â€šâ€™Ã¥â€¦Â¥Ã¥Å â€ºÃ£Ââ€”Ã£ÂÂ¦Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€');
        return;
    }
    
    const finalConfirm = confirm(
        'Ã¢Å¡Â Ã¯Â¸Â Ã¦Å“â‚¬Ã§Âµâ€šÃ§Â¢ÂºÃ¨ÂªÂ\n\n' +
        'Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¥â€¦Â¨Ã¤Â½â€œÃ£ÂÂ®Ã¨Â©Â¦Ã¥ÂË†Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã¥Â®Å’Ã¥â€¦Â¨Ã£ÂÂ«Ã¥â€°Å Ã©â„¢Â¤Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ„¢Ã£â‚¬â€š\n' +
        'Ã£Ââ€œÃ£ÂÂ®Ã¦â€œÂÃ¤Â½Å“Ã£ÂÂ¯Ã¥Ââ€“Ã£â€šÅ Ã¦Â¶Ë†Ã£Ââ€ºÃ£ÂÂ¾Ã£Ââ€ºÃ£â€šâ€œÃ£â‚¬â€š\n\n' +
        'Ã¦Å“Â¬Ã¥Â½â€œÃ£ÂÂ«Ã¥Â®Å¸Ã¨Â¡Å’Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ„¢Ã£Ââ€¹Ã¯Â¼Å¸'
    );
    
    if (finalConfirm) {
        resetTeamData(inputPassword);
    }
}

        function resetTeamData(adminPassword) {  // Ã¢â€ Â Ã£Æ’â€˜Ã£Æ’Â©Ã£Æ’Â¡Ã£Æ’Â¼Ã£â€šÂ¿Ã¨Â¿Â½Ã¥Å Â 
    personalGames = [];
    teamGames = [];
    saveData();
    
    if (teamData) {
        clearServerGameData(adminPassword);  // Ã¢â€ Â Ã£Æ’â€˜Ã£â€šÂ¹Ã£Æ’Â¯Ã£Æ’Â¼Ã£Æ’â€°Ã£â€šâ€™Ã¦Â¸Â¡Ã£Ââ„¢
    }
    
    displayGames();
    displayRankings();
    updateCharts();
    if (typeof displayTeamGamesHistory === 'function') {
        displayTeamGamesHistory();
    }
    
    alert('Ã¢Å“â€¦ Ã£Æ’ÂÃ£Æ’Â¼Ã£Æ’Â Ã¥â€¦Â¨Ã¤Â½â€œÃ£ÂÂ®Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã£Æ’ÂªÃ£â€šÂ»Ã£Æ’Æ’Ã£Æ’Ë†Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸Ã¯Â¼Â\n\nÃ¥â€¦Â¨Ã£Æ’Â¡Ã£Æ’Â³Ã£Æ’ÂÃ£Æ’Â¼Ã£ÂÂ«Ã¥Â½Â±Ã©Å¸Â¿Ã£ÂÅ’Ã£Ââ€šÃ£â€šÅ Ã£ÂÂ¾Ã£Ââ„¢Ã£â‚¬â€š\nÃ¥Ââ€Ã£Æ’Â¡Ã£Æ’Â³Ã£Æ’ÂÃ£Æ’Â¼Ã£ÂÂ¯Ã£â‚¬Å’Ã¤Â»Å Ã£Ââ„¢Ã£ÂÂÃ¥ÂÅ’Ã¦Å“Å¸Ã£â‚¬ÂÃ£ÂÂ§Ã§Â©ÂºÃ£ÂÂ®Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£ÂÅ’Ã¥Ââ€“Ã¥Â¾â€”Ã£Ââ€¢Ã£â€šÅ’Ã£ÂÂ¾Ã£Ââ„¢Ã£â‚¬â€š');
}

async function clearServerGameData(adminPassword) {  // Ã¢â€ Â Ã£Æ’â€˜Ã£Æ’Â©Ã£Æ’Â¡Ã£Æ’Â¼Ã£â€šÂ¿Ã¨Â¿Â½Ã¥Å Â 
    try {
        showSyncIndicator('syncing', 'Ã£â€šÂµÃ£Æ’Â¼Ã£Æ’ÂÃ£Æ’Â¼Ã£ÂÂ®Ã¨Â©Â¦Ã¥ÂË†Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€™Ã¥â€°Å Ã©â„¢Â¤Ã¤Â¸Â­...');
        
        const response = await fetch(API_URL, {
            method: 'POST',
            headers: {
                'Content-Type': 'text/plain',
            },
            body: JSON.stringify({
                action: 'clearGames',
                teamCode: teamData.code,
                adminPassword: adminPassword  // Ã¢â€ Â Ã£Æ’â€˜Ã£â€šÂ¹Ã£Æ’Â¯Ã£Æ’Â¼Ã£Æ’â€°Ã£â€šâ€™Ã©â‚¬ÂÃ¤Â¿Â¡
            })
        });
        
        const result = await response.json();
        
        if (result.success) {
            showSyncIndicator('success', 'Ã£â€šÂµÃ£Æ’Â¼Ã£Æ’ÂÃ£Æ’Â¼Ã£ÂÂ®Ã¨Â©Â¦Ã¥ÂË†Ã£Æ’â€¡Ã£Æ’Â¼Ã£â€šÂ¿Ã£â€šâ€šÃ¥â€°Å Ã©â„¢Â¤Ã¥Â®Å’Ã¤Âºâ€ ');
        } else {
            showSyncIndicator('error', result.error || 'Ã£â€šÂµÃ£Æ’Â¼Ã£Æ’ÂÃ£Æ’Â¼Ã¥â€°Å Ã©â„¢Â¤Ã¥Â¤Â±Ã¦â€¢â€”');
            alert('Ã¢ÂÅ’ ' + (result.error || 'Ã£â€šÂµÃ£Æ’Â¼Ã£Æ’ÂÃ£Æ’Â¼Ã¥â€°Å Ã©â„¢Â¤Ã£ÂÂ«Ã¥Â¤Â±Ã¦â€¢â€”Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸'));
        }
    } catch (error) {
        console.error('Ã£â€šÂµÃ£Æ’Â¼Ã£Æ’ÂÃ£Æ’Â¼Ã¥â€°Å Ã©â„¢Â¤Ã£â€šÂ¨Ã£Æ’Â©Ã£Æ’Â¼:', error);
        showSyncIndicator('error', 'Ã£â€šÂµÃ£Æ’Â¼Ã£Æ’ÂÃ£Æ’Â¼Ã¥â€°Å Ã©â„¢Â¤Ã¥Â¤Â±Ã¦â€¢â€”');
        alert('Ã¢ÂÅ’ Ã£â€šÂ¨Ã£Æ’Â©Ã£Æ’Â¼Ã£ÂÅ’Ã§â„¢ÂºÃ§â€Å¸Ã£Ââ€”Ã£ÂÂ¾Ã£Ââ€”Ã£ÂÅ¸: ' + error.message);
    }
}
        loadData();
        updateDisplay();
        displayGames();
        displayPlayers();
        updateMyPlayerSelect();
        displayTeamStatus();
        updatePlayerBanners();
        loadTeamData();
        checkAndShowDraftGame();
        
        // ========== Ã©ÂÂ¸Ã¦â€°â€¹Ã©ÂÂ¸Ã¦Å Å¾Ã£Æ’â‚¬Ã£â€šÂ¤Ã£â€šÂ¢Ã£Æ’Â­Ã£â€šÂ°Ã£ÂÂ®HTMLÃ¤Â½Å“Ã¦Ë†Â ==========
        function createPlayerSelectDialog() {
            const dialogHTML = `
                <div id="playerSelectModal" class="modal-overlay" style="display: none;">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2>Ã°Å¸Ââ‚¬ Ã©ÂÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã©ÂÂ¸Ã¦Å Å¾</h2>
                            <button class="modal-close" onclick="closePlayerSelectDialog()">Ãƒâ€”</button>
                        </div>
                        <div class="modal-body">
                            <p style="margin-bottom: 15px; color: #666;">Ã¥â‚¬â€¹Ã¤ÂºÂºÃ£Æ’Â¢Ã£Æ’Â¼Ã£Æ’â€°Ã£ÂÂ§Ã¨Â¡Â¨Ã§Â¤ÂºÃ£Ââ„¢Ã£â€šâ€¹Ã©ÂÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã©ÂÂ¸Ã£â€šâ€œÃ£ÂÂ§Ã£ÂÂÃ£ÂÂ Ã£Ââ€¢Ã£Ââ€</p>
                            <select id="playerSelectDropdown" class="player-select-dropdown">
                                <option value="">Ã©ÂÂ¸Ã¦â€°â€¹Ã£â€šâ€™Ã©ÂÂ¸Ã¦Å Å¾...</option>
                            </select>
                        </div>
                        <div class="modal-footer">
                            <button class="modal-btn cancel-btn" onclick="closePlayerSelectDialog()">Ã£â€šÂ­Ã£Æ’Â£Ã£Æ’Â³Ã£â€šÂ»Ã£Æ’Â«</button>
                            <button class="modal-btn confirm-btn" onclick="confirmPlayerSelection()">Ã©ÂÂ¸Ã¦Å Å¾</button>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', dialogHTML);
        }
        
        // Ã£Æ’Å¡Ã£Æ’Â¼Ã£â€šÂ¸Ã¨ÂªÂ­Ã£ÂÂ¿Ã¨Â¾Â¼Ã£ÂÂ¿Ã¦â„¢â€šÃ£ÂÂ«Ã£Æ’â‚¬Ã£â€šÂ¤Ã£â€šÂ¢Ã£Æ’Â­Ã£â€šÂ°Ã£â€šâ€™Ã¤Â½Å“Ã¦Ë†Â
        createPlayerSelectDialog();
    </script>
</body>
</html>
